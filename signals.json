{
  "version": "3.22.0.0000",
  "schemaVersion": 3,
  "labels": [
    {
      "name": "Alpha",
      "description": "These signals have been tested and reviewed internally for syntax. Little or no testing of expected alert generation has been conducted. These signals are not included on the external feed."
    },
    {
      "name": "Beta",
      "description": "These signals have been tested and reviewed internally for syntax. Internal testing of expected alert generation has been verified. Testing on internal systems for false positives has been conducted and tuned if necessary. These signals are included on the external feed."
    },
    {
      "name": "Stable",
      "description": "These are vetted signals that have been tested and used at scale. Large amounts of false positives are not expected. These signals are included on the external feed."
    },
    {
      "name": "Test",
      "description": "These signals have just been added without testing or review. No guarantees are made as to their state. These signals are not included on the external feed."
    },
    {
      "name": "Persistence",
      "description": "MITRE ATT&CK matrix category"
    },
    {
      "name": "Privilege Escalation",
      "description": "MITRE ATT&CK matrix category"
    },
    {
      "name": "Defense Evasion",
      "description": "MITRE ATT&CK matrix category"
    },
    {
      "name": "Credential Access",
      "description": "MITRE ATT&CK matrix category"
    },
    {
      "name": "Discovery",
      "description": "MITRE ATT&CK matrix category"
    },
    {
      "name": "Lateral Movement",
      "description": "MITRE ATT&CK matrix category"
    },
    {
      "name": "Execution",
      "description": "MITRE ATT&CK matrix category"
    },
    {
      "name": "Collection",
      "description": "MITRE ATT&CK matrix category"
    },
    {
      "name": "Exfiltration",
      "description": "MITRE ATT&CK matrix category"
    },
    {
      "name": "Command and Control",
      "description": "MITRE ATT&CK matrix category"
    },
    {
      "name": "Linux",
      "description": "These signals are built for Linux based hosts."
    },
    {
      "name": "Windows",
      "description": "These signals are built for Windows hosts."
    },
    {
      "name": "Mac",
      "description": "These signals are built for Mac OS hosts."
    }
  ],
  "signals": [
    {
      "name": "AMSI and Script Block Evasion",
      "description": "Detects techniques used to bypass Anti-Malware Scan Interface (AMSI) and Script Block Logging.",
      "text": "image.path contains 'System.Management.Automation' AND (process.command_line contains 'System.Management.Automation.AmsiUtils' AND (process.command_line contains 'amsiSession' OR process.command_line contains 'amsiContext' OR process.command_line contains 'amsiInitFailed')) OR (process.command_line contains 'System.Management.Automation.Utils' AND process.command_line contains 'cachedGroupPolicySettings' AND registry.key_path contains 'EnableScriptBlockLogging') OR (process.command_line contains 'System.Management.Automation.ScriptBlock' AND process.command_line contains 'signatures' AND process.command_line contains 'System.Collections.Generic.HashSet')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          },
          {
            "id": "T1054",
            "name": "Indicator Blocking"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 3,
      "id": "AMSI and Script Block Evasion",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            },
            {
              "id": "T1054",
              "name": "Indicator Blocking"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            },
            {
              "id": "T1562.006",
              "name": "Impair Defenses: Indicator Blocking"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "AWK Commands Reverse Shell",
      "description": "Detects common commands used to create a reverse shell with awk.",
      "text": "process.path ends with 'awk' AND process.command_line contains 'inet' and process.command_line contains 'tcp' AND process.command_line contains 'while' AND process.command_line contains 'printf' AND process.command_line contains 'getline' AND process.command_line contains 'break' AND process.command_line contains 'close'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "AWK Commands Reverse Shell",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "AdFind Domain Trust Dump",
      "description": "Detects usage of the adfind.exe utility to enumerate details of a domain trust. Seen used during post-compromise reconnaissance.",
      "text": "process.path ends with '\\\\adfind.exe' AND process.command_line contains 'trustdmp'",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1482",
            "name": "Domain Trust Discovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Adfind Domain Trust Dump",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1482",
              "name": "Domain Trust Discovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1482",
              "name": "Domain Trust Discovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "AdFind Object Computer",
      "description": "Detects usage of the adfind.exe utility to enumerate domain computers. Seen used during post-compromise reconnaissance.",
      "text": "process.path ends with '\\\\adfind.exe' AND process.command_line contains '-f' AND process.command_line contains 'objectcategory=computer'",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1018",
            "name": "Remote System Discovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Adfind Object Computer",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1018",
              "name": "Remote System Discovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1018",
              "name": "Remote System Discovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "AdFind Object Group",
      "description": "Detects usage of the adfind.exe utility to enumerate domain groups. Seen used during post-compromise reconnaissance.",
      "text": "process.path ends with '\\\\adfind.exe' AND process.command_line contains '-f' AND process.command_line contains 'objectcategory=group'",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1069",
            "name": "Permission Groups Discovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Adfind Object Group",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1069",
              "name": "Permission Groups Discovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1069",
              "name": "Permission Groups Discovery"
            },
            {
              "id": "T1069.002",
              "name": "Permission Groups Discovery: Domain Groups"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "AdFind Object Organizational Unit",
      "description": "Detects usage of the adfind.exe utility to enumerate domain organizational units. Seen used during post-compromise reconnaissance.",
      "text": "process.path ends with '\\\\adfind.exe' AND process.command_line contains '-f' AND process.command_line contains 'objectcategory=organizationalUnit'",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Adfind Object Organizational Unit",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "AdFind Object Person",
      "description": "Detects usage of the adfind.exe utility to enumerate members of domain. Seen used during post-compromise reconnaissance.",
      "text": "process.path ends with '\\\\adfind.exe' AND process.command_line contains '-f' AND process.command_line contains 'objectcategory=person'",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1087",
            "name": "Account Discovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Adfind Object Person",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1087",
              "name": "Account Discovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1087",
              "name": "Account Discovery"
            },
            {
              "id": "T1087.002",
              "name": "Account Discovery: Domain Account"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "AdFind Object Subnet",
      "description": "Detects usage of the adfind.exe utility to enumerate domain subnets. Seen used during post-compromise reconnaissance.",
      "text": "process.path ends with '\\\\adfind.exe' AND process.command_line contains '-f' AND process.command_line contains 'objectcategory=subnet'",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1016",
            "name": "System Network Configuration Discovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Adfind Object Subnet",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1016",
              "name": "System Network Configuration Discovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1016",
              "name": "System Network Configuration Discovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Administrator Account Enumeration",
      "description": "Detects usage of the NET.EXE or DSQuery.exe  utility to enumerate members of the local Administrators or Domain Administrators groups. Often used during post-compromise reconnaissance.",
      "text": "(((process.command_line contains 'group' AND process.command_line contains 'Domain' AND process.command_line contains 'Admins') OR (process.command_line contains 'localgroup' AND process.command_line contains 'Administrators') OR (process.command_line contains 'Exchange' AND process.command_line contains 'Trusted' AND process.command_line contains 'Subsystem')) AND process.path ends with '\\\\net.exe' AND process.parent_command_line contains NOT 'windows\\\\ccmcache' AND process.parent_path contains NOT 'windows\\\\ccmcache' AND process.parent_command_line contains NOT '\\\\SupportAssist' AND process.parent_path contains NOT 'SupportAssist' AND process.command_line contains NOT '/add') OR (process.command_line contains 'Admin' AND process.path ends with '\\\\dsquery.exe')",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1087",
            "name": "Account Discovery"
          },
          {
            "id": "T1069",
            "name": "Permission Groups Discovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Administrator Account Enumeration",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1087",
              "name": "Account Discovery"
            },
            {
              "id": "T1069",
              "name": "Permission Groups Discovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1087",
              "name": "Account Discovery"
            },
            {
              "id": "T1087.001",
              "name": "Account Discovery: Local Account"
            },
            {
              "id": "T1087.002",
              "name": "Account Discovery: Domain Account"
            },
            {
              "id": "T1087.003",
              "name": "Account Discovery: Email Account"
            },
            {
              "id": "T1069.001",
              "name": "Permission Groups Discovery: Local Groups"
            },
            {
              "id": "T1069.002",
              "name": "Permission Groups Discovery: Domain Groups"
            },
            {
              "id": "T1069",
              "name": "Permission Groups Discovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Administrator Account Enumeration - Spanish",
      "description": "Detecta el uso de la herramienta net.exe para enumerar miembros del grupo administradores locales. Frecuentemente usado para propositos de reconocimiento despues del compromiso inicial.",
      "text": "process.path ends with 'net.exe' AND process.command_line contains '/add' AND process.command_line contains 'localgroup administradores' AND process.parent_path contains NOT 'SupportAssist' AND process.parent_command_line contains NOT 'SupportAssist' AND process.parent_path contains NOT 'windows ccmcache' AND process.parent_command_line contains NOT 'windows ccmcache'",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1087",
            "name": "Account Discovery"
          },
          {
            "id": "T1069",
            "name": "Permission Groups Discovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Administrator Account Enumeration - Spanish",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1087",
              "name": "Account Discovery"
            },
            {
              "id": "T1069",
              "name": "Permission Groups Discovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1087",
              "name": "Account Discovery"
            },
            {
              "id": "T1087.001",
              "name": "Account Discovery: Local Account"
            },
            {
              "id": "T1087.002",
              "name": "Account Discovery: Domain Account"
            },
            {
              "id": "T1087.003",
              "name": "Account Discovery: Email Account"
            },
            {
              "id": "T1069.001",
              "name": "Permission Groups Discovery: Local Groups"
            },
            {
              "id": "T1069.002",
              "name": "Permission Groups Discovery: Domain Groups"
            },
            {
              "id": "T1069",
              "name": "Permission Groups Discovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "AppInstaller File Download",
      "description": "Detects the use of the Windows native utility AppInstaller.exe to download a file.",
      "text": "process.path contains 'appinstaller' AND process.command_line contains 'source' AND process.command_line contains 'url'",
      "labels": [
        "Beta",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "AppInstaller File Download",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "At Scheduled Tasks Persistence",
      "description": "Detects the use of at.exe to schedule a task every given interval. This is a known living off the land attacker technique.",
      "text": "process.path ends with '\\\\at.exe' AND process.command_line contains 'every'",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1168",
            "name": "Local Job Scheduling"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "At Scheduled Tasks Persistence",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1168",
              "name": "Local Job Scheduling"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1053",
              "name": "Scheduled Task/Job"
            },
            {
              "id": "T1053.002",
              "name": "Scheduled Task/Job: At (Windows)"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "BITSADMIN File Retrieval and Execution",
      "description": "The Background Intelligent Transfer Service (BITS) is a built-in Windows utility that can be used to download and execute files, as well as upload files, to a URL. Direct execution of the BITSADMIN utility is uncommon, and may be abused to retrieve and run malware or transfer other files. Recurrent BITS jobs can also be used as a persistence mechanism.",
      "text": "process.path ends with '\\\\bitsadmin.exe' AND ((process.command_line contains 'http' AND (process.command_line contains '/AddFile' OR process.command_line contains '/transfer')) OR ((process.command_line contains '/SetNotifyCmdLine' AND process.command_line contains '/AddFile') OR process.command_line contains '/setproxysettings')) AND process.command_line contains NOT '\\\\DSS'",
      "labels": [
        "Beta",
        "Execution",
        "Command and Control",
        "Exfiltration",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1197",
            "name": "BITS Jobs"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol"
          },
          {
            "id": "T1105",
            "name": "Remote File Copy"
          }
        ]
      },
      "syntax_version": 1,
      "id": "BITSADMIN File Retrieval and Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1197",
              "name": "BITS Jobs"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1048",
              "name": "Exfiltration Over Alternative Protocol"
            },
            {
              "id": "T1105",
              "name": "Remote File Copy"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1197",
              "name": "BITS Jobs"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1048",
              "name": "Exfiltration Over Alternative Protocol"
            },
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            }
          ]
        }
      }
    },
    {
      "name": "Base64 Commands Exfil",
      "description": "Detects common commands used to exfiltrate data encoded with base64 over TCP.",
      "text": "process.path ends with 'ssh' AND process.command_line contains 'ssh' AND process.command_line contains 'base64' AND process.command_line contains '>' AND file.path ends with 'tty'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1001",
            "name": "Data Obfuscation"
          },
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Base64 Commands Exfil",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1001",
              "name": "Data Obfuscation"
            },
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1001",
              "name": "Data Obfuscation"
            },
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Base64 Encoded DNS Query",
      "description": "Detects DNS queries that contain a double equals which base64 uses for padding when encoding a string.",
      "text": "network.dns_query contains '=='",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Windows",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "windows",
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1048",
            "name": "Exfiltration Over Alternative Protocol"
          },
          {
            "id": "T1071",
            "name": "Standard Application Layer Protocol"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Base64 Encoded DNS Query",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1048",
              "name": "Exfiltration Over Alternative Protocol"
            },
            {
              "id": "T1071",
              "name": "Standard Application Layer Protocol"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1048",
              "name": "Exfiltration Over Alternative Protocol"
            },
            {
              "id": "T1048.003",
              "name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol"
            },
            {
              "id": "T1071",
              "name": "Application Layer Protocol"
            },
            {
              "id": "T1071.004",
              "name": "Application Layer Protocol: DNS"
            }
          ]
        }
      }
    },
    {
      "name": "Bash Commands Download via HTTP GET Request",
      "description": "Detects the use of Bash via an HTTP GET request to download potentially suspect content.",
      "text": "process.path ends with 'bash' AND process.command_line contains 'bash' AND process.command_line contains 'echo -ne' AND process.command_line contains 'HTTP' AND process.command_line contains 'dev' AND process.command_line contains 'tcp' AND process.command_line contains 'while' AND process.command_line contains 'read' AND process.command_line contains 'break' AND process.command_line contains 'done'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1105",
            "name": "Remote File Copy"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Bash Commands Download via HTTP GET request",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1105",
              "name": "Remote File Copy"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            }
          ]
        }
      }
    },
    {
      "name": "Bash Commands Exfil",
      "description": "Detects common commands used to create a shell for exfiltration of data with bash.",
      "text": "process.path ends with 'bash' AND process.command_line contains '-c' AND process.command_line contains 'echo' AND process.command_line contains '-e' AND process.command_line contains 'POST' AND process.command_line contains 'HTTP' AND process.command_line contains 'dev' AND process.command_line contains 'tcp'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Bash Commands Exfil",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Bcdedit Boot Status Ignore Failures",
      "description": "Detects usage of bcdedit.exe to ignore all failures on boot. This can be used by ransomware to eliminate recovery options.",
      "text": "process.path ends with '\\\\bcdedit.exe' AND process.command_line contains 'set' AND process.command_line contains 'default' AND process.command_line contains 'bootstatuspolicy' AND process.command_line contains 'ignoreallfailures'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1490",
            "name": "Inhibit System Recovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Bcdedit Boot Status Ignore Failures",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Bcdedit Boot into Safe Mode",
      "description": "Detects usage of bcdedit.exe to force the computer to boot into safemode during the next boot. This has been seen used by ransomware as a technique to avoid security software preventions.",
      "text": "process.path ends with '\\\\bcdedit.exe' AND process.command_line contains 'set' AND process.command_line contains 'current' AND process.command_line contains 'safeboot'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1490",
            "name": "Inhibit System Recovery"
          },
          {
            "id": "T1529",
            "name": "System Shutdown/Reboot"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Bcdedit Boot into Safe Mode",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1529",
              "name": "System Shutdown/Reboot"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1529",
              "name": "System Shutdown/Reboot"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Bcdedit Disabling Recovery",
      "description": "Detects usage of bcdedit.exe to disable recovery from boot configuration data. This can be used by ransomware to eliminate recovery options.",
      "text": "process.path ends with '\\\\bcdedit.exe' AND process.command_line contains 'set' AND process.command_line contains 'default' AND process.command_line contains 'recoveryenabled' AND process.command_line contains 'no'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1490",
            "name": "Inhibit System Recovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Bcdedit Disabling Recovery",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Binary Created by C# Command Line Compiler",
      "description": "Detects the use of C# Command-Line Compiler (csc.exe) to compile a binary or library on a system. This can be used by attackers to create a binary in memory when wrapped in a cradle or to compile attacker binaries on disk before execution.",
      "text": "process.path ends with '\\\\csc.exe' AND process.command_line contains 'nologo' AND process.command_line contains 'target'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "syntax_version": 1,
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1027",
            "name": "Obfuscated Files or Information"
          },
          {
            "id": "T1500",
            "name": "Compile After Delivery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "id": "Binary Created by C# Command Line Compiler",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            },
            {
              "id": "T1500",
              "name": "Compile After Delivery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            },
            {
              "id": "T1027.004",
              "name": "Obfuscated Files or Information: Compile After Delivery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "BootCFG Boot into Safe Mode",
      "description": "Detects usage of bootcfg.exe to force the computer to boot into safemode during the next boot. This has been seen used by ransomware as a technique to avoid security software preventions.",
      "text": "process.path ends with '\\\\bootcfg.exe' AND process.command_line contains '/raw' AND process.command_line contains 'safeboot' And process.command_line contains '/a'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1490",
            "name": "Inhibit System Recovery"
          },
          {
            "id": "T1529",
            "name": "System Shutdown/Reboot"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "BootCFG Boot into Safe Mode",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1529",
              "name": "System Shutdown/Reboot"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1529",
              "name": "System Shutdown/Reboot"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Browser Created HTA or PS1 Files",
      "description": "Detects the creation of HTA or powershell script files that are commonly created when visiting malicious domains.",
      "text": "(process.path ends with 'iexplore.exe' OR process.path ends with 'firefox.exe' OR process.path ends with 'browser_broker.exe' OR process.path ends with 'chrome.exe') AND group((file.operation is 'create' OR file.operation is 'rename') AND (file.path ends with '.hta' OR file.path ends with '.ps1') AND file.path contains NOT '\\\\windows\\\\temp\\\\__PSSscriptPolicy')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "syntax_version": 2,
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1170",
            "name": "Mshta"
          }
        ]
      },
      "id": "Browser Created HTA or PS1 Files",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1170",
              "name": "Mshta"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.005",
              "name": "Signed Binary Proxy Execution: Mshta"
            }
          ]
        }
      }
    },
    {
      "name": "Busybox HTTP Server Exfil",
      "description": "Detects the potential use of Busybox.exe to make a directory that is available to the web for exfil.",
      "text": "process.path ends with '/busybox' and process.command_line contains 'httpd'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Busybox HTTP Server Exfil",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Bypass User Account Control",
      "description": "The user account control (UAC) requires user interaction to escalate a process to a higher privilege, using bypasses such as sdclt.exe an attacker can escalate his processes privilege on a system.",
      "text": "(process.path ends with 'sdclt.exe' AND process.command_line contains 'kickoff') OR (((process.command_line contains 'reg.exe' AND process.command_line contains 'add') OR (process.command_line contains 'new-item' AND process.command_line contains 'set-item')) AND process.command_line contains '\\\\cmd.exe')",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1088",
            "name": "Bypass User Account Control"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Bypass User Account Control",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1088",
              "name": "Bypass User Account Control"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1548.002",
              "name": "Abuse Elevation Control Mechanism: Bypass User Account Control"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Bypass User Account Control Fodhelper",
      "description": "Detects the usage of fodhelper to bypass user account control which requires user interaction to escalate a process to a higher privilege. Bypassing UAC allows an attacker to escalate a processes privilege on a system.",
      "text": "process.parent_path ends with '\\\\fodhelper.exe' AND process.path ends with NOT '\\\\System32\\\\svchost.exe' AND process.path ends with NOT '\\\\SysWOW64\\\\svchost.exe'",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1088",
            "name": "Bypass User Account Control"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Bypass User Account Control Fodhelper",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1088",
              "name": "Bypass User Account Control"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1548.002",
              "name": "Abuse Elevation Control Mechanism: Bypass User Account Control"
            }
          ]
        }
      }
    },
    {
      "name": "Bypass User Account Control WSReset",
      "description": "Detects the usage of wsreset to bypass user account control which requires user interaction to escalate a process to a higher privilege. Bypassing UAC allows an attacker to escalate a processes privilege on a system.",
      "text": "process.parent_path ends with '\\\\wsreset.exe' AND process.path ends with NOT '\\\\System32\\\\mmc.exe' AND process.path ends with NOT '\\\\SysWOW64\\\\mmc.exe'",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1088",
            "name": "Bypass User Account Control"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Bypass User Account Control WSReset",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1088",
              "name": "Bypass User Account Control"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1548.002",
              "name": "Abuse Elevation Control Mechanism: Bypass User Account Control"
            }
          ]
        }
      }
    },
    {
      "name": "CIM Registry Image Load",
      "description": "Detects the use of register-cimprovider.exe to execute a DLL.",
      "text": "process.path ends with '\\\\register-cimprovider.exe' AND process.command_line contains 'path'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "CIM Registry Image Load",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "COM Hijack PWSH",
      "description": "Detects the modification of registry key paths by pwsh.exe that can be used for hijacking COM objects.",
      "text": "process.path ends with '\\\\pwsh.exe' AND group(registry.key_path contains '\\\\CLSID\\\\' AND registry.key_path contains 'server32')",
      "labels": [
        "Beta",
        "Persistence",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1122",
            "name": "Component Object Model Hijacking"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 2,
      "id": "COM Hijack PWSH",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1122",
              "name": "Component Object Model Hijacking"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.015",
              "name": "Event Triggered Execution: Component Object Model Hijacking"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "COM Hijack Persistence System Management Automation",
      "description": "Detects the modification of registry key paths that can be used for hijacking COM objects for persistence by a process with the system.managment.automation DLL loaded. The system.managment.automation DLL contains the powershell class namespace.",
      "text": "image.path contains 'system.management.automation' AND group(registry.key_path contains '\\\\CLSID\\\\' AND registry.key_path contains 'server32')",
      "labels": [
        "Beta",
        "Persistence",
        "Privilege Escalation",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1122",
            "name": "Component Object Model Hijacking"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 3,
      "id": "COM Hijack Persistence System Management Automation",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1122",
              "name": "Component Object Model Hijacking"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.015",
              "name": "Event Triggered Execution: Component Object Model Hijacking"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "COM Hijack PowerShell",
      "description": "Detects the modification of registry key paths by powershell.exe that can be used for hijacking COM objects.",
      "text": "process.path ends with '\\\\powershell.exe' AND group(registry.key_path contains '\\\\CLSID\\\\' AND registry.key_path contains 'server32')",
      "labels": [
        "Beta",
        "Persistence",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1122",
            "name": "Component Object Model Hijacking"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 2,
      "id": "COM Hijack PowerShell",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1122",
              "name": "Component Object Model Hijacking"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.015",
              "name": "Event Triggered Execution: Component Object Model Hijacking"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "COM Hijack PowerShell ISE",
      "description": "Detects the modification of registry key paths by powershell_ise.exe that can be used for hijacking COM objects.",
      "text": "process.path ends with '\\\\powershell_ise.exe' AND group(registry.key_path contains '\\\\CLSID\\\\' AND registry.key_path contains 'server32')",
      "labels": [
        "Beta",
        "Persistence",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1122",
            "name": "Component Object Model Hijacking"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 2,
      "id": "COM Hijack PowerShell ISE",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1122",
              "name": "Component Object Model Hijacking"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.015",
              "name": "Event Triggered Execution: Component Object Model Hijacking"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "COM Hijack Reg",
      "description": "Detects the modification of registry key paths by reg.exe that can be used for hijacking COM objects.",
      "text": "process.path ends with '\\\\reg.exe' AND group(registry.key_path contains '\\\\CLSID\\\\' AND registry.key_path contains 'server32')",
      "labels": [
        "Beta",
        "Persistence",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1122",
            "name": "Component Object Model Hijacking"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 2,
      "id": "COM Hijack Reg",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1122",
              "name": "Component Object Model Hijacking"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.015",
              "name": "Event Triggered Execution: Component Object Model Hijacking"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "COM Hijack Regedit",
      "description": "Detects the modification of registry key paths by regedit.exe that can be used for hijacking COM objects.",
      "text": "process.path ends with '\\\\regedit.exe' AND group(registry.key_path contains '\\\\CLSID\\\\' AND registry.key_path contains 'server32')",
      "labels": [
        "Beta",
        "Persistence",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1122",
            "name": "Component Object Model Hijacking"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 2,
      "id": "COM Hijack Regedit",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1122",
              "name": "Component Object Model Hijacking"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.015",
              "name": "Event Triggered Execution: Component Object Model Hijacking"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "COM Hijack sdclt",
      "description": "Detects changes made in the registry by sdclt at execution.",
      "text": "registry.key_path contains 'Software\\\\Classes\\\\Folder\\\\shell\\\\open\\\\command'",
      "labels": [
        "Beta",
        "Execution",
        "Privilege Escalation",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1122",
            "name": "Component Object Model Hijacking"
          },
          {
            "id": "T1088",
            "name": "Bypass User Account Control"
          }
        ]
      },
      "syntax_version": 1,
      "id": "COM Hijack sdclt",
      "modification-date": "2021-05-24T15:20:29.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1122",
              "name": "Component Object Model Hijacking"
            },
            {
              "id": "T1088",
              "name": "Bypass User Account Control"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546.015",
              "name": "Event Triggered Execution: Component Object Model Hijacking"
            },
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1548.002",
              "name": "Abuse Elevation Control Mechanism: Bypass User Account Control"
            },
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            }
          ]
        }
      }
    },
    {
      "name": "CertReq Post File Download",
      "description": "Detects use of the Windows native utility CertReq.exe to download a file via HTTP POST.",
      "text": "process.path ends with '\\\\certreq.exe' AND process.command_line contains 'post' AND process.command_line contains 'config' AND process.command_line contains ':\\\\'",
      "labels": [
        "Beta",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "CertReq Post File Download",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Chmod Set SGID Bit 2",
      "description": "Detects when chmod is used to set the SGID bit which can be used to execute a process in the context of the group who owns a file, not the user who is executing the file. Attackers can use this technique to maintain root access on an endpoint.",
      "text": "process.path ends with 'chmod' AND process.command_line contains ' 2' AND (process.ancestry_command_line contains NOT ' configure ' OR process.ancestry_command_line contains NOT '/dpkg/')",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Chmod Set SGID Bit 2",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1166",
              "name": "Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1548.001",
              "name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Chmod Set SGID Bit g+s",
      "description": "Detects when chmod is used to set the SGID bit which can be used to execute a process in the context of the group who owns a file, not the user who is executing the file. Attackers can use this technique to maintain root access on an endpoint.",
      "text": "process.path ends with 'chmod' AND process.command_line contains 'g+s' AND (process.ancestry_command_line contains NOT ' configure ' OR process.ancestry_command_line contains NOT '/dpkg/')",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Chmod Set SGID Bit g+s",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1166",
              "name": "Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1548.001",
              "name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Chmod Set SUID Bit 4",
      "description": "Detects when chmod is used to set the SUID bit which can be used to execute a process in the context of a files owner, not the user who is executing the file. Attackers can use this technique to maintain root access on an endpoint.",
      "text": "process.path ends with 'chmod' AND process.command_line contains ' 4' AND (process.ancestry_command_line contains NOT ' configure ' OR process.ancestry_command_line contains NOT '/dpkg/')",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Chmod Set SUID Bit 4",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1166",
              "name": "Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1548.001",
              "name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Chmod Set SUID Bit u+s",
      "description": "Detects when chmod is used to set the SUID bit which can be used to execute a process in the context of a files owner, not the user who is executing the file. Attackers can use this technique to maintain root access on an endpoint.",
      "text": "process.path ends with 'chmod' AND process.command_line contains 'u+s' AND (process.ancestry_command_line contains NOT ' configure ' OR process.ancestry_command_line contains NOT '/dpkg/')",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Chmod Set SUID Bit u+s",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1166",
              "name": "Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1548.001",
              "name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Chrome Modifying Files in Windows Directory",
      "description": "Detects Chrome or a descendent process modifying files in the windows directory, which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\chrome.exe' AND group(file.path contains ':\\\\windows' AND file.path contains NOT 'tzres.dll' AND file.path contains NOT 'ole32.dll' AND file.path contains NOT 'CRYPTBASE.DLL' AND file.path contains NOT 'WINMMBASE.dll')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Chrome Modifying Files in Windows Directory",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.001",
              "name": "User Execution: Malicious Link"
            }
          ]
        }
      }
    },
    {
      "name": "Chrome Spawned CMD",
      "description": "Detects when the Chrome browser spawns a descendant cmd.exe process. This can be a sign of an attacker injection.",
      "text": "process.path ends with '\\\\cmd.exe' AND process.ancestry_path ends with '\\\\chrome.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Chrome Spawned CMD",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Chrome Spawned PWSH",
      "description": "Detects when the Chrome browser spawns a descendant pwsh.exe process. This can be a sign of an attacker injection.",
      "text": "process.path ends with '\\\\pwsh.exe' AND process.ancestry_path ends with '\\\\chrome.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Chrome Spawned PWSH",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Chrome Spawned PowerShell",
      "description": "Detects when the Chrome browser spawns a descendant powershell.exe process. This can be a sign of an attacker injection.",
      "text": "process.path ends with '\\\\powershell.exe' AND process.ancestry_path ends with '\\\\chrome.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Chrome Spawned PowerShell",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Chrome Using SOCKS Proxy Tunneling via Command Line",
      "description": "Detects when Google Chrome is using the custom SOCKs proxy command-line option.  This Chrome feature can be utilized by attackers for activities such as SSH tunneling or accessing internal network services.",
      "text": "process.path ends with '\\\\chrome.exe' AND process.command_line contains '--proxy-server' AND process.command_line contains 'socks5://127.0.0.1:'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1090",
            "name": "Connection Proxy"
          },
          {
            "id": "T1079",
            "name": "Multilayer Encryption"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Chrome Using SOCKS Proxy Tunneling via Command Line",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1090",
              "name": "Connection Proxy"
            },
            {
              "id": "T1079",
              "name": "Multilayer Encryption"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1572",
              "name": "Protocol Tunneling"
            },
            {
              "id": "T1090",
              "name": "Proxy"
            },
            {
              "id": "T1573",
              "name": "Encrypted Channel"
            }
          ]
        }
      }
    },
    {
      "name": "CimProvider DLL Injection",
      "description": "Running CimProvider can be used by attackers to execute malicious code while bypassing security controls on systems.",
      "text": "process.path ends with '\\\\register-cimprovider.exe' AND process.command_line contains 'path'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "CimProvider DLL Injection",
      "modification-date": "2021-01-25T15:10:46.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "CmdKey Cached Credential Discovery",
      "description": "Detects the use of cmdkey.exe to list cached credentials on a system. This is a known living off the land attacker technique.",
      "text": "process.path ends with '\\\\cmdkey.exe' AND process.command_line contains 'list'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "CmdKey Cached Credential Discovery",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Code Execution via Windows Update Client",
      "description": "Detects the use of the Windows Update Client to execute a DLL.",
      "text": "process.path ends with '\\\\wuauclt.exe' AND process.command_line contains 'UpdateDeploymentProvider' AND process.command_line contains 'RunHandlerComServer' AND process.command_line contains NOT 'wuaueng.dll' AND process.command_line contains NOT 'UpdateDeploymentProvider.dll'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Code Execution via Windows Update Client",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Command Processor AutoRun Persistence",
      "description": "Detects when a AutoRun key for the command processor is set which can be used by attackers for persistence when the /D flag is not added to a command.",
      "text": "registry.key_path contains '\\\\Software\\\\Microsoft\\\\Command Processor\\\\AutoRun'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Command Processor AutoRun Persistence",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Command Quoted Directory Traversal Execution",
      "description": "Quoted strings containing dot dot slash in the command are parsed incorrectly allowing for directory traversal. This allows attackers to add characters to throw off detections or access executables in unexpected ways.",
      "text": "process.command_line contains '/../'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1202",
            "name": "Indirect Command Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Command Quoted Directory Traversal Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Command Shell Launched by Office Applications",
      "description": "Detects the execution of PowerShell or native command prompt by an Office application. May indicate document-based attacks.",
      "text": "(process.parent_path ends with '\\\\winword.exe' OR process.parent_path ends with '\\\\excel.exe' OR process.parent_path ends with '\\\\outlook.exe' OR process.parent_path ends with '\\\\powerpnt.exe' OR process.parent_path ends with '\\\\onenote.exe' OR process.parent_path ends with '\\\\mspub.exe' OR process.parent_path ends with '\\\\msaccess.exe' OR process.parent_path ends with '\\\\lync.exe') AND (process.path ends with '\\\\cmd.exe' OR process.path ends with '\\\\powershell.exe' OR process.path ends with '\\\\pwsh.exe')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1137",
            "name": "Office Application Startup"
          },
          {
            "id": "T1173",
            "name": "Dynamic Data Exchange"
          },
          {
            "id": "T1193",
            "name": "Spearphishing Attachment"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Command Shell Launched by Office Applications",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1137",
              "name": "Office Application Startup"
            },
            {
              "id": "T1173",
              "name": "Dynamic Data Exchange"
            },
            {
              "id": "T1193",
              "name": "Spearphishing Attachment"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1137",
              "name": "Office Application Startup"
            },
            {
              "id": "T1559",
              "name": "Inter-Process Communication"
            },
            {
              "id": "T1559.002",
              "name": "Inter-Process Communication: Dynamic Data Exchange"
            },
            {
              "id": "T1566",
              "name": "Phishing"
            },
            {
              "id": "T1566.001",
              "name": "Phishing: Spearphishing Attachment"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Common Language Runtime Image Load",
      "description": "Detects the use of Common Language Runtime (CLR) by loading clr.dll or mscorwks.dll into uncommon processes. This is a common sign of malicious code execution in a legitimate processes runspace such as done by SharpPack.dll and other .NET reflection techniques used to avoid AppLocker and other whitelisting tools.",
      "text": "(image.path ends with '\\\\clr.dll' OR image.path ends with '\\\\mscorwks.dll') AND (process.path ends with '\\\\winword.exe' OR process.path ends with '\\\\excel.exe' OR process.path ends with '\\\\powerpnt.exe' OR process.path ends with '\\\\chrome.exe' OR process.path ends with '\\\\firefox.exe' OR process.path ends with '\\\\iexplore.exe' OR process.path ends with '\\\\edge.exe' OR process.path ends with '\\\\lsass.exe' OR process.path ends with '\\\\explorer.exe' OR process.path ends with '\\\\services.exe' OR (process.path ends with '\\\\svchost.exe' AND process.command_line contains NOT '-k localsystemnetworkrestricted'))",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1129",
            "name": "Execution through Module Load"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Common Language Runtime Image Load",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1129",
              "name": "Execution through Module Load"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1055.001",
              "name": "Process Injection: Dynamic-link Library Injection"
            },
            {
              "id": "T1129",
              "name": "Shared Modules"
            }
          ]
        }
      }
    },
    {
      "name": "Compiled Help (CHM) Command Execution",
      "description": "Detects the use of Windows HTML Help (HH.EXE) to execute commands embedded within CHM files.",
      "text": "process.parent_path ends with '\\\\hh.exe' AND process.path ends with '\\\\cmd.exe' AND process.command_line contains '/c'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1223",
            "name": "Compiled HTML File"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Compiled Help (CHM) Command Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1223",
              "name": "Compiled HTML File"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.001",
              "name": "Signed Binary Proxy Execution: Compiled HTML File"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "ConfigSecurityPolicy Exfil Upload",
      "description": "Detects the potential use of ConfigSecurityPolicy.exe to upload data, which is a known living off the land technique for exfiltration.",
      "text": "process.path ends with '\\\\configsecuritypolicy.exe' AND process.command_line contains '://'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "ConfigSecurityPolicy Exfil Upload",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Conhost Spawned Executable",
      "description": "Enables Conhost to be able to run from the command line followed by an executable, which spawns it as a child process. Attackers can use this feature to perform indirect execution to evade some detection mechanisms.",
      "text": "process.parent_path ends with '\\\\conhost.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1202",
            "name": "Indirect Command Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Conhost Spawned Executable",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Control Panel Items",
      "description": "Control panel items can be used to execute arbitrary code and is a well known bypass mechanism for red teams and attackers.",
      "text": "(process.path ends with '\\\\rundll32.exe' AND process.command_line contains 'Control' AND process.command_line contains 'RunDLL') OR (file.path ends with '.cpl' AND (registry.key_path contains 'CurrentVersion\\\\Control Panel\\\\' OR registry.key_path contains '\\\\ControlPanel\\\\' OR registry.key_path contains '\\\\Control Folder\\\\') AND process.path ends with NOT 'OfficeClickToRun.exe')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1196",
            "name": "Control Panel Items"
          },
          {
            "id": "T1085",
            "name": "Rundll32"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Control Panel Items",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1196",
              "name": "Control Panel Items"
            },
            {
              "id": "T1085",
              "name": "Rundll32"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.002",
              "name": "Signed Binary Proxy Execution: Control Panel"
            },
            {
              "id": "T1218.011",
              "name": "Signed Binary Proxy Execution: Rundll32"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Control Panel Items Shell32",
      "description": "Control panel items can be used to execute arbitrary code and is a well-known bypass mechanism for red teams and attackers.",
      "text": "process.command_line contains 'shell32.dll' AND process.command_line contains 'Control_RunDLL'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1196",
            "name": "Control Panel Items"
          },
          {
            "id": "T1085",
            "name": "Rundll32"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Control Panel Items Shell32",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1196",
              "name": "Control Panel Items"
            },
            {
              "id": "T1085",
              "name": "Rundll32"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.002",
              "name": "Signed Binary Proxy Execution: Control Panel"
            },
            {
              "id": "T1218.011",
              "name": "Signed Binary Proxy Execution: Rundll32"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Credential Leak Manipulation",
      "description": "Detects changes to the TokeanLeakDetectDelaySecs setting. This setting can be used to cause credentials from logged off users to leak and persist in memory until the endpoint is rebooted. The is an attacker technique to allow for credentials to persist in memory for later capture.",
      "text": "registry.value_name is 'TokenLeakDetectDelaySecs'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": []
      },
      "syntax_version": 2,
      "id": "Credential Leak Manipulation",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": []
        },
        "v7": {
          "techniques": [
            {
              "id": "T1556",
              "name": "Modify Authentication Process"
            }
          ]
        }
      }
    },
    {
      "name": "Curl Commands Exfil Port 443",
      "description": "Detects common commands used to exfiltrate data with the curl.",
      "text": "process.path ends with 'curl' AND process.command_line contains '-F' AND process.command_line contains 'file' AND process.command_line contains '@' AND network.port is '443'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Curl Commands Exfil Port 443",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Curl Commands Exfil Port 80",
      "description": "Detects common commands used to exfiltrate data with curl.",
      "text": "process.path ends with 'curl' AND process.command_line contains '-F' AND process.command_line contains 'file' AND process.command_line contains '@' AND network.port is '80'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Curl Commands Exfil Port 80",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Curl.exe Commands Exfil Port 443",
      "description": "Detects common commands that are used to exfiltrate data with the curl.exe binary.",
      "text": "process.path ends with '\\\\curl.exe' AND process.command_line contains '-F' AND process.command_line contains 'file' AND process.command_line contains '@' AND network.port is '443'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Curl.exe Commands Exfil Port 443",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Curl.exe Commands Exfil Port 80",
      "description": "Detects common commands that are used to exfiltrate data with the curl.exe binary.",
      "text": "process.path ends with '\\\\curl.exe' AND process.command_line contains '-F' AND process.command_line contains 'file' AND process.command_line contains '@' AND network.port is '80'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Curl.exe Commands Exfil Port 80",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Data Destruction SDelete",
      "description": "Detects usage of Sysinternals SDelete. This tool securely overwrites data and can be used by attackers seeking to destroy data on systems making them unrecoverable or to erase evidence of prior activity.",
      "text": "registry.key_path contains 'Sysinternals\\\\SDelete'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1490",
            "name": "Inhibit System Recovery"
          },
          {
            "id": "T1485",
            "name": "Data Destruction"
          },
          {
            "id": "T1070",
            "name": "Indicator Removal on Host"
          },
          {
            "id": "T1107",
            "name": "File Deletion"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Data Destruction SDelete",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1485",
              "name": "Data Destruction"
            },
            {
              "id": "T1070",
              "name": "Indicator Removal on Host"
            },
            {
              "id": "T1107",
              "name": "File Deletion"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1485",
              "name": "Data Destruction"
            },
            {
              "id": "T1070",
              "name": "Indicator Removal on Host"
            },
            {
              "id": "T1070.004",
              "name": "Indicator Removal on Host: File Deletion"
            }
          ]
        }
      }
    },
    {
      "name": "DataSvcUtil Exfil Upload",
      "description": "Detects the potential use of DataSvcUtil.exe to upload data to a given uri, which is a known living off the land technique for exfiltration.",
      "text": "process.path ends with '\\\\datasvcutil.exe' AND process.command_line contains 'out' AND process.command_line contains 'uri'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "DataSvcUtil Exfil Upload",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Descendant of AppData Process Running as System",
      "description": "Detects when a process running out of AppData or a subdirectory is also running as the system, user which could indicate attacker activity.",
      "text": "process.ancestry_path contains '\\\\AppData\\\\' AND process.user_name is 'SYSTEM'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": []
      },
      "syntax_version": 4,
      "id": "Descendant of AppData Process Running as System",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": []
        },
        "v7": {
          "techniques": []
        }
      }
    },
    {
      "name": "Dfsvc File Download",
      "description": "Detects the use of rundll32.exe to potentially download a file to the system when it runs dfsvc.exe. This is a known attacker living off the land technique.",
      "text": "process.path ends with '\\\\rundll32.exe' AND process.command_line contains 'dfshim' AND process.command_line contains 'ShOpenVerbApplication'",
      "labels": [
        "Beta",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1085",
            "name": "Rundll32"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Dfsvc File Download",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1085",
              "name": "Rundll32"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.011",
              "name": "Signed Binary Proxy Execution: Rundll32"
            }
          ]
        }
      }
    },
    {
      "name": "Diantz File Download",
      "description": "Detects use of the Windows native utility diantz.exe to download a file. This is a known attacker living off the land technique.",
      "text": "process.path ends with '\\\\diantz.exe' AND process.command_line contains '\\\\\\\\'",
      "labels": [
        "Beta",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Diantz File Download",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Disable PowerShell Session Event Tracing",
      "description": "Detects disabling of the powershell session event tracing.",
      "text": "process.command_line contains 'System.Diagnostics.Eventing.EventProvider' AND process.command_line contains 'System.Management.Automation.Tracing.PSEtwLogProvider' AND process.command_line contains 'etwProvider'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Disable PowerShell Session Event Tracing",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.002",
              "name": "Impair Defenses: Disable Windows Event Logging"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Disable Security Events with MiniNT Registry Key",
      "description": "Detects the modification of the MiniNT registry key that disables all Windows security events.",
      "text": "registry.key_path contains 'CurrentControlSet\\\\Control\\\\MiniNt'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Disable Security Events with MiniNT Registry Key",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.002",
              "name": "Impair Defenses: Disable Windows Event Logging"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Disable Tanium ETW",
      "description": "Detects the use of logman to disable the Tanium ETW session.",
      "text": "process.command_line contains 'logman' AND process.command_line contains 'stop' AND process.command_line contains 'TaniumRecorderETWSession' ",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Disable Tanium ETW",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            }
          ]
        }
      }
    },
    {
      "name": "Disable Windows Defender",
      "description": "Detects the modification of the Windows Defender DisableAntiSpyware setting in the registry.",
      "text": "group(registry.key_path contains '\\\\SOFTWARE\\\\Policies\\\\Microsoft\\\\Windows Defender' AND registry.value_name contains 'DisableAntiSpyware') AND (process.command_line contains NOT '-k GPSvcGroup' OR process.path ends with NOT '\\\\svchost.exe')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Disable Windows Defender",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Disable Windows Update",
      "description": "Detects the use of sc to disable Window Update, which can be related to attacker activity..",
      "text": "process.path contains '\\\\sc.exe' AND process.command_line contains 'wuauserv' AND process.command_line contains 'start=' AND process.command_line contains 'disabled'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Disable Windows Update",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            }
          ]
        }
      }
    },
    {
      "name": "Disabling Cisco AMP",
      "description": "Detects the disablement of Cisco AMP, which can be a sign of an attacker avoiding detection.",
      "text": "process.path ends with '\\\\sfc.exe' AND process.command_line contains 'stop'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Disabling Cisco AMP",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            }
          ]
        }
      }
    },
    {
      "name": "Disabling Symantec Endpoint Protection",
      "description": "Detects the disablement of Symantec Endpoint Protection, which can be a sign of an attacker avoiding detection.",
      "text": "process.path ends with '\\\\smc.exe' AND process.command_line contains 'disable' AND process.command_line contains 'sep'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Disabling Symantec Endpoint Protection",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            }
          ]
        }
      }
    },
    {
      "name": "Disk Cleanup Persistence CleanupString",
      "description": "Detects the creation of CleanupString persistence specifying an executable file and optional command line parameters. This command line is then executed at the completion of the disk cleanup.",
      "text": "group(registry.key_path starts with 'HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\VolumeCaches' AND registry.value_name is 'CleanupString')",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Disk Cleanup Persistence CleanupString",
      "modification-date": "2020-10-13T19:31:33.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Disk Cleanup Persistence PreCleanupString",
      "description": "Detects the creation of PreCleanupString persistence specifying an executable file and optional command line parameters. This command line is then executed prior to cleanup.",
      "text": "group(registry.key_path starts with 'HKEY_LOCAL_MACHINE\\\\SOFTWARE\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\VolumeCaches' AND registry.value_name is 'PreCleanupString')",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Disk Cleanup Persistence PreCleanupString",
      "modification-date": "2020-10-13T19:31:33.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Diskshadow Script Execution",
      "description": "Detects the use of diskshadow.exe with the script flag. This can be used as an AppLocker bypass or to execute arbitrary binaries.",
      "text": "process.path ends with 'diskshadow.exe' AND process.command_line contains '/s'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Diskshadow Script Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Diskshadow Spawned Process",
      "description": "Diskshadow Spawned Process: Detects the use of diskshadow.exe to spawn a child process. This is a known attacker living off the land technique.",
      "text": "process.parent_path ends with '\\\\diskshadow.exe' AND process.path ends with NOT '\\\\conhost.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1202",
            "name": "Indirect Command Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Diskshadow Spawned Process",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Dnscmd Remote DNS Server DLL Injection",
      "description": "Detects the use of Windows utility dnscmd.exe to add a remote server plugins dll. This is a known attacker living off the land technique.",
      "text": "process.path ends with '\\\\dnscmd.exe' AND process.command_line contains 'serverlevelplugindll' AND process.command_line contains '\\\\\\\\'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Dnscmd Remote DNS Server DLL Injection",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1574",
              "name": "Hijack Execution Flow"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Domain Account Enumeration",
      "description": "Detects usage of the NET.EXE utility to enumerate domain users. Often used during post-compromise reconnaissance.",
      "text": "(process.path ends with '\\\\net.exe' OR process.path ends with '\\\\net1.exe') AND process.command_line contains 'user' AND process.command_line contains '/Domain' AND process.parent_command_line contains NOT 'windows\\\\ccmcache' AND process.parent_path contains NOT 'windows\\\\ccmcache' AND process.parent_command_line contains NOT '\\\\SupportAssist' AND process.parent_path contains NOT 'SupportAssist'",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1087",
            "name": "Account Discovery"
          },
          {
            "id": "T1069",
            "name": "Permission Groups Discovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Domain Account Enumeration",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1087",
              "name": "Account Discovery"
            },
            {
              "id": "T1069",
              "name": "Permission Groups Discovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1087",
              "name": "Account Discovery"
            },
            {
              "id": "T1087.002",
              "name": "Account Discovery: Domain Account"
            },
            {
              "id": "T1069",
              "name": "Permission Groups Discovery"
            },
            {
              "id": "T1069.002",
              "name": "Permission Groups Discovery: Domain Groups"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Edge Spawned CMD",
      "description": "Detects when the Edge browser spawns a descendant cmd.exe process. This can be a sign of an attacker injection.",
      "text": "process.path ends with '\\\\cmd.exe' AND process.ancestry_path ends with '\\\\msedge.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Edge Spawned CMD",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Edge Spawned PWSH",
      "description": "Detects when the Edge browser spawns a descendant pwsh.exe process. This can be a sign of an attacker injection.",
      "text": "process.path ends with '\\\\pwsh.exe' AND process.ancestry_path ends with '\\\\msedge.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Edge Spawned PWSH",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Edge Spawned PowerShell",
      "description": "Detects when the Edge browser spawns a descendant powershell.exe process. This can be a sign of an attacker injection.",
      "text": "process.path ends with '\\\\powershell.exe' AND process.ancestry_path ends with '\\\\msedge.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Edge Spawned PowerShell",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Emond Modification",
      "description": "Detects Modification to file paths that are related to macOS Event Monitor Daemon (emond).  Adversaries can add rules or scripts to these locations in an attempt to gain persistence.",
      "text": "group ((file.operation is 'write' OR file.operation is 'create') AND (file.path contains '/etc/emond.d/rules/' OR file.path contains '/private/var/db/emondClients/'))",
      "labels": [
        "Beta",
        "Execution",
        "Persistence",
        "Mac"
      ],
      "platforms": [
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1519",
            "name": "Emond"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Emond Modification",
      "modification-date": "2021-05-24T15:20:29.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1519",
              "name": "Emond"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546.014",
              "name": "Event Triggered Execution: Emond"
            },
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Esentutl Remote File Download or Upload",
      "description": "Detects use of the Windows native utility esentutl.exe to upload or download a file. This is a known attacker living off the land technique.",
      "text": "process.path ends with '\\\\esentutl.exe' AND process.command_line contains '\\\\\\\\'",
      "labels": [
        "Beta",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Esentutl Remote File Download or Upload",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Esentutl Retrieve Locked File with Volume Shadow Copy",
      "description": "Detects the use of esentutl.exe to copy a potentially locked file from the volume shadow copy. This is a known attacker living off the land technique.",
      "text": "process.path ends with '\\\\esentutl.exe' AND process.command_line contains 'vss' ",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1003",
            "name": "Credential Dumping"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Esentutl Retrieve Locked File with Volume Shadow Copy",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1003",
              "name": "Credential Dumping"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            },
            {
              "id": "T1003.003",
              "name": "OS Credential Dumping: NTDS"
            }
          ]
        }
      }
    },
    {
      "name": "Excel Spawned Connection to Port 443",
      "description": "Detects the connection to port 443 by a descendent process of Excel which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\excel.exe' AND process.path ends with NOT '\\\\excel.exe' AND network.port is '443'",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Excel Spawned Connection to Port 443",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Excel Spawned Connection to Port 80",
      "description": "Detects the connection to port 80 by a descendent process of Excel which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\excel.exe' AND process.path ends with NOT '\\\\excel.exe' AND network.port is '80'",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Excel Spawned Connection to Port 80",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Excel Spawned Process Creating BAT Files",
      "description": "Detects the creation of BAT files by Excel or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\excel.exe' AND group(file.operation is 'create' AND file.path ends with '.bat')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Excel Spawned Process Creating BAT Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Excel Spawned Process Creating CMD Files",
      "description": "Detects the creation of CMD files by Excel or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\excel.exe' AND group(file.operation is 'create' AND file.path ends with '.cmd')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Excel Spawned Process Creating CMD Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Excel Spawned Process Creating DLL Files",
      "description": "Detects the creation of DLL files by Excel or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\excel.exe' AND group(file.operation is 'create' AND file.path ends with '.dll')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Excel Spawned Process Creating DLL Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Excel Spawned Process Creating EXE Files",
      "description": "Detects the creation of EXE files by Excel or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\excel.exe' AND group(file.operation is 'create' AND file.path ends with '.exe')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Excel Spawned Process Creating EXE Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Excel Spawned Process Creating PS1 Files",
      "description": "Detects the creation of PS1 files by Excel or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\excel.exe' AND group(file.operation is 'create' AND file.path ends with '.ps1')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Excel Spawned Process Creating PS1 Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Excel Spawned Process Creating SYS Files",
      "description": "Detects the creation of SYS files by Excel or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\excel.exe' AND group(file.operation is 'create' AND file.path ends with '.sys')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Excel Spawned Process Creating SYS Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Excel Spawned Process Creating VBS Files",
      "description": "Detects the creation of VBS files by Excel or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\excel.exe' AND group(file.operation is 'create' AND file.path ends with '.vbs')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Excel Spawned Process Creating VBS Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.005",
              "name": "Command and Scripting Interpreter: Visual Basic"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Excel Web Query Execution",
      "description": "Detects the use of excel web query files for execution commonly used as an AppLocker bypass.",
      "text": "group(file.operation is 'create' AND file.path ends with '.iqy')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Excel Web Query Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Expand File Download",
      "description": "Detects use of the Windows native utility expand.exe to download a file. This is a known attacker living off the land technique.",
      "text": "process.path ends with '\\\\expand.exe' AND process.command_line contains '\\\\\\\\'",
      "labels": [
        "Beta",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Expand File Download",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Explorer Spawned Executable",
      "description": "Enables Explorer to be run from the command line followed by an executable, which spawns it as a child process. Attackers can use this feature to perform indirect execution to evade some detection mechanisms.",
      "text": "process.path ends with '\\\\explorer.exe' AND process.command_line contains '/factory' AND process.command_line contains '-Embedding' AND process.parent_path is '<Unknown Process>'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1202",
            "name": "Indirect Command Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Explorer Spawned Executable",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        }
      }
    },
    {
      "name": "ExtExport DLL Execution",
      "description": "ExtExport is normally used to export firefox settings but can be abused since it loads any DLL named mozcrt19.dll, mozsqlite3.dll, or sqlite3.dll that resides in the directory given.",
      "text": "process.path ends with '\\\\ExtExport.exe' AND process.command_line contains NOT '\\\\firefox\\\\'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1073",
            "name": "DLL Side-Loading"
          }
        ]
      },
      "syntax_version": 1,
      "id": "ExtExport DLL Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1073",
              "name": "DLL Side-Loading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1574",
              "name": "Hijack Execution Flow"
            },
            {
              "id": "T1574.002",
              "name": "Hijack Execution Flow: DLL Side-Loading"
            }
          ]
        }
      }
    },
    {
      "name": "Extrac32 Download File",
      "description": "Detects the use of the Windows native utility extrac32.exe to download a file.",
      "text": "process.path ends with '\\\\extrac32.exe' AND process.command_line contains '\\\\\\\\' ",
      "labels": [
        "Beta",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Extrac32 Download File",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Extract Keychain Credentials",
      "description": "Detects the use of dump-keychain which is used to extract Keychain Credentials.",
      "text": "process.command_line contains 'sudo' AND process.command_line contains 'security' AND process.command_line contains 'dump-keychain' AND process.command_line contains 'login.keychain'",
      "labels": [
        "Beta",
        "Credential Access",
        "Mac"
      ],
      "platforms": [
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1142",
            "name": "Keychain"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Extract Keychain Credentials",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1142",
              "name": "Keychain"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1555",
              "name": "Credentials from Password Stores"
            },
            {
              "id": "T1555.001",
              "name": "Credentials from Password Stores: Keychain"
            }
          ]
        }
      }
    },
    {
      "name": "FTP Spawned by CMD",
      "description": "Detects when ftp.exe spawns cmd.exe. This can be a sign of attackers using ftp for download or execution. This is a known living off the land technique.",
      "text": "process.path ends with '\\\\cmd.exe' AND process.ancestry_path ends with '\\\\ftp.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 4,
      "id": "FTP Spawned by CMD",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "File Download with Desktopimgdownldr",
      "description": "Detects the use of desktopimgdownldr.exe to download a file.",
      "text": "process.path ends with '\\\\desktopimgdownldr.exe' AND process.command_line contains 'lockscreenurl'",
      "labels": [
        "Beta",
        "Command and Control",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1202",
            "name": "Indirect Command Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "File Download with Desktopimgdownldr",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Findstr Credential Harvesting",
      "description": "Detects the use of the Windows native utility findstr.exe to search for passwords in files.",
      "text": "process.path ends with '\\\\findstr.exe' AND process.command_line contains 'password'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": []
      },
      "syntax_version": 1,
      "id": "Findstr Credential Harvesting",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": []
        },
        "v7": {
          "techniques": [
            {
              "id": "T1555",
              "name": "Credentials from Password Stores"
            }
          ]
        }
      }
    },
    {
      "name": "Findstr Download File",
      "description": "Detects the use of the Windows native utility findstr.exe to download a file.",
      "text": "process.path ends with '\\\\findstr.exe' AND process.command_line contains '/V' AND process.command_line contains '\\\\\\\\' ",
      "labels": [
        "Beta",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Findstr Download File",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Firefox Modifying Files in Windows Directory",
      "description": "Detects Firefox or a descendent process modifying files in the windows directory, which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\firefox.exe' AND group(file.path contains ':\\\\windows' AND file.path contains NOT 'tzres.dll')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Firefox Modifying Files in Windows Directory",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.001",
              "name": "User Execution: Malicious Link"
            }
          ]
        }
      }
    },
    {
      "name": "Firefox Spawned Cmd",
      "description": "Detects when the Firefox browser spawns a descendant cmd.exe process. This can be a sign of an attacker injection.",
      "text": "process.path ends with '\\\\cmd.exe' AND process.ancestry_path ends with '\\\\firefox.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Firefox Spawned Cmd",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Firefox Spawned PWSH",
      "description": "Detects when the Firefox browser spawns a descendant pwsh.exe process. This can be a sign of an attacker injection.",
      "text": "process.path ends with '\\\\pwsh.exe' AND process.ancestry_path ends with '\\\\firefox.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Firefox Spawned PWSH",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Firefox Spawned PowerShell",
      "description": "Detects when the Firefox browser spawns a descendant powershell.exe process. This can be a sign of an attacker injection.",
      "text": "process.path ends with '\\\\powershell.exe' AND process.ancestry_path ends with '\\\\firefox.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Firefox Spawned PowerShell",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Folder Permission Enumeration",
      "description": "Monitors for commands used to enumerate files with weak permissions. Files with weak permissions can some times be used for privilege escalation or persistence.",
      "text": "process.command_line contains 'find' AND process.command_line contains '-perm' AND (process.command_line contains '-002' OR process.command_line contains '-0+w' OR process.command_line contains '777' OR process.command_line contains '-a=w' OR process.command_line contains '4000' OR process.command_line contains '2000' OR process.command_line contains '6000')",
      "labels": [
        "Beta",
        "Discovery",
        "Persistence",
        "Privilege Escalation",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "mac",
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1044",
            "name": "File System Permissions Weakness"
          },
          {
            "id": "T1083",
            "name": "File and Directory Discovery"
          },
          {
            "id": "T1166",
            "name": "Setuid and Setgid"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Folder Permission Enumeration",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1044",
              "name": "File System Permissions Weakness"
            },
            {
              "id": "T1083",
              "name": "File and Directory Discovery"
            },
            {
              "id": "T1166",
              "name": "Setuid and Setgid"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1574",
              "name": "Hijack Execution Flow"
            },
            {
              "id": "T1574.010",
              "name": "Hijack Execution Flow: Services File Permissions Weakness"
            },
            {
              "id": "T1083",
              "name": "File and Directory Discovery"
            },
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1548.001",
              "name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
            }
          ]
        }
      }
    },
    {
      "name": "Fsutil Deleting USN Journal",
      "description": "Detects the use of the fsutil to delete the USN journal. Often used by ransomware and destructive malware to eliminate backed-up data, and by targeted attackers seeking to destroy evidence of prior activity.",
      "text": "process.path ends with '\\\\fsutil.exe' AND process.command_line contains 'usn' AND process.command_line contains 'deletejournal'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1490",
            "name": "Inhibit System Recovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1485",
            "name": "Data Destruction"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Fsutil Deleting USN Journal",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1485",
              "name": "Data Destruction"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1485",
              "name": "Data Destruction"
            }
          ]
        }
      }
    },
    {
      "name": "GDB Commands Reverse Shell",
      "description": "Detects common commands used to create a reverse shell with GDB.",
      "text": "process.path ends with 'gdb' AND process.command_line contains 'python' AND process.command_line contains 'import' AND process.command_line contains 'socket' AND process.command_line contains 'pty' AND process.command_line contains 'connect' AND process.command_line contains 'getenv' AND process.command_line contains 'dup2' AND process.command_line contains 'fileno' AND process.command_line contains 'spawn' AND process.command_line contains 'sh'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "GDB Commands Reverse Shell",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.006",
              "name": "Command and Scripting Interpreter: Python"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Gatekeeper Bypass",
      "description": "Monitors for known methods of bypassing MacOS Gatekeeper.",
      "text": "(process.command_line contains 'xattr' AND process.command_line contains '-r' AND process.command_line contains '-d' AND process.command_line contains 'com.apple.quarantine') OR (process.command_line contains 'spctl' AND process.command_line contains '--master-disable')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Mac"
      ],
      "platforms": [
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1144",
            "name": "Gatekeeper Bypass"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Gatekeeper Bypass",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1144",
              "name": "Gatekeeper Bypass"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1553",
              "name": "Subvert Trust Controls"
            },
            {
              "id": "T1553.001",
              "name": "Subvert Trust Controls: Gatekeeper Bypass"
            }
          ]
        }
      }
    },
    {
      "name": "Gfxdownloadwrapper Download File",
      "description": "Detects the use of GFXDownloadWrapper to download files from the internet. This is a known attacker living off the land technique.",
      "text": "process.path ends with '\\\\gfxdownloadwrapper.exe' AND process.command_line contains NOT '.json'",
      "labels": [
        "Beta",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Gfxdownloadwrapper Download File",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "GlobalFlags Persistence",
      "description": "Detects the creation and execution of global flags technique using registry to launch a process after another process terminates.",
      "text": "group(registry.key_path contains '\\\\SilentProcessExit' AND (registry.value_name contains 'MonitorProcess' OR registry.value_name contains 'ReportingMode')) OR process.parent_path ends with '\\\\WerFault.exe' AND (process.path ends with '\\\\cmd.exe' OR process.path ends with '\\\\powershell.exe' OR process.path ends with '\\\\pwsh.exe')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1183",
            "name": "Image File Execution Options Injection"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 2,
      "id": "GlobalFlags Persistence",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1183",
              "name": "Image File Execution Options Injection"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.012",
              "name": "Event Triggered Execution: Image File Execution Options Injection"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Group Policy Script Creation bat",
      "description": "Detects the creation of a group policy script which can be used for persistence by an attacker.",
      "text": "group( file.operation is 'create' AND file.path contains 'SYSVOL' AND file.path contains NOT 'AppData\\\\Local\\\\GroupPolicy\\\\DataStore' AND file.path contains '.bat' ) AND process.path ends with NOT '\\\\svchost.exe'",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1037",
            "name": "Logon Scripts"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Group Policy Script Creation bat",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Logon Scripts"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Boot or Logon Initialization Scripts"
            },
            {
              "id": "T1037.003",
              "name": "Boot or Logon Initialization Scripts: Network Logon Script"
            }
          ]
        }
      }
    },
    {
      "name": "Group Policy Script Creation domainscripts",
      "description": "Detects the creation of a group policy script which can be used for persistence by an attacker.",
      "text": "group( file.operation is 'create' AND file.path contains 'SYSVOL' AND file.path contains NOT 'AppData\\\\Local\\\\GroupPolicy\\\\DataStore' AND file.path contains 'domainscripts' ) AND process.path ends with NOT '\\\\svchost.exe'",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1037",
            "name": "Logon Scripts"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Group Policy Script Creation domainscripts",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Logon Scripts"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Boot or Logon Initialization Scripts"
            },
            {
              "id": "T1037.003",
              "name": "Boot or Logon Initialization Scripts: Network Logon Script"
            }
          ]
        }
      }
    },
    {
      "name": "Group Policy Script Creation hta",
      "description": "Detects the creation of a group policy script which can be used for persistence by an attacker.",
      "text": "group( file.operation is 'create' AND file.path contains 'SYSVOL' AND file.path contains NOT 'AppData\\\\Local\\\\GroupPolicy\\\\DataStore' AND file.path contains '.hta' ) AND process.path ends with NOT '\\\\svchost.exe'",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1037",
            "name": "Logon Scripts"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Group Policy Script Creation hta",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Logon Scripts"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Boot or Logon Initialization Scripts"
            },
            {
              "id": "T1037.003",
              "name": "Boot or Logon Initialization Scripts: Network Logon Script"
            }
          ]
        }
      }
    },
    {
      "name": "Group Policy Script Creation js",
      "description": "Detects the creation of a group policy script which can be used for persistence by an attacker.",
      "text": "group( file.operation is 'create' AND file.path contains 'SYSVOL' AND file.path contains NOT 'AppData\\\\Local\\\\GroupPolicy\\\\DataStore' AND file.path contains '.js' ) AND process.path ends with NOT '\\\\svchost.exe'",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1037",
            "name": "Logon Scripts"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Group Policy Script Creation js",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Logon Scripts"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Boot or Logon Initialization Scripts"
            },
            {
              "id": "T1037.003",
              "name": "Boot or Logon Initialization Scripts: Network Logon Script"
            }
          ]
        }
      }
    },
    {
      "name": "Group Policy Script Creation ps1",
      "description": "Detects the creation of a group policy script which can be used for persistence by an attacker.",
      "text": "group( file.operation is 'create' AND file.path contains 'SYSVOL' AND file.path contains NOT 'AppData\\\\Local\\\\GroupPolicy\\\\DataStore' AND file.path contains '.ps1' ) AND process.path ends with NOT '\\\\svchost.exe'",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1037",
            "name": "Logon Scripts"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Group Policy Script Creation ps1",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Logon Scripts"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Boot or Logon Initialization Scripts"
            },
            {
              "id": "T1037.003",
              "name": "Boot or Logon Initialization Scripts: Network Logon Script"
            }
          ]
        }
      }
    },
    {
      "name": "Group Policy Script Creation scripts",
      "description": "Detects the creation of a group policy script which can be used for persistence by an attacker.",
      "text": "group( file.operation is 'create' AND file.path contains 'SYSVOL' AND file.path contains NOT 'AppData\\\\Local\\\\GroupPolicy\\\\DataStore' AND file.path contains 'scripts.ini' ) AND process.path ends with NOT '\\\\svchost.exe'",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1037",
            "name": "Logon Scripts"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Group Policy Script Creation scripts.ini",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Logon Scripts"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Boot or Logon Initialization Scripts"
            },
            {
              "id": "T1037.003",
              "name": "Boot or Logon Initialization Scripts: Network Logon Script"
            }
          ]
        }
      }
    },
    {
      "name": "Group Policy Script Creation vba",
      "description": "Detects the creation of a group policy script which can be used for persistence by an attacker.",
      "text": "group( file.operation is 'create' AND file.path contains 'SYSVOL' AND file.path contains NOT 'AppData\\\\Local\\\\GroupPolicy\\\\DataStore' AND file.path contains '.vba' ) AND process.path ends with NOT '\\\\svchost.exe'",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1037",
            "name": "Logon Scripts"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Group Policy Script Creation vba",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Logon Scripts"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Boot or Logon Initialization Scripts"
            },
            {
              "id": "T1037.003",
              "name": "Boot or Logon Initialization Scripts: Network Logon Script"
            }
          ]
        }
      }
    },
    {
      "name": "Group Policy Script Creation vbs",
      "description": "Detects the creation of a group policy script which can be used for persistence by an attacker.",
      "text": "group( file.operation is 'create' AND file.path contains 'SYSVOL' AND file.path contains NOT 'AppData\\\\Local\\\\GroupPolicy\\\\DataStore' AND file.path contains '.vbs' ) AND process.path ends with NOT '\\\\svchost.exe'",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1037",
            "name": "Logon Scripts"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Group Policy Script Creation vbs",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Logon Scripts"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1037",
              "name": "Boot or Logon Initialization Scripts"
            },
            {
              "id": "T1037.003",
              "name": "Boot or Logon Initialization Scripts: Network Logon Script"
            }
          ]
        }
      }
    },
    {
      "name": "Hosts File Modification",
      "description": "Detects if the local hosts file has been modified, which may be indicative of attacker hosts file injection.",
      "text": "group(file.operation is NOT 'delete' AND file.path contains 'etc' AND file.path ends with '\\\\hosts') AND process.path ends with NOT '\\\\wuauclt.exe'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "windows",
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": []
      },
      "syntax_version": 3,
      "id": "Hosts File Modification",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": []
        },
        "v7": {
          "techniques": [
            {
              "id": "T1557",
              "name": "Man-in-the-Middle"
            }
          ]
        }
      }
    },
    {
      "name": "IIS Worker Suspicious CMD Creation",
      "description": "This signal detects when an IIS worker process has children loading CMD and can be indicative of attacker activity.",
      "text": "process.parent_path ends with '\\\\w3wp.exe' AND process.path ends with '\\\\cmd.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "IIS Worker Suspicious CMD Creation",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "IIS Worker Suspicious Net Creation",
      "description": "This signal detects when an IIS worker process has child net processes and can be indicative of attacker activity.",
      "text": "process.parent_path ends with '\\\\w3wp.exe' AND process.path ends with '\\\\net.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          }
        ]
      },
      "syntax_version": 1,
      "id": "IIS Worker Suspicious Net Creation",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            }
          ]
        }
      }
    },
    {
      "name": "IIS Worker Suspicious PowerShell Creation",
      "description": "This signal detects when an IIS worker process has children loading the PowerShell DLL and can be indicative of attacker activity.",
      "text": "process.parent_path ends with '\\\\w3wp.exe' AND image.path contains 'System.Management.Automation'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 4,
      "id": "IIS Worker Suspicious PowerShell Creation",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "IIS Worker Suspicious whoami Creation",
      "description": "This signal detects when an IIS worker process has child whoami processes and can be indicative of attacker activity.",
      "text": "process.parent_path ends with '\\\\w3wp.exe' AND process.path ends with '\\\\whoami.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1033",
            "name": "System Owner/User Discovery"
          }
        ]
      },
      "syntax_version": 1,
      "id": "IIS Worker Suspicious whoami Creation",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1033",
              "name": "System Owner/User Discovery"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1033",
              "name": "System Owner/User Discovery"
            },
            {
              "id": "T1592",
              "name": "Gather Victim Host Information"
            }
          ]
        }
      }
    },
    {
      "name": "Ie4uinit Binary Duplication",
      "description": "Duplication of the ie4uinit.exe binary outside of the Windows directory can be used as an execution proxy for malicious executables. This is a known living off the land attacker technique.",
      "text": "group(file.path contains NOT '\\\\windows\\\\' AND file.path ends with '\\\\ie4uinit.exe')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1202",
            "name": "Indirect Command Execution"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Ie4uinit Binary Duplication",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Ieexec Download and Execution",
      "description": "Detects the use of .NET utility ieexec.exe to download and execute a binary. This is a known living off the land attacker technique.",
      "text": "process.path ends with '\\\\ieexec.exe' AND process.command_line contains '://' ",
      "labels": [
        "Beta",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1202",
            "name": "Indirect Command Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Ieexec Download and Execution",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Ifconfig Enable Promiscuous Mode",
      "description": "Enables promiscuous mode with ifconfig on a network interface. This can be used by attackers to monitor for passwords or other data of interest being transmitted over the wire.",
      "text": "process.command_line contains 'ifconfig' AND process.command_line contains 'promisc'",
      "labels": [
        "Beta",
        "Credential Access",
        "Discovery",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1040",
            "name": "Network Sniffing"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Ifconfig Enable Promiscuous Mode",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1040",
              "name": "Network Sniffing"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1040",
              "name": "Network Sniffing"
            }
          ]
        }
      }
    },
    {
      "name": "Ilasm DLL Compilation",
      "description": "Detects the use of the .NET tool ilasm.exe to compile a DLL. This is a known living off the land attacker technique for compiling code. It can also be used by .NET developers in your environment.",
      "text": "process.path ends with '\\\\ilasm.exe' AND process.command_line contains '/dll' ",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1027",
            "name": "Obfuscated Files or Information"
          },
          {
            "id": "T1500",
            "name": "Compile After Delivery"
          },
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Ilasm DLL Compilation",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            },
            {
              "id": "T1500",
              "name": "Compile After Delivery"
            },
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            },
            {
              "id": "T1027.004",
              "name": "Obfuscated Files or Information: Compile After Delivery"
            },
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Ilasm EXE complication",
      "description": "Detects the use of the .NET tool ilasm.exe to compile a binary. This is a known living off the land attacker technique for compiling code. It can also be used by .NET developers in your environment.",
      "text": "process.path ends with '\\\\ilasm.exe' AND process.command_line contains '/exe' ",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1027",
            "name": "Obfuscated Files or Information"
          },
          {
            "id": "T1500",
            "name": "Compile After Delivery"
          },
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Ilasm EXE compilation",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            },
            {
              "id": "T1500",
              "name": "Compile After Delivery"
            },
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            },
            {
              "id": "T1027.004",
              "name": "Obfuscated Files or Information: Compile After Delivery"
            },
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Image File Debugger Tampering - Sticky Keys Attack",
      "description": "Detects changes to the debugger configuration settings for Sethc which can be used for persistent execution of the configured debugger.",
      "text": "group(registry.key_path contains 'Image File Execution Options' AND registry.value_name contains 'Debugger') AND process.parent_path contains NOT 'WindowsUpdateBox.exe'",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Image File Debugger Tampering - Sticky Keys Attack",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Image File Debugger Tampering AtBroker",
      "description": "Detects changes to the debugger configuration settings for atbroker.exe which can be used for persistent execution of the configured debugger.",
      "text": "group(registry.key_path contains 'Image File Execution Options' AND registry.key_path contains 'atbroker.exe' AND registry.value_name contains 'Debugger')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Image File Debugger Tampering AtBroker",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Image File Debugger Tampering DisplaySwitch",
      "description": "Detects changes to the debugger configuration settings for displatswitch.exe which can be used for persistent execution of the configured debugger.",
      "text": "group(registry.key_path contains 'Image File Execution Options' AND registry.key_path contains 'displayswitch.exe' AND registry.value_name contains 'Debugger')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Image File Debugger Tampering DisplaySwitch",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Image File Debugger Tampering Magnify",
      "description": "Detects changes to the debugger configuration settings for magnify.exe which can be used for persistent execution of the configured debugger.",
      "text": "group(registry.key_path contains 'Image File Execution Options' AND registry.key_path contains 'magnify.exe' AND registry.value_name contains 'Debugger')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Image File Debugger Tampering Magnify",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Image File Debugger Tampering Narrator",
      "description": "Detects changes to the debugger configuration settings for narrator.exe which can be used for persistent execution of the configured debugger.",
      "text": "group(registry.key_path contains 'Image File Execution Options' AND registry.key_path contains 'narrator.exe' AND registry.value_name contains 'Debugger')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Image File Debugger Tampering Narrator",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Image File Debugger Tampering Osk",
      "description": "Detects changes to the debugger configuration settings for osk.exe which can be used for persistent execution of the configured debugger.",
      "text": "group(registry.key_path contains 'Image File Execution Options' AND registry.key_path contains 'osk.exe' AND registry.value_name contains 'Debugger')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Image File Debugger Tampering Osk",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Image File Debugger Tampering Sethc",
      "description": "Detects changes to the debugger configuration settings for sethc.exe which can be used for persistent execution of the configured debugger.",
      "text": "group(registry.key_path contains 'Image File Execution Options' AND registry.key_path contains 'sethc.exe' AND registry.value_name contains 'Debugger')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Image File Debugger Tampering Sethc",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Image File Debugger Tampering Utilman",
      "description": "Detects changes to the debugger configuration settings for utilman.exe which can be used for persistent execution of the configured debugger.",
      "text": "group(registry.key_path contains 'Image File Execution Options' AND registry.key_path contains 'utilman.exe' AND registry.value_name contains 'Debugger')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Image File Debugger Tampering Utilman",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Indirect Command Execution",
      "description": "Indirect command execution is used by attackers to execute binaries without calling them directly or from a command prompt. This is a common method of evading detection.",
      "text": "(process.path ends with '\\\\forfiles.exe' AND process.command_line contains '/c') OR (process.path ends with '\\\\pcalua.exe' AND process.command_line contains '-a') OR (process.path ends with '\\\\AtBroker.exe' AND process.command_line contains '/start') OR (process.path ends with '\\\\bash.exe' AND process.command_line contains '-c')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1196",
            "name": "Control Panel Items"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1202",
            "name": "Indirect Command Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Indirect Command Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1196",
              "name": "Control Panel Items"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.002",
              "name": "Signed Binary Proxy Execution: Control Panel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Indirect Command Execution AtBroker",
      "description": "This signal detects the use of AtBroker.exe to perform indirect command execution used to execute potentially malicious code with a known process.",
      "text": "process.path ends with '\\\\AtBroker.exe' AND process.command_line contains '/start' AND process.command_line contains NOT 'narrator' AND process.command_line contains NOT 'hardwarebuttonlaunch' AND process.command_line contains NOT 'magnifierpane'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1196",
            "name": "Control Panel Items"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1202",
            "name": "Indirect Command Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Indirect Command Execution AtBroker",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1196",
              "name": "Control Panel Items"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.002",
              "name": "Signed Binary Proxy Execution: Control Panel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Indirect Command Execution Bash",
      "description": "This signal detects the use of bash.exe to perform indirect command execution used to execute potentially malicious code with a known process.",
      "text": "process.path ends with '\\\\bash.exe' AND process.command_line contains '-c'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1196",
            "name": "Control Panel Items"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1202",
            "name": "Indirect Command Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Indirect Command Execution Bash",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1196",
              "name": "Control Panel Items"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.002",
              "name": "Signed Binary Proxy Execution: Control Panel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Indirect Command Execution Forfiles",
      "description": "This signal detects the use of forfiles.exe to perform indirect command execution used to execute potentially malicious code with a known process.",
      "text": "process.path ends with '\\\\forfiles.exe' AND process.command_line contains '/c'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1196",
            "name": "Control Panel Items"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1202",
            "name": "Indirect Command Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Indirect Command Execution Forfiles",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1196",
              "name": "Control Panel Items"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.002",
              "name": "Signed Binary Proxy Execution: Control Panel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Indirect Command Execution Pcalua",
      "description": "This signal detects the use of pcalua.exe to perform indirect command execution used to execute potentially malicious code with a known process.",
      "text": "process.path ends with '\\\\pcalua.exe' AND process.command_line contains '-a'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1196",
            "name": "Control Panel Items"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1202",
            "name": "Indirect Command Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Indirect Command Execution Pcalua",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1196",
              "name": "Control Panel Items"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.002",
              "name": "Signed Binary Proxy Execution: Control Panel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        }
      }
    },
    {
      "name": "InstallUtil AppLocker Bypass DLL",
      "description": "Detects the misuse of InstallUtil.exe for injecting and executing unsigned code with the uninstall flag.",
      "text": "process.path ends with '\\\\installutil.exe' AND process.command_line contains '/u' AND process.command_line contains '.dll' AND process.parent_path contains NOT 'msiexec.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1118",
            "name": "InstallUtil"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "InstallUtil AppLocker Bypass DLL",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1118",
              "name": "InstallUtil"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.004",
              "name": "Signed Binary Proxy Execution: InstallUtil"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "InstallUtil AppLocker Bypass Executable",
      "description": "Detects the misuse of InstallUtil.exe for injecting and executing unsigned binary code with the uninstall flag.",
      "text": "process.path ends with '\\\\installutil.exe' AND process.command_line contains '/u' AND process.command_line contains NOT '.dll' AND process.parent_path contains NOT 'msiexec.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1118",
            "name": "InstallUtil"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "InstallUtil AppLocker Bypass Executable",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1118",
              "name": "InstallUtil"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.004",
              "name": "Signed Binary Proxy Execution: InstallUtil"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Internal Monologue NTLM Hash Theft",
      "description": "Detects the modification of the RestrictSendingNTLMTraffic registry key to allow stealing NTLM hashes over the network without touching LSASS.",
      "text": "registry.value_name contains 'RestrictSendingNTLMTraffic'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1075",
            "name": "Pass the Hash"
          },
          {
            "id": "T1171",
            "name": "LLMNR/NBT-NS Poisoning and Relay"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Internal Monologue NTLM Hash Theft",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1075",
              "name": "Pass the Hash"
            },
            {
              "id": "T1171",
              "name": "LLMNR/NBT-NS Poisoning and Relay"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1550",
              "name": "Use Alternate Authentication Material"
            },
            {
              "id": "T1550.002",
              "name": "Use Alternate Authentication Material: Pass the Hash"
            },
            {
              "id": "T1557",
              "name": "Man-in-the-Middle"
            },
            {
              "id": "T1557.001",
              "name": "Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay"
            }
          ]
        }
      }
    },
    {
      "name": "Ip Enable Promiscuous Mode",
      "description": "Enables promiscuous mode with ip on a network interface. This can be used by attackers to monitor for passwords or other data of interest being transmitted over the wire.",
      "text": "process.command_line contains 'ip' AND process.command_line contains 'promisc'",
      "labels": [
        "Beta",
        "Credential Access",
        "Discovery",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1040",
            "name": "Network Sniffing"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Ip Enable Promiscuous Mode",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1040",
              "name": "Network Sniffing"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1040",
              "name": "Network Sniffing"
            }
          ]
        }
      }
    },
    {
      "name": "Java Reverse Shell Commands",
      "description": "Detects common commands used to create a reverse shell with java.",
      "text": "process.path ends with 'java' AND process.command_line contains 'sh' AND process.command_line contains '-c' AND process.command_line contains 'exec' AND process.command_line contains 'dev' AND process.command_line contains 'cat' AND process.command_line contains 'while' AND process.command_line contains 'read' AND process.command_line contains 'line' AND process.command_line contains 'String' AND process.command_line contains 'waitFor'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Java Reverse Shell Commands",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Jsc Javascript Binary Compilation",
      "description": "Detects the use of the .NET utility jsc.exe to compile a EXE binary from javascript. This is a known living off the land attacker technique. You might see alerts on this activity from legitimate developer workstations or build systems doing javascript to binary compilations.",
      "text": "process.path ends with '\\\\jsc.exe' AND process.command_line contains NOT 'library' AND group(file.operation is 'create' AND file.path ends with '.exe')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1027",
            "name": "Obfuscated Files or Information"
          },
          {
            "id": "T1500",
            "name": "Compile After Delivery"
          },
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Jsc Javascript Binary Compilation",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            },
            {
              "id": "T1500",
              "name": "Compile After Delivery"
            },
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            },
            {
              "id": "T1027.004",
              "name": "Obfuscated Files or Information: Compile After Delivery"
            },
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Jsc Javascript Library Compilation",
      "description": "Detects the use of the .NET utility jsc.exe to compile a DLL from javascript. This is a known living off the land attacker technique. You might see alerts on this activity from legitimate developer workstations or build systems doing javascript to binary compilations.",
      "text": "process.path ends with '\\\\jsc.exe' AND process.command_line contains 'library' AND group(file.operation is 'create' AND file.path ends with '.dll')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1027",
            "name": "Obfuscated Files or Information"
          },
          {
            "id": "T1500",
            "name": "Compile After Delivery"
          },
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Jsc Javascript Library Compilation",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            },
            {
              "id": "T1500",
              "name": "Compile After Delivery"
            },
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            },
            {
              "id": "T1027.004",
              "name": "Obfuscated Files or Information: Compile After Delivery"
            },
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Kekeo Command Arguments",
      "description": "Detects command line arguments commonly supplied to the Kekeo credential theft utility.",
      "text": "process.command_line contains 'tgt::' OR process.command_line contains 'tgs::' OR process.command_line contains 'exploit::' OR process.command_line contains 'misc::' OR process.command_line contains 'kerberos::' OR process.command_line contains 'smb::' OR process.command_line contains 'ntlm::' OR process.command_line contains 'tsssp::'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1212",
            "name": "Exploitation for Credential Access"
          },
          {
            "id": "T1075",
            "name": "Pass the Hash"
          },
          {
            "id": "T1097",
            "name": "Pass the Ticket"
          },
          {
            "id": "T1145",
            "name": "Private Keys"
          },
          {
            "id": "T1208",
            "name": "Kerberoasting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Kekeo Command Arguments",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1212",
              "name": "Exploitation for Credential Access"
            },
            {
              "id": "T1075",
              "name": "Pass the Hash"
            },
            {
              "id": "T1097",
              "name": "Pass the Ticket"
            },
            {
              "id": "T1145",
              "name": "Private Keys"
            },
            {
              "id": "T1208",
              "name": "Kerberoasting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1212",
              "name": "Exploitation for Credential Access"
            },
            {
              "id": "T1550",
              "name": "Use Alternate Authentication Material"
            },
            {
              "id": "T1550.002",
              "name": "Use Alternate Authentication Material: Pass the Hash"
            },
            {
              "id": "T1550.003",
              "name": "Use Alternate Authentication Material: Pass the Ticket"
            },
            {
              "id": "T1552",
              "name": "Unsecured Credentials"
            },
            {
              "id": "T1552.004",
              "name": "Unsecured Credentials: Private Keys"
            },
            {
              "id": "T1558",
              "name": "Steal or Forge Kerberos Tickets"
            },
            {
              "id": "T1558.003",
              "name": "Steal or Forge Kerberos Tickets: Kerberoasting"
            }
          ]
        }
      }
    },
    {
      "name": "Kerberoasting",
      "description": "Typically only lsass will deal with kerberos over the network and use port 88. If processes other than lsass are found to be using port 88 this could be related to suspicious kerberos activity such as kerberoasting.",
      "text": "network.port is 88 AND process.path ends with NOT '\\\\lsass.exe' AND process.path ends with NOT 'system' AND process.path ends with NOT '\\\\nmap.exe'",
      "labels": [
        "Beta",
        "Lateral Movement",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1208",
            "name": "Kerberoasting"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Kerberoasting",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1208",
              "name": "Kerberoasting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1558",
              "name": "Steal or Forge Kerberos Tickets"
            },
            {
              "id": "T1558.003",
              "name": "Steal or Forge Kerberos Tickets: Kerberoasting"
            }
          ]
        }
      }
    },
    {
      "name": "Kerberos File Manipulation",
      "description": "Detects the creation or command-line reference to the default kerberos ticket file extension, \".kirbi\", used by the Mimikatz credential harvesting utility.",
      "text": "process.command_line contains '.kirbi' OR group(file.operation is 'create' AND file.path ends with '.kirbi')",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1097",
            "name": "Pass the Ticket"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Kerberos File Manipulation",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1097",
              "name": "Pass the Ticket"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1550",
              "name": "Use Alternate Authentication Material"
            },
            {
              "id": "T1550.003",
              "name": "Use Alternate Authentication Material: Pass the Ticket"
            }
          ]
        }
      }
    },
    {
      "name": "LD_PRELOAD via Profile Modification with sed",
      "description": "LD_PRELOAD via Profile Modification with sed: Detects the modification of profile with stream editor to load arbitrary ELF shared libraries with LD_PRELOAD.",
      "text": "process.command_line contains 'sed' AND process.command_line contains 'export' AND process.command_line contains 'LD_PRELOAD' AND process.command_line contains '/etc/profile' AND file.path is '/etc/profile'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1055",
            "name": "Process Injection"
          }
        ]
      },
      "syntax_version": 3,
      "id": "LD_PRELOAD via Profile Modification with sed",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1055",
              "name": "Process Injection"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1574",
              "name": "Hijack Execution Flow"
            },
            {
              "id": "T1574.006",
              "name": "Hijack Execution Flow: Dynamic Linker Hijacking"
            },
            {
              "id": "T1055",
              "name": "Process Injection"
            }
          ]
        }
      }
    },
    {
      "name": "LSASS Creating or Spawning Executable Files",
      "description": "Detects when the Windows LSASS process creates or launches an executable file.",
      "text": "(process.path ends with '\\\\lsass.exe' AND group(file.operation is 'create' AND file.path ends with '.exe')) OR (process.parent_path ends with '\\\\lsass.exe' AND process.path ends with '.exe' AND process.path ends with NOT 'efsui.exe' AND process.path ends with NOT 'werfault.exe' AND process.path ends with NOT 'werfaultsecure.exe' AND process.path ends with NOT 'lsass.exe' AND process.path ends with NOT 'EpePcCredentialProviderHelper.exe')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          }
        ]
      },
      "syntax_version": 2,
      "id": "LSASS Creating or Spawning Executable Files",
      "modification-date": "2020-10-13T19:31:33.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            }
          ]
        }
      }
    },
    {
      "name": "LSASS Registry DirectoryServiceExtPt DLL Load",
      "description": "Detects the loading of a DLL by lsass.exe through an undocumented registry key DirectoryServiceExtPt.",
      "text": "registry.key_path contains '\\\\Services\\\\NTDS\\\\DirectoryServiceExtPt'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1058",
            "name": "Service Registry Permissions Weakness"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "LSASS Registry DirectoryServiceExtPt DLL Load",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1058",
              "name": "Service Registry Permissions Weakness"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1574",
              "name": "Hijack Execution Flow"
            },
            {
              "id": "T1574.011",
              "name": "Hijack Execution Flow: Services Registry Permissions Weakness"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "LSASS Registry LsaDbExtPt DLL Load",
      "description": "Detects the loading of a DLL by lsass.exe through an undocumented registry key LsaDbExtPt.",
      "text": "registry.key_path contains '\\\\Services\\\\NTDS\\\\LsaDbExtPt'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1058",
            "name": "Service Registry Permissions Weakness"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "LSASS Registry LsaDbExtPt DLL Load",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1058",
              "name": "Service Registry Permissions Weakness"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1574",
              "name": "Hijack Execution Flow"
            },
            {
              "id": "T1574.011",
              "name": "Hijack Execution Flow: Services Registry Permissions Weakness"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Logman Disable All PowerShell Logging",
      "description": "Detects disabling of all powershell logging with logman.",
      "text": "process.path ends with '\\\\logman.exe' AND process.command_line contains 'EventLog-Application' AND process.command_line contains 'Microsoft-Windows-PowerShell' AND process.command_line contains 'ets'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          },
          {
            "id": "T1054",
            "name": "Indicator Blocking"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Logman Disable All PowerShell Logging",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            },
            {
              "id": "T1054",
              "name": "Indicator Blocking"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            },
            {
              "id": "T1562.006",
              "name": "Impair Defenses: Indicator Blocking"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Logman Disable ETW Provider",
      "description": "Detects disabling of an ETW provider with logman.",
      "text": "process.path ends with '\\\\logman.exe' AND process.command_line contains 'update' AND process.command_line contains 'trace' AND process.command_line contains '--p' AND process.command_line contains 'ets'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          },
          {
            "id": "T1054",
            "name": "Indicator Blocking"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Logman Disable ETW Provider",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            },
            {
              "id": "T1054",
              "name": "Indicator Blocking"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            },
            {
              "id": "T1562.006",
              "name": "Impair Defenses: Indicator Blocking"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Lsass Connection to Port 443",
      "description": "Detects the connection to port 443 by a descendent process of lsass, which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\lsass.exe' AND network.port is '443'",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1071",
            "name": "Standard Application Layer Protocol"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Lsass Connection to Port 443",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1071",
              "name": "Standard Application Layer Protocol"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1071",
              "name": "Application Layer Protocol"
            },
            {
              "id": "T1071.001",
              "name": "Application Layer Protocol: Web Protocols"
            }
          ]
        }
      }
    },
    {
      "name": "Lsass Connection to Port 80",
      "description": "Detects the connection to port 80 by a descendent process of lsass, which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\lsass.exe' AND network.port is '80'",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1071",
            "name": "Standard Application Layer Protocol"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Lsass Connection to Port 80",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1071",
              "name": "Standard Application Layer Protocol"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1071",
              "name": "Application Layer Protocol"
            },
            {
              "id": "T1071.001",
              "name": "Application Layer Protocol: Web Protocols"
            }
          ]
        }
      }
    },
    {
      "name": "Lsass Running as not System",
      "description": "Detects when lsass.exe is running as something other than the system user, which could indicate attacker activity.",
      "text": "process.path ends with '\\\\lsass.exe' AND process.user_name is NOT 'SYSTEM'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Lsass Running as not System",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Lua Commands Bind Shell",
      "description": "Detects common commands used to create a bind shell with lua.",
      "text": "process.path ends with 'lua' AND process.command_line contains '-e' AND process.command_line contains 'require' AND process.command_line contains 'socket' AND process.command_line contains 'local' AND process.command_line contains 'assert' AND process.command_line contains 'k.bind' AND process.command_line contains 'os.getenv' AND process.command_line contains 'accept' AND process.command_line contains 'receive' AND process.command_line contains 'io.popen' AND process.command_line contains 'read' AND process.command_line contains 'send' AND process.command_line contains 'close'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Lua Commands Bind Shell",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Lua Commands Reverse Shell",
      "description": "Detects common commands used to create a reverse shell with lua.",
      "text": "process.path ends with 'lua' AND process.command_line contains '-e' AND process.command_line contains 'require' AND process.command_line contains 'socket' AND process.command_line contains 'assert' AND process.command_line contains 's.tcp' AND process.command_line contains 'connect' AND process.command_line contains 'os.getenv' AND process.command_line contains 'receive' AND process.command_line contains 'io.popen' AND process.command_line contains 'read' AND process.command_line contains 'send'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Lua Commands Reverse Shell",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "MMC Execute COM Payload",
      "description": "Detects the use of mmc.exe to execute a COM payload which can be used by an attacker for execution. This is a known living off the land technique.",
      "text": "process.path ends with '\\\\mmc.exe' AND process.command_line contains 'Embedding' ",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "MMC Execute COM Payload",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            }
          ]
        }
      }
    },
    {
      "name": "MMC Spawned CMD",
      "description": "This signal detects when a cmd.exe process is spawned as a descendant of the MMC.exe process. This can be a sign of injection into MMC since it will not normally spawn cmd.",
      "text": "process.path ends with '\\\\cmd.exe' AND process.ancestry_path ends with '\\\\mmc.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 4,
      "id": "MMC Spawned Cmd",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "MMC Spawned PowerShell",
      "description": "This signal detects when a powershell.exe process is spawned as a descendant of the MMC.exe process. This can be a sign of injection into MMC since it will not normally spawn powershell.",
      "text": "process.path ends with '\\\\powershell.exe' AND process.ancestry_path ends with '\\\\mmc.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 4,
      "id": "MMC Spawned PowerShell",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "MMC Spawned PWSH",
      "description": "This signal detects when a pwsh.exe process is spawned as a descendant of the MMC.exe process. This can be a sign of injection into MMC since it will not normally spawn pwsh.",
      "text": "process.path ends with '\\\\pwsh.exe' AND process.ancestry_path ends with '\\\\mmc.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 4,
      "id": "MMC Spawned Pwsh",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "MSBuild Remote Execution",
      "description": "Running msbuild with a remote hosted file can be used by attackers to download and execute malicious code while bypassing security controls on systems.",
      "text": "process.path contains 'msbuild' AND process.command_line contains 'ScriptFile' AND process.command_line contains 'http'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1105",
            "name": "Remote File Copy"
          }
        ]
      },
      "syntax_version": 1,
      "id": "MSBuild Remote Execution",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1105",
              "name": "Remote File Copy"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities Proxy Execution"
            },
            {
              "id": "T1127.001",
              "name": "Trusted Developer Utilities Proxy Execution: MSBuild"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            }
          ]
        }
      }
    },
    {
      "name": "MSBuild loading Mimikatz",
      "description": "Detects potential artifacts related to dynamically downloading and building the Mimikatz credential theft utility with msbuild. Legitimate developer system might compile projects with msbuild that use the same DLLs.",
      "text": "image.path ends with '\\\\vaultcli.dll' AND image.path ends with '\\\\samlib.dll' AND process.path ends with '\\\\msbuild.exe'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          }
        ]
      },
      "syntax_version": 3,
      "id": "MSBuild loading Mimikatz",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            },
            {
              "id": "T1003.001",
              "name": "OS Credential Dumping: LSASS Memory"
            },
            {
              "id": "T1003.002",
              "name": "OS Credential Dumping: Security Account Manager"
            },
            {
              "id": "T1003.004",
              "name": "OS Credential Dumping: LSA Secrets"
            },
            {
              "id": "T1003.005",
              "name": "OS Credential Dumping: Cached Domain Credentials"
            }
          ]
        }
      }
    },
    {
      "name": "MSConfig Command Execution",
      "description": "Detects the creation of a mscfgtlc.xml file in the system32 directory which can be used by an attacker to execute a malicious payload. This is a known attacker living off the land technique.",
      "text": "process.path contains NOT '\\\\windows\\\\' AND group(file.path ends with '\\\\mscfgtlc.xml' AND file.operation is 'create')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1202",
            "name": "Indirect Command Execution"
          }
        ]
      },
      "syntax_version": 2,
      "id": "MSConfig Command Execution",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            }
          ]
        }
      }
    },
    {
      "name": "MSIExec Remote Execution",
      "description": "Running msiexec with a remote hosted file can be used by attackers to download and execute malicious code while bypassing security controls on systems.",
      "text": "process.path ends with '\\\\msiexec.exe' AND (process.command_line contains '/quiet' OR process.command_line contains '/q') AND process.command_line contains '/i' AND (process.command_line contains 'http:' OR process.command_line contains 'https:' OR process.command_line contains 'ftp:')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1105",
            "name": "Remote File Copy"
          }
        ]
      },
      "syntax_version": 1,
      "id": "MSIExec Remote Execution",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1105",
              "name": "Remote File Copy"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.007",
              "name": "Signed Binary Proxy Execution: Msiexec"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            }
          ]
        }
      }
    },
    {
      "name": "Makecab File Download",
      "description": "Detects the potential use of makecab.exe to download data, which is a known living off the land attacker technique.",
      "text": "process.path ends with '\\\\makecab.exe' AND process.command_line contains '\\\\\\\\'",
      "labels": [
        "Beta",
        "Command and Control",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1105",
            "name": "Remote File Copy"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Makecab File Download",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1105",
              "name": "Remote File Copy"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            }
          ]
        }
      }
    },
    {
      "name": "Manual Windows Update Removal",
      "description": "Detects the use of WUSA to uninstall a KB. Attackers may attempt this to make available patched exploits or weakness on a system.",
      "text": "process.path ends with '\\\\wusa.exe' AND process.command_line contains 'uninstall' AND process.user_name contains NOT 'SYSTEM'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Manual Windows Update Removal",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            }
          ]
        }
      }
    },
    {
      "name": "Masquerading as Tanium Client",
      "description": "This signal detects when a process is running named TaniumClient.exe and is not executing out of the expected Tanium Client directory. Note if you install the Tanium client in a nonstandard directory this signal may need to be edited.",
      "text": "process.path ends with '\\\\TaniumClient.exe' AND (process.path contains NOT '\\\\Program Files' OR process.path contains NOT '\\\\Tanium\\\\Tanium Client\\\\')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Masquerading as Tanium Client",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Masquerading as Tanium Client (Linux and MacOS)",
      "description": "This signal detects when a process is running that is named TaniumClient and is not executing out of the expected Tanium Client directory. Note: If you install the Tanium client in a non-standard directory this signal may need to be edited.",
      "text": "process.path ends with '/TaniumClient' AND process.path contains NOT '/Tanium/TaniumClient'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Masquerading as Tanium Client (Linux and MacOS)",
      "modification-date": "2021-05-24T15:20:29.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Masquerading as Tanium Client Extension",
      "description": "This signal detects when a process is running named TaniumCX.exe and is not executing out of the expected Tanium Client directory. Note if you install the Tanium client in a nonstandard directory this signal may need to be edited.",
      "text": "process.path ends with '\\\\TaniumCX.exe' AND (process.path contains NOT '\\\\Program Files' OR process.path contains NOT '\\\\Tanium\\\\Tanium Client\\\\')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Masquerading as Tanium Client Extension",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Masquerading as Tanium Client Extension (Linux and MacOS)",
      "description": "This signal detects when a process is running that is named TaniumCX and is not executing out of the expected Tanium Client directory. Note: If you install the Tanium client in a non-standard directory this signal may need to be edited.",
      "text": "process.path ends with '/TaniumCX' AND process.path contains NOT '/Tanium/TaniumClient'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Masquerading as Tanium Client Extension (Linux and MacOS)",
      "modification-date": "2021-05-24T15:20:29.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Masquerading as Tanium Detect Engine",
      "description": "This signal detects when a process is running named TaniumDetectEngine.exe and is not executing out of the expected Tanium Client directory. Note if you install the Tanium client in a nonstandard directory this signal may need to be edited.",
      "text": "process.path ends with '\\\\TaniumDetectEngine.exe' AND (process.path contains NOT '\\\\Program Files' OR process.path contains NOT '\\\\Tanium\\\\Tanium Client\\\\')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Masquerading as Tanium Detect Engine",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Masquerading as Tanium Detect Engine (Linux and MacOS)",
      "description": "This signal detects when a process is running that is named TaniumDetectEngine and is not executing out of the expected Tanium Client directory. Note: If you install the Tanium client in a non-standard directory this signal may need to be edited.",
      "text": "process.path ends with '/TaniumDetectEngine' AND process.path contains NOT '/Tanium/TaniumClient'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Masquerading as Tanium Detect Engine (Linux and MacOS)",
      "modification-date": "2021-05-24T15:20:29.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Masquerading as Tanium Endpoint Index",
      "description": "This signal detects when a process is running named TaniumEndpointIndex.exe and is not executing out of the expected Tanium Client directory. Note if you install the Tanium client in a nonstandard directory this signal may need to be edited.",
      "text": "process.path ends with '\\\\TaniumEndpointIndex.exe' AND (process.path contains NOT '\\\\Program Files' OR process.path contains NOT '\\\\Tanium\\\\Tanium Client\\\\')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Masquerading as Tanium Endpoint Index",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Masquerading as Tanium Endpoint Index (Linux and MacOS)",
      "description": "This signal detects when a process is running named TaniumEndpointIndex.exe and is not executing out of the expected Tanium Client directory. Note: If you install the Tanium client in a non-standard directory this signal may need to be edited.",
      "text": "process.path ends with '/TaniumEndpointIndex' AND process.path contains NOT '/Tanium/TaniumClient'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Masquerading as Tanium Endpoint Index (Linux and MacOS)",
      "modification-date": "2021-05-24T15:20:29.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Masquerading as Tanium Python",
      "description": "This signal detects when a process is running named TPython.exe and is not executing out of the expected Tanium Client directory. Note if you install the Tanium client in a nonstandard directory this signal may need to be edited.",
      "text": "process.path ends with '\\\\TPython.exe' AND (process.path contains NOT '\\\\Program Files' OR process.path contains NOT '\\\\Tanium\\\\Tanium Client\\\\')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Masquerading as Tanium Python",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Masquerading as Tanium Python (Linux and MacOS)",
      "description": "This signal detects when a process is running that is named TPython and is not executing out of the expected Tanium Client directory. Note: If you install the Tanium client in a non-standard directory this signal may need to be edited.",
      "text": "process.path ends with '/TPython' AND process.path contains NOT '/Tanium/TaniumClient'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Masquerading as Tanium Python (Linux and MacOS)",
      "modification-date": "2021-05-24T15:20:29.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Mavinject DLL Injection",
      "description": "Detects use of mavinject.exe to inject DLLs into a process.",
      "text": "process.path contains '\\\\mavinject.exe' AND process.command_line contains 'INJECTRUNNING'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities"
          },
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Mavinject DLL Injection",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities"
            },
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities Proxy Execution"
            },
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1055.001",
              "name": "Process Injection: Dynamic-link Library Injection"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Meterpreter Privilege Escalation",
      "description": "Detects use of Metasploit Meterpreter's 'getsystem' script, which can give an attacker SYSTEM privileges on an infected Windows host.",
      "text": "(process.path ends with '\\\\cmd.exe' AND process.command_line contains '/c' AND process.command_line contains 'echo' AND process.command_line contains '>' AND process.command_line contains '\\\\\\\\.\\\\pipe\\\\') OR (process.parent_path ends with '\\\\rundll32.exe' AND process.parent_command_line contains 'Local\\\\Temp' AND process.parent_command_line contains '.dll' AND process.path ends with '\\\\rundll32.exe' AND process.command_line contains 'Local\\\\Temp' AND process.command_line contains '.dll')",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1085",
            "name": "Rundll32"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Meterpreter Privilege Escalation",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1085",
              "name": "Rundll32"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.011",
              "name": "Signed Binary Proxy Execution: Rundll32"
            }
          ]
        }
      }
    },
    {
      "name": "Microsoft Edge Modifying Files in Windows Directory",
      "description": "Detects Microsoft Edge or a descendent process modifying files in the windows directory, which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\msedge.exe' AND group(file.path contains ':\\\\windows' AND file.path contains NOT 'tzres.dll')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Microsoft Edge Modifying Files in Windows Directory",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.001",
              "name": "User Execution: Malicious Link"
            }
          ]
        }
      }
    },
    {
      "name": "Microsoft Workflow Compiler Misuse",
      "description": "Detects the misuse of Microsoft Workflow Compiler for injecting and executing unsigned code.",
      "text": "(process.path ends with '\\\\Microsoft.Workflow.Compiler.exe' AND image.path contains 'System.Workflow.ComponentModel' AND (process.parent_path ends with '\\\\cmd.exe' OR process.parent_path ends with '\\\\powershell.exe' OR process.parent_path ends with '\\\\pwsh.exe')) OR (image.path contains 'System.Workflow.ComponentModel' AND process.path ends with NOT '\\\\Microsoft.Workflow.Compiler.exe' AND process.path ends with NOT '\\\\mscorsvw.exe' AND process.path ends with NOT '\\\\w3wp.exe' AND process.path ends with NOT '\\\\Microsoft.VisualStudio.Web.Host.exe')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1027",
            "name": "Obfuscated Files or Information"
          },
          {
            "id": "T1500",
            "name": "Compile After Delivery"
          },
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Microsoft Workflow Compiler Misuse",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            },
            {
              "id": "T1500",
              "name": "Compile After Delivery"
            },
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            },
            {
              "id": "T1027.004",
              "name": "Obfuscated Files or Information: Compile After Delivery"
            },
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Mimikatz Command Arguments",
      "description": "Detects command line arguments commonly supplied to the Mimikatz credential theft utility when executed in non-interactive mode.",
      "text": "process.command_line contains 'sekurlsa::' OR process.command_line contains 'kerberos::' OR process.command_line contains 'privilege::debug' OR process.command_line contains 'lsadump::' OR process.command_line contains 'misc::' OR process.command_line contains 'ts::multirdp' OR process.command_line contains 'crypto::' OR process.command_line contains 'dpapi::' OR process.command_line contains 'token::' OR process.command_line contains 'event::' OR process.command_line contains 'vault::' OR process.command_line contains 'inject::' OR process.command_line contains 'process::' OR (process.command_line contains 'service::' AND process.path ends with NOT '\\\\WpcTok.exe')",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1098",
            "name": "Account Manipulation"
          },
          {
            "id": "T1134",
            "name": "Access Token Manipulation"
          },
          {
            "id": "T1178",
            "name": "SID-History Injection"
          },
          {
            "id": "T1207",
            "name": "DCShadow"
          },
          {
            "id": "T1212",
            "name": "Exploitation for Credential Access"
          },
          {
            "id": "T1101",
            "name": "Security Support Provider"
          },
          {
            "id": "T1075",
            "name": "Pass the Hash"
          },
          {
            "id": "T1097",
            "name": "Pass the Ticket"
          },
          {
            "id": "T1081",
            "name": "Credentials in Files"
          },
          {
            "id": "T1145",
            "name": "Private Keys"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Mimikatz Command Arguments",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1098",
              "name": "Account Manipulation"
            },
            {
              "id": "T1134",
              "name": "Access Token Manipulation"
            },
            {
              "id": "T1178",
              "name": "SID-History Injection"
            },
            {
              "id": "T1207",
              "name": "DCShadow"
            },
            {
              "id": "T1212",
              "name": "Exploitation for Credential Access"
            },
            {
              "id": "T1101",
              "name": "Security Support Provider"
            },
            {
              "id": "T1075",
              "name": "Pass the Hash"
            },
            {
              "id": "T1097",
              "name": "Pass the Ticket"
            },
            {
              "id": "T1081",
              "name": "Credentials in Files"
            },
            {
              "id": "T1145",
              "name": "Private Keys"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            },
            {
              "id": "T1003.001",
              "name": "OS Credential Dumping: LSASS Memory"
            },
            {
              "id": "T1003.002",
              "name": "OS Credential Dumping: Security Account Manager"
            },
            {
              "id": "T1003.004",
              "name": "OS Credential Dumping: LSA Secrets"
            },
            {
              "id": "T1003.005",
              "name": "OS Credential Dumping: Cached Domain Credentials"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1098",
              "name": "Account Manipulation"
            },
            {
              "id": "T1134",
              "name": "Access Token Manipulation"
            },
            {
              "id": "T1134.005",
              "name": "Access Token Manipulation: SID-History Injection"
            },
            {
              "id": "T1207",
              "name": "Rogue Domain Controller"
            },
            {
              "id": "T1212",
              "name": "Exploitation for Credential Access"
            },
            {
              "id": "T1547",
              "name": "Boot or Logon Autostart Execution"
            },
            {
              "id": "T1547.005",
              "name": "Boot or Logon Autostart Execution: Security Support Provider"
            },
            {
              "id": "T1550",
              "name": "Use Alternate Authentication Material"
            },
            {
              "id": "T1550.002",
              "name": "Use Alternate Authentication Material: Pass the Hash"
            },
            {
              "id": "T1550.003",
              "name": "Use Alternate Authentication Material: Pass the Ticket"
            },
            {
              "id": "T1552",
              "name": "Unsecured Credentials"
            },
            {
              "id": "T1552.001",
              "name": "Unsecured Credentials: Credentials In Files"
            },
            {
              "id": "T1552.004",
              "name": "Unsecured Credentials: Private Keys"
            }
          ]
        }
      }
    },
    {
      "name": "Minifilter Driver Enumeration",
      "description": "Adversaries can use fltmc.exe to enumerate loaded drivers and see their assigned altitude numbers for determining which security tools are running.",
      "text": "process.path ends with 'fltmc.exe' OR process.command_line contains 'misc::mflt'",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1518",
            "name": "Software Discovery"
          },
          {
            "id": "T1063",
            "name": "Security Software Discovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Minifilter Driver Enumeration",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1518",
              "name": "Software Discovery"
            },
            {
              "id": "T1063",
              "name": "Security Software Discovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1518",
              "name": "Software Discovery"
            },
            {
              "id": "T1518.001",
              "name": "Software Discovery: Security Software Discovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Msdt Execution Bypass with Answer File",
      "description": "This signal detects the use of the Microsoft Diagnostics Tools msdt.exe to execute malicious code via an answer file.",
      "text": "process.path ends with '\\\\msdt.exe' AND process.command_line contains 'diagnostics' AND process.command_line contains '.xml' AND process.command_line contains '-af' AND process.command_line contains '/skip' AND process.command_line contains 'TRUE'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Msdt Execution Bypass with Answer File",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        }
      }
    },
    {
      "name": "NET CLR Artifact Cscript",
      "description": "Detects potential artifacts of CSharp injection that can be utilized by attackers with tools such as sharpshooter.",
      "text": "group(file.operation is 'create' AND file.path ends with '\\\\UsageLogs\\\\cscript.exe.log')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1129",
            "name": "Execution through Module Load"
          }
        ]
      },
      "syntax_version": 2,
      "id": "NET CLR Artifact Cscript",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1129",
              "name": "Execution through Module Load"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1055.001",
              "name": "Process Injection: Dynamic-link Library Injection"
            },
            {
              "id": "T1129",
              "name": "Shared Modules"
            }
          ]
        }
      }
    },
    {
      "name": "NET CLR Artifact Mshta",
      "description": "Detects potential artifacts of CSharp injection that can be utilized by attackers with tools such as sharpshooter.",
      "text": "group(file.operation is 'create' AND file.path ends with '\\\\UsageLogs\\\\mshta.exe.log')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1129",
            "name": "Execution through Module Load"
          }
        ]
      },
      "syntax_version": 2,
      "id": "NET CLR Artifact Mshta",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1129",
              "name": "Execution through Module Load"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1055.001",
              "name": "Process Injection: Dynamic-link Library Injection"
            },
            {
              "id": "T1129",
              "name": "Shared Modules"
            }
          ]
        }
      }
    },
    {
      "name": "NET CLR Artifact Regsvr32",
      "description": "Detects potential artifacts of CSharp injection that can be utilized by attackers with tools such as sharpshooter.",
      "text": "group(file.operation is 'create' AND file.path ends with '\\\\UsageLogs\\\\regsvr32.exe.log')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1129",
            "name": "Execution through Module Load"
          }
        ]
      },
      "syntax_version": 2,
      "id": "NET CLR Artifact Regsvr32",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1129",
              "name": "Execution through Module Load"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1055.001",
              "name": "Process Injection: Dynamic-link Library Injection"
            },
            {
              "id": "T1129",
              "name": "Shared Modules"
            }
          ]
        }
      }
    },
    {
      "name": "NET CLR Artifact Svchost",
      "description": "Detects potential artifacts of CSharp injection that can be utilized by attackers with tools such as sharpshooter.",
      "text": "group(file.operation is 'create' AND file.path ends with '\\\\UsageLogs\\\\svchost.exe.log')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1129",
            "name": "Execution through Module Load"
          }
        ]
      },
      "syntax_version": 2,
      "id": "NET CLR Artifact Svchost",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1129",
              "name": "Execution through Module Load"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1055.001",
              "name": "Process Injection: Dynamic-link Library Injection"
            },
            {
              "id": "T1129",
              "name": "Shared Modules"
            }
          ]
        }
      }
    },
    {
      "name": "NET CLR Artifact WMIC",
      "description": "Detects potential artifacts of CSharp injection that can be utilized by attackers with tools such as sharpshooter.",
      "text": "group(file.operation is 'create' AND file.path ends with '\\\\UsageLogs\\\\wmic.exe.log')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1129",
            "name": "Execution through Module Load"
          }
        ]
      },
      "syntax_version": 2,
      "id": "NET CLR Artifact WMIC",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1129",
              "name": "Execution through Module Load"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1055.001",
              "name": "Process Injection: Dynamic-link Library Injection"
            },
            {
              "id": "T1129",
              "name": "Shared Modules"
            }
          ]
        }
      }
    },
    {
      "name": "NET CLR Artifact Wscript",
      "description": "Detects potential artifacts of CSharp injection that can be utilized by attackers with tools such as sharpshooter.",
      "text": "group(file.operation is 'create' AND file.path ends with '\\\\UsageLogs\\\\wscript.exe.log')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1129",
            "name": "Execution through Module Load"
          }
        ]
      },
      "syntax_version": 2,
      "id": "NET CLR Artifact Wscript",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1129",
              "name": "Execution through Module Load"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1055.001",
              "name": "Process Injection: Dynamic-link Library Injection"
            },
            {
              "id": "T1129",
              "name": "Shared Modules"
            }
          ]
        }
      }
    },
    {
      "name": "Netsh Helper DLL",
      "description": "Detects the creation of a Netsh helper binary that attackers can use for persistence and execution of malicious code.",
      "text": "process.path ends with '\\\\netsh.exe' AND process.command_line contains 'add' AND process.command_line contains 'helper'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1128",
            "name": "Netsh Helper DLL"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Netsh Helper DLL",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1128",
              "name": "Netsh Helper DLL"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.007",
              "name": "Event Triggered Execution: Netsh Helper DLL"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Netsh Network Traffic Capture",
      "description": "Enables netsh to be used to capture a network trace on a host. This can be used by attackers to monitor for passwords or other data of interest being transmitted over the wire.",
      "text": "process.path ends with '\\\\netsh.exe' AND process.command_line contains 'start' AND process.command_line contains 'trace'",
      "labels": [
        "Beta",
        "Credential Access",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1040",
            "name": "Network Sniffing"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Netsh Network Traffic Capture",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1040",
              "name": "Network Sniffing"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1040",
              "name": "Network Sniffing"
            }
          ]
        }
      }
    },
    {
      "name": "Netsh Port Forwarding",
      "description": "Detects the use of netsh.exe used for port forwarding. This can allow attackers to tunnel interactions on jump boxes.",
      "text": "process.path ends with '\\\\netsh.exe' AND process.command_line contains 'l=' AND process.command_line contains 'listna' AND process.command_line contains 'connectp' AND process.command_line contains 'c='",
      "labels": [
        "Beta",
        "Lateral Movement",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1021",
            "name": "Remote Services"
          },
          {
            "id": "T1090",
            "name": "Connection Proxy"
          },
          {
            "id": "T1188",
            "name": "Multi-hop Proxy"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Netsh Port Forwarding",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1021",
              "name": "Remote Services"
            },
            {
              "id": "T1090",
              "name": "Connection Proxy"
            },
            {
              "id": "T1188",
              "name": "Multi-hop Proxy"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1021",
              "name": "Remote Services"
            },
            {
              "id": "T1090",
              "name": "Proxy"
            },
            {
              "id": "T1090.001",
              "name": "Proxy: Internal Proxy"
            },
            {
              "id": "T1090.003",
              "name": "Proxy: Multi-hop Proxy"
            }
          ]
        }
      }
    },
    {
      "name": "Netsh WLAN Discovery",
      "description": "Detects the use of netsh.exe to create a wireless network report. An attacker can use this technique to discover what networks are available.",
      "text": "process.parent_path ends with NOT '\\\\m_agent_service.exe' AND process.command_line contains 'show' AND process.path ends with '\\\\netsh.exe' AND process.command_line contains 'wlan'",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1018",
            "name": "Remote System Discovery"
          },
          {
            "id": "T1016",
            "name": "System Network Configuration Discovery"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Netsh WLAN Discovery",
      "modification-date": "2021-05-12T19:00:38.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1018",
              "name": "Remote System Discovery"
            },
            {
              "id": "T1016",
              "name": "System Network Configuration Discovery"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1018",
              "name": "Remote System Discovery"
            },
            {
              "id": "T1016",
              "name": "System Network Configuration Discovery"
            }
          ]
        }
      }
    },
    {
      "name": "Netsh Wifi Credentials Harvesting",
      "description": "Detect potential harvesting of wifi credentials using netsh.exe.",
      "text": "process.path ends with '\\\\netsh.exe' AND process.command_line contains 'wlan' AND process.command_line contains '=clear'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": []
      },
      "syntax_version": 1,
      "id": "Netsh Wifi Credentials Harvesting",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": []
        },
        "v7": {
          "techniques": [
            {
              "id": "T1555",
              "name": "Credentials from Password Stores"
            }
          ]
        }
      }
    },
    {
      "name": "Nltest Discovery",
      "description": "Nltest can be used by an attacker to discover details of an environments domains, trusts, systems, and configurations.",
      "text": "process.path ends with '\\\\nltest.exe' AND (process.command_line contains 'domain_trusts' OR process.command_line contains 'dclist' OR process.command_line contains 'dsgetdc' OR process.command_line contains 'parentdomain')",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1482",
            "name": "Domain Trust Discovery"
          },
          {
            "id": "T1018",
            "name": "Remote System Discovery"
          },
          {
            "id": "T1016",
            "name": "System Network Configuration Discovery"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Nltest Discovery",
      "modification-date": "2020-10-13T19:31:33.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1482",
              "name": "Domain Trust Discovery"
            },
            {
              "id": "T1018",
              "name": "Remote System Discovery"
            },
            {
              "id": "T1016",
              "name": "System Network Configuration Discovery"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1482",
              "name": "Domain Trust Discovery"
            },
            {
              "id": "T1018",
              "name": "Remote System Discovery"
            },
            {
              "id": "T1016",
              "name": "System Network Configuration Discovery"
            }
          ]
        }
      }
    },
    {
      "name": "Nltest Execution",
      "description": "Nltest can be used by an attacker as a means to retrieve the NetNTLM Hash.",
      "text": "process.path ends with 'nltest.exe' AND process.command_line contains '/server:' AND process.command_line contains '/query'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Nltest Execution",
      "modification-date": "2020-10-13T19:31:33.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            }
          ]
        }
      }
    },
    {
      "name": "Node Capabilities Privilege Escalation",
      "description": "Detects node commands to escalate privileges by making arbitrary manipulations of process UIDs.",
      "text": "process.command_line contains 'node' AND process.command_line contains 'process.setuid' AND process.command_line contains 'require' AND process.command_line contains 'child_process' AND process.command_line contains 'spawn' AND process.command_line contains 'sh' AND process.command_line contains 'stdio'",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Node Capabilities Privilege Escalation",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1166",
              "name": "Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1548.001",
              "name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Node Commands Bind Shell",
      "description": "Detects common commands used to create a bind shell with node.",
      "text": "process.command_line contains 'node' AND process.command_line contains '-e' AND process.command_line contains '=' AND process.command_line contains 'child_process' AND process.command_line contains 'spawn' AND process.command_line contains 'createServer' AND process.command_line contains 'client.pipe' AND process.command_line contains 'sh.stdin' AND process.command_line contains 'sh.stderr' AND process.command_line contains 'listen' AND process.command_line contains 'process.env'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Node Commands Bind Shell",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Node Commands Reverse Shell",
      "description": "Detects common commands used to create a reverse shell with node.",
      "text": "process.command_line contains 'node' AND process.command_line contains '-e' AND process.command_line contains '=' AND process.command_line contains 'child_process' AND process.command_line contains 'spawn' AND process.command_line contains 'net.connect' AND process.command_line contains 'process.env' AND process.command_line contains 'function' AND process.command_line contains 'this.pipe' AND process.command_line contains 'sh.stdout' AND process.command_line contains 'sh.stderr'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Node Commands Reverse Shell",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Non Break Space Character",
      "description": "Detects the use of a non break space characters in a filename or command line. This can be used to make files appear to be named or in the same directory as legitimate files.",
      "text": "process.path contains '\\xc2\\xa0' OR process.command_line contains '\\xc2\\xa0' OR file.path contains '\\xc2\\xa0'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Non Break Space Character",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Non Smss Spawned SQL Client Tools PowerShell Session",
      "description": "Detects the potential misuse of a SQL client tools PowerShell session where smss is not the parent. This is a known attacker living off the land technique.",
      "text": "process.path ends with 'ps.exe' AND process.path contains '\\\\sql' AND process.parent_path ends with NOT '\\\\smss.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Non Smss Spawned SQL Client Tools PowerShell Session",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Odbconf DLL Execution via DLLRegisterServer",
      "description": "This detects the use of the odbcconf.exe to self register a dll via DLLRegisterServer for execution.",
      "text": "process.path ends with '\\\\Odbcconf.exe' AND process.command_line contains '/a' AND process.command_line contains 'REGSVR'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Odbconf DLL Execution via DLLRegisterServer",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Odbconf DLL Execution via RSP File",
      "description": "This signal detects the use of the odbcconf.exe to self register a DLL via a RSP file for execution.",
      "text": "process.path ends with '\\\\Odbcconf.exe' AND process.command_line contains '-f' AND process.command_line contains 'rsp'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Odbconf DLL Execution via RSP File",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Office Applications Executing AppData Binaries",
      "description": "Detects the execution of binaries by office applications in a users AppData directory which is a common staging directory.",
      "text": "(process.parent_path contains 'winword.exe' OR process.parent_path contains 'excel.exe' OR process.parent_path contains 'outlook.exe' OR process.parent_path contains 'powerpnt.exe' OR process.parent_path contains 'onenote.exe' OR process.parent_path contains 'mspub.exe' OR process.parent_path contains 'msaccess.exe' OR process.parent_path contains 'lync.exe') AND (process.path contains '\\\\AppData') AND process.path ends with NOT '\\\\filecoauth.exe' AND process.path ends with NOT '\\\\firefox.exe' AND process.path ends with NOT '\\\\chrome.exe' AND process.path ends with NOT '\\\\OneDrive.exe'",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1137",
            "name": "Office Application Startup"
          },
          {
            "id": "T1173",
            "name": "Dynamic Data Exchange"
          },
          {
            "id": "T1193",
            "name": "Spearphishing Attachment"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Office Applications Executing AppData Binaries",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1137",
              "name": "Office Application Startup"
            },
            {
              "id": "T1173",
              "name": "Dynamic Data Exchange"
            },
            {
              "id": "T1193",
              "name": "Spearphishing Attachment"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1137",
              "name": "Office Application Startup"
            },
            {
              "id": "T1559",
              "name": "Inter-Process Communication"
            },
            {
              "id": "T1559.002",
              "name": "Inter-Process Communication: Dynamic Data Exchange"
            },
            {
              "id": "T1566",
              "name": "Phishing"
            },
            {
              "id": "T1566.001",
              "name": "Phishing: Spearphishing Attachment"
            }
          ]
        }
      }
    },
    {
      "name": "OpenSSL Commands Reverse Shell",
      "description": "Detects common commands used to create a reverse shell with OpenSSL.",
      "text": "process.path ends with 'openssl' AND process.command_line contains 's_client' AND process.command_line contains 'quiet' AND process.command_line contains 'connect'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "OpenSSL Commands Reverse Shell",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "PHP Commands Download",
      "description": "Detects the use of PHP to download potentially suspect content.",
      "text": "process.path ends with 'php' AND process.command_line contains '-r' AND process.command_line contains 'file_get_contents' AND process.command_line contains 'getenv' AND process.command_line contains 'file_put_contents'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1105",
            "name": "Remote File Copy"
          }
        ]
      },
      "syntax_version": 3,
      "id": "PHP Commands Download",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1105",
              "name": "Remote File Copy"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            }
          ]
        }
      }
    },
    {
      "name": "PHP Commands Reverse Shell",
      "description": "Detects common commands used to create a reverse shell with php.",
      "text": "process.command_line contains 'php' AND process.command_line contains '-r' AND process.command_line contains 'fsockopen' AND process.command_line contains 'exec' AND process.command_line contains 'sh'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "PHP Commands Reverse Shell",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "PHP Shell Break Out",
      "description": "Detects PHP shell break out from a restricted shell by spawning an interactive shell.",
      "text": "process.path ends with 'php' AND process.command_line contains 'php -r' AND process.command_line contains 'popen' AND process.command_line contains 'getenv' AND process.command_line contains 'if' AND process.command_line contains 'while' AND process.command_line contains 'feof' AND process.command_line contains 'echo' AND process.command_line contains 'fread' AND process.command_line contains 'pclose'",
      "labels": [
        "Beta",
        "Execution",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "PHP Shell Break Out",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "PWSH Clear History",
      "description": "Detects the use of the clear-history in a pwsh.exe command line.",
      "text": "process.path ends with '\\\\pwsh.exe' AND process.command_line contains 'clear-history'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1070",
            "name": "Indicator Removal on Host"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 1,
      "id": "PWSH Clear History",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1070",
              "name": "Indicator Removal on Host"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1070",
              "name": "Indicator Removal on Host"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "PWSH Exclusion Added to Defender",
      "description": "Detects the use of PowerShell to add a Microsoft Defender exclusion that attackers can use to avoid detections of malicious activity.",
      "text": "process.path ends with '\\\\pwsh.exe' AND process.command_line contains 'Add-MpPreference' AND process.command_line contains '-ExclusionPath'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 1,
      "id": "PWSH Exclusion Added to Defender",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Password Values in Registry",
      "description": "Detects the modification of registry values named \"password\" that can contain vulnerable credentials.",
      "text": "registry.value_name is 'password'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1214",
            "name": "Credentials in Registry"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Password Values in Registry",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1214",
              "name": "Credentials in Registry"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1552",
              "name": "Unsecured Credentials"
            },
            {
              "id": "T1552.002",
              "name": "Unsecured Credentials: Credentials in Registry"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Perl CPAN Commands Reverse Shell",
      "description": "Detects common commands used to create a reverse shell with perl.",
      "text": "process.path ends with 'perl' AND process.command_line contains 'cpan' AND file.path contains 'tty' AND file.path contains '.cpan' AND process.parent_path ends with 'sh'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Perl CPAN Commands Reverse Shell",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Perl Commands Reverse Shell",
      "description": "Detects common commands used to create a reverse shell with perl.",
      "text": "process.command_line contains 'perl' AND process.command_line contains '-e' AND process.command_line contains 'Socket' AND process.command_line contains 'INET' AND process.command_line contains 'getprotobyname' AND process.command_line contains 'tcp'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Perl Commands Reverse Shell",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Perl Privilege Escalation",
      "description": "Detects common commands used to escalate privileges with perl.",
      "text": "process.command_line contains 'perl' AND process.command_line contains '-e' AND process.command_line contains 'use' AND process.command_line contains 'POSIX' AND process.command_line contains 'setuid' AND process.command_line contains 'exec' AND process.command_line contains 'sh'",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Perl Privilege Escalation",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1166",
              "name": "Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1548.001",
              "name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Persistence using Office Templates and Trusts",
      "description": "Detects various office template techniques used to execute a binary via persistence. These are commonly seen in association with persisting in VDI environments.",
      "text": "group(file.path contains '\\\\appdata\\\\' AND file.operation is 'create' AND (file.path ends with '.wll' OR file.path ends with '.xll' OR file.path ends with '.ppa' OR file.path ends with '.ppam')) OR (group((registry.key_path contains '\\\\Software\\\\Microsoft\\\\Office\\\\' OR registry.key_path contains '\\\\Software\\\\Microsoft\\\\VBA\\\\VBE\\\\') AND registry.key_path contains '\\\\Addins\\\\') AND group(file.operation is 'create' AND file.path ends with '.dll') AND process.path ends with NOT 'OfficeClickToRun.exe') OR (process.path contains 'regasm.exe' AND process.command_line contains '/codebase' AND process.command_line contains '.dll') OR (process.path contains 'VSTOInstaller.exe' AND process.command_line contains '/i' AND process.command_line contains '.vsto')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1221",
            "name": "Template Injection"
          },
          {
            "id": "T1137",
            "name": "Office Application Startup"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Persistence using Office Templates and Trusts",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1221",
              "name": "Template Injection"
            },
            {
              "id": "T1137",
              "name": "Office Application Startup"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1221",
              "name": "Template Injection"
            },
            {
              "id": "T1137",
              "name": "Office Application Startup"
            },
            {
              "id": "T1137.001",
              "name": "Office Application Startup: Office Template Macros"
            },
            {
              "id": "T1137.006",
              "name": "Office Application Startup: Add-ins"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Persistence via Certificate Store Provider",
      "description": "Detects usage of certificate store providers to execute a binary that can be used for persistence.",
      "text": "group(registry.key_path contains 'Cryptography\\\\OID\\\\EncodingType 0\\\\CertDllOpenStoreProv' OR registry.key_path contains 'Microsoft\\\\SystemCertificates\\\\CA\\\\PhysicalStores')",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Persistence via Certificate Store Provider",
      "modification-date": "2020-10-13T19:31:33.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Persistence via Office Application Startup",
      "description": "The Microsoft Office \"Office Test\" Registry Key may be leveraged by adversaries to load a DLL during launch of an Office Application.",
      "text": "registry.key_path contains 'Software\\\\Microsoft\\\\Office test\\\\Special\\\\Perf'",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1137",
            "name": "Office Application Startup"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Persistence via Office Application Startup",
      "modification-date": "2021-05-24T15:20:29.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1137",
              "name": "Office Application Startup"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1137",
              "name": "Office Application Startup"
            },
            {
              "id": "T1137.002",
              "name": "Office Application Startup: Office Test"
            }
          ]
        }
      }
    },
    {
      "name": "Pktmon Full Packet Capture",
      "description": "Enables Pktmon to be used to get a full packet capture on a host with the -p 0 setting when starting the capture. This can be used by attackers to monitor for passwords or other data of interest being transmitted over the wire.",
      "text": "process.path ends with '\\\\pktmon.exe' AND process.command_line contains 'start' AND process.command_line contains 'etw' AND process.command_line contains 'p' AND process.command_line contains '0'",
      "labels": [
        "Beta",
        "Credential Access",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1040",
            "name": "Network Sniffing"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Pktmon Full Packet Capture",
      "modification-date": "2020-10-13T19:31:33.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1040",
              "name": "Network Sniffing"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1040",
              "name": "Network Sniffing"
            }
          ]
        }
      }
    },
    {
      "name": "Possible Anti-Malware Scan Interface (AMSI) Bypass Attempt",
      "description": "Detects processes executed from user directories that attempt to drop an AMSI (Microsoft Anti-Malware Scan Interface) DLL. This technique is used by several PowerShell-based attack tools.",
      "text": "group(file.path ends with '\\\\amsi.dll' AND file.operation is 'create') AND process.path contains '\\\\Users\\\\'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          },
          {
            "id": "T1054",
            "name": "Indicator Blocking"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Possible Anti-Malware Scan Interface (AMSI) Bypass Attempt",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            },
            {
              "id": "T1054",
              "name": "Indicator Blocking"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            },
            {
              "id": "T1562.006",
              "name": "Impair Defenses: Indicator Blocking"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "PowerPoint Spawned Connection to Port 443",
      "description": "Detects the connection to port 443 by a descendent process of PowerPoint which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\powerpnt.exe' AND process.path ends with NOT '\\\\powerpnt.exe' AND network.port is '443'",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "PowerPoint Spawned Connection to Port 443",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "PowerPoint Spawned Connection to Port 80",
      "description": "Detects the connection to port 80 by a descendent process of PowerPoint which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\powerpnt.exe' AND process.path ends with NOT '\\\\powerpnt.exe' AND network.port is '80'",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "PowerPoint Spawned Connection to Port 80",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "PowerPoint Spawned Process Creating BAT Files",
      "description": "Detects the creation of BAT files by PowerPoint or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\powerpnt.exe' AND group(file.operation is 'create' AND file.path ends with '.bat')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "PowerPoint Spawned Process Creating BAT Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "PowerPoint Spawned Process Creating CMD Files",
      "description": "Detects the creation of CMD files by PowerPoint or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\powerpnt.exe' AND group(file.operation is 'create' AND file.path ends with '.cmd')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "PowerPoint Spawned Process Creating CMD Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "PowerPoint Spawned Process Creating DLL Files",
      "description": "Detects the creation of DLL files by PowerPoint or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\powerpnt.exe' AND group(file.operation is 'create' AND file.path ends with '.dll')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "PowerPoint Spawned Process Creating DLL Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "PowerPoint Spawned Process Creating EXE Files",
      "description": "Detects the creation of EXE files by PowerPoint or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\powerpnt.exe' AND group(file.operation is 'create' AND file.path ends with '.exe')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "PowerPoint Spawned Process Creating EXE Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "PowerPoint Spawned Process Creating PS1 Files",
      "description": "Detects the creation of PS1 files by PowerPoint or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\powerpnt.exe' AND group(file.operation is 'create' AND file.path ends with '.ps1')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "PowerPoint Spawned Process Creating PS1 Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "PowerPoint Spawned Process Creating SYS Files",
      "description": "Detects the creation of SYS files by PowerPoint or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\powerpnt.exe' AND group(file.operation is 'create' AND file.path ends with '.sys')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "PowerPoint Spawned Process Creating SYS Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "PowerPoint Spawned Process Creating VBS Files",
      "description": "Detects the creation of VBS files by PowerPoint or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\powerpnt.exe' AND group(file.operation is 'create' AND file.path ends with '.vbs')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "PowerPoint Spawned Process Creating VBS Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.005",
              "name": "Command and Scripting Interpreter: Visual Basic"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "PowerShell Audio Capture",
      "description": "Detects the use of powershell to capture audio on a Windows system.",
      "text": "(process.path ends with 'powershell.exe' OR process.path ends with 'pwsh.exe') AND process.command_line contains 'WindowsAudioDevice-Powershell-Cmdlet'",
      "labels": [
        "Beta",
        "Collection",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1123",
            "name": "Audio Capture"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 1,
      "id": "PowerShell Audio Capture",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1123",
              "name": "Audio Capture"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1123",
              "name": "Audio Capture"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "PowerShell Clear History",
      "description": "Detects the use of the clear-history in a powershell command line.",
      "text": "process.path ends with '\\\\powershell.exe' AND process.command_line contains 'clear-history'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1070",
            "name": "Indicator Removal on Host"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 1,
      "id": "PowerShell Clear History",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1070",
              "name": "Indicator Removal on Host"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1070",
              "name": "Indicator Removal on Host"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "PowerShell Exclusion Added to Defender",
      "description": "Detects the use of PowerShell to add a Microsoft Defender exclusion that attackers can use to avoid detections of malicious activity.",
      "text": "process.path ends with '\\\\powershell.exe' AND process.command_line contains 'Add-MpPreference' AND process.command_line contains '-ExclusionPath'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 1,
      "id": "PowerShell Exclusion Added to Defender",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "PowerShell Prompted For User Credentials",
      "description": "Detects the DLL loaded by a process when PowerShell is used to prompt the user for their credentials. Malware can use this technique to capture user credentials.",
      "text": "image.path contains 'credui.dll' AND image.path contains 'wincredui.dll' AND image.path contains 'System.Management.Automation'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1056",
            "name": "Input Capture"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 3,
      "id": "PowerShell Prompted For User Credentials",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1056",
              "name": "Input Capture"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1056",
              "name": "Input Capture"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "PowerShell Using PowerCat",
      "description": "This detects a PowerShell command that contains powercat, which is a PowerShell implementation of net cat. This tool is commonly used by attackers for remote shell access.",
      "text": "process.command_line contains 'powercat' AND image.path contains 'system.management.automation'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1505",
            "name": "Server Software Component"
          },
          {
            "id": "T1100",
            "name": "Web Shell"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 3,
      "id": "PowerShell Using PowerCat",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1505",
              "name": "Server Software Component"
            },
            {
              "id": "T1100",
              "name": "Web Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1505",
              "name": "Server Software Component"
            },
            {
              "id": "T1505.003",
              "name": "Server Software Component: Web Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "PowerShell Using System.Net.Sockets.TCPClient",
      "description": "This detects a PowerShell command containing System.Net.Sockets.TCPClient which can be used for remote command and control activity.",
      "text": "image.path contains 'system.management.automation' AND process.command_line contains 'New-Object' AND process.command_line contains 'System.Net.Sockets.TCPClient'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "PowerShell Using System.Net.Sockets.TCPClient",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "PowerUp DLL Hijacking Attempt",
      "description": "Detect default behavior of the Write-HijackableDll payload in the PowerShell PowerUp utility.",
      "text": "group(file.path ends with '\\\\debug.bat' AND file.operation is 'create') AND group(file.path ends with '\\\\wlbsctrl.dll' AND file.operation is 'create') AND process.path ends with NOT '\\\\explorer.exe' AND process.path ends with NOT '\\\\dllhost.exe'",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1129",
            "name": "Execution through Module Load"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 2,
      "id": "PowerUp DLL Hijacking Attempt",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1129",
              "name": "Execution through Module Load"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1129",
              "name": "Shared Modules"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Powershell Images Loaded by installutil.exe",
      "description": "Detects the loading of Powershell libraries by installutil.",
      "text": "process.path contains '\\\\installutil.exe' AND image.path contains 'Microsoft.PowerShell.Security.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Utility.ni.dll' AND image.path contains 'System.Management.Automation.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Diagnostics.ni.dll' AND image.path contains 'Microsoft.PowerShell.ConsoleHost.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Management.ni.dll'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1118",
            "name": "InstallUtil"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Powershell Images Loaded by installutil",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1118",
              "name": "InstallUtil"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218.004",
              "name": "Signed Binary Proxy Execution: InstallUtil"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Powershell Images Loaded by regasm.exe",
      "description": "Detects the loading of Powershell libraries by regasm.",
      "text": "process.path contains '\\\\regasm.exe' AND image.path contains 'Microsoft.PowerShell.Security.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Utility.ni.dll' AND image.path contains 'System.Management.Automation.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Diagnostics.ni.dll' AND image.path contains 'Microsoft.PowerShell.ConsoleHost.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Management.ni.dll'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1121",
            "name": "Regsvcs/Regasm"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Powershell Images Loaded by regasm",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1121",
              "name": "Regsvcs/Regasm"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218.009",
              "name": "Signed Binary Proxy Execution: Regsvcs/Regasm"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Powershell Images Loaded by regsvcs.exe",
      "description": "Detects the loading of Powershell libraries by regsvcs.",
      "text": "process.path contains '\\\\regsvcs.exe' AND image.path contains 'Microsoft.PowerShell.Security.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Utility.ni.dll' AND image.path contains 'System.Management.Automation.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Diagnostics.ni.dll' AND image.path contains 'Microsoft.PowerShell.ConsoleHost.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Management.ni.dll'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1121",
            "name": "Regsvcs/Regasm"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Powershell Images Loaded by regsvcs",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1121",
              "name": "Regsvcs/Regasm"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218.009",
              "name": "Signed Binary Proxy Execution: Regsvcs/Regasm"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Powershell Images Loaded by regsvr32.exe",
      "description": "Detects the loading of Powershell libraries by regsvr32.",
      "text": "process.path contains '\\\\regsvr32.exe' AND image.path contains 'Microsoft.PowerShell.Security.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Utility.ni.dll' AND image.path contains 'System.Management.Automation.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Diagnostics.ni.dll' AND image.path contains 'Microsoft.PowerShell.ConsoleHost.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Management.ni.dll'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1117",
            "name": "Regsvr32"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Powershell Images Loaded by regsvr32",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1117",
              "name": "Regsvr32"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218.010",
              "name": "Signed Binary Proxy Execution: Regsvr32"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Powershell Images Loaded by rundll32.exe",
      "description": "Detects the loading of Powershell libraries by rundll32.",
      "text": "process.path contains '\\\\rundll32.exe' AND image.path contains 'Microsoft.PowerShell.Security.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Utility.ni.dll' AND image.path contains 'System.Management.Automation.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Diagnostics.ni.dll' AND image.path contains 'Microsoft.PowerShell.ConsoleHost.ni.dll' AND image.path contains 'Microsoft.PowerShell.Commands.Management.ni.dll'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1085",
            "name": "Rundll32"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Powershell Images Loaded by rundll32",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1085",
              "name": "Rundll32"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218.011",
              "name": "Signed Binary Proxy Execution: Rundll32"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Privilege Escalation via apt update Option",
      "description": "Detects use of Apt which can be leveraged to escalate privileges as it usually must be run via sudo. A user authorized to run apt as sudo can get an arbitrary elevated shell.",
      "text": "process.path ends with '/apt' AND process.command_line contains '-o ' AND process.command_line contains 'APT::Update::Pre-Invoke::=/bin/' AND process.command_line ends with 'sh'",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Privilege Escalation via apt update Option",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Privilege Escalation via apt-get update Option",
      "description": "Detects use of apt-get which can be leveraged to escalate privileges as it usually must be run via sudo. A user authorized to run apt as sudo can get an arbitrary elevated shell.",
      "text": "process.path ends with '/apt-get' AND process.command_line contains '-o ' AND process.command_line contains 'APT::Update::Pre-Invoke::=/bin/' AND process.command_line ends with 'sh'",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Privilege Escalation via apt-get update Option",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "ProcDump Execution",
      "description": "Detects the execution of the tool ProcDump used for capturing the contents of a processes memory into a file. This is commonly used by attackers to image lsass memory that contains credentials as well as other processes memory that contains sensitive data of value.",
      "text": "registry.key_path contains 'Sysinternals\\\\ProcDump' AND process.command_line contains 'accepteula'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          }
        ]
      },
      "syntax_version": 1,
      "id": "ProcDump Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            },
            {
              "id": "T1003.001",
              "name": "OS Credential Dumping: LSASS Memory"
            }
          ]
        }
      }
    },
    {
      "name": "Program Compatibility Assistant (PCALUA.EXE) Misuse",
      "description": "Detects attempts to abuse the Windows Program Compatibility Assistant to execute malicious code based on suspicious command lines or paths.",
      "text": "process.path ends with '\\\\pcalua.exe' AND process.command_line contains ' -a ' AND (process.command_line contains '%TEMP%' OR process.command_line contains '\\\\\\\\' OR process.command_line contains '.LNK') OR (process.parent_path ends with '\\\\pcalua.exe' AND process.parent_command_line contains '-a ' AND (process.parent_command_line contains '%TEMP%' OR process.parent_command_line contains '\\\\\\\\' OR process.parent_command_line contains '.LNK'))",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1202",
            "name": "Indirect Command Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Program Compatibility Assistant (PCALUA.EXE) Misuse",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1202",
              "name": "Indirect Command Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Putty Spawning Suspicious Children",
      "description": "This signal looks for common putty processes spawning child processes that are not putty.exe",
      "text": "(process.parent_path ends with '\\\\putty.exe' OR process.parent_path ends with '\\\\pscp.exe' OR process.parent_path ends with '\\\\psftp.exe' OR process.parent_path ends with '\\\\puttytel.exe' OR (process.parent_path ends with '\\\\plink.exe' AND process.path ends with NOT '\\\\conhost.exe')) AND process.path ends with NOT '\\\\putty.exe'",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": []
      },
      "syntax_version": 1,
      "id": "Putty Spawning Suspicious Children",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": []
        },
        "v7": {
          "techniques": []
        }
      }
    },
    {
      "name": "Python Commands Download",
      "description": "Detects the use of python to download potentially suspect content.",
      "text": "process.command_line contains 'python' AND process.command_line contains '-c' AND process.command_line contains 'import' AND process.command_line contains 'os' AND process.command_line contains 'environ' AND process.command_line contains 'sys.version_info.major' AND process.command_line contains 'urllib' AND process.command_line contains 'urlretrieve'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1105",
            "name": "Remote File Copy"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Python Commands Download",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1105",
              "name": "Remote File Copy"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.006",
              "name": "Command and Scripting Interpreter: Python"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            }
          ]
        }
      }
    },
    {
      "name": "Python Commands Exfil",
      "description": "Detects the potential use of python to exfiltrate data.",
      "text": "process.command_line contains 'python' AND process.command_line contains '-c' AND process.command_line contains 'import' AND process.command_line contains 'os' AND process.command_line contains 'sys.version_info.major' AND ( ( process.command_line contains 'urllib' AND process.command_line contains 'urlopen' AND process.command_line contains 'bytes' AND process.command_line contains 'urlencode' AND process.command_line contains 'read' ) OR ( process.command_line contains 'http.server' AND process.command_line contains 'socketserver' AND process.command_line contains 'SimpleHTTPServer' AND process.command_line contains 'TCPServer' AND process.command_line contains 'SimpleHTTPRequestHandler' AND process.command_line contains 'serve_forever' ) )",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Python Commands Exfil",
      "modification-date": "2021-01-25T15:10:46.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.006",
              "name": "Command and Scripting Interpreter: Python"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Python Commands Reverse Shell",
      "description": "Detects common commands used to create a reverse shell with python.",
      "text": "process.command_line contains 'python' AND process.command_line contains '-c' AND process.command_line contains 'socket' AND process.command_line contains 'dup2' AND process.command_line contains 'fileno' AND process.command_line contains 'sh'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Python Commands Reverse Shell",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.006",
              "name": "Command and Scripting Interpreter: Python"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Python Load Shared Libraries",
      "description": "Detects the use of python to load a library for execution.",
      "text": "process.path ends with 'python' AND process.command_line contains '-c' AND process.command_line contains 'from ctypes' AND process.command_line contains 'import cdll' AND process.command_line contains 'cdll.LoadLibrary'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Python Load Shared Libraries",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.006",
              "name": "Command and Scripting Interpreter: Python"
            }
          ]
        }
      }
    },
    {
      "name": "Python Privilege Escalation",
      "description": "Detects common commands used to escalate privileges with python.",
      "text": "process.command_line contains 'python' AND process.command_line contains 'import os' AND process.command_line contains 'os.setuid' AND process.command_line contains 'os.system' AND process.command_line contains 'sh'",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Python Privilege Escalation",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1166",
              "name": "Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1548.001",
              "name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.006",
              "name": "Command and Scripting Interpreter: Python"
            }
          ]
        }
      }
    },
    {
      "name": "Python SimpleHTTPRequestHandler Exfil",
      "description": "Detects the potential use of python SimpleHTTPRequestHandler for data exfiltration.",
      "text": "process.path contains '/python' AND process.command_line contains 'import' AND process.command_line contains 'http.server.SimpleHTTPRequestHandler' AND process.command_line contains 'socketserver.TCPServer' AND process.command_line contains 'serve_forever'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Python SimpleHTTPRequestHandler Exfil",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Python SimpleHTTPServer Exfil",
      "description": "Detects the use of python SimplerHTTPServer to make a directory available to the web which can be used for exfiltration.",
      "text": "process.path contains '/python' and process.command_line contains '-m' and process.command_line contains 'SimpleHTTPServer'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Python SimpleHTTPServer Exfil",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Python http.server Exfil",
      "description": "Detects the use of python http.server to make a directory available to the web which can be used for exfiltration.",
      "text": "process.path contains '/python' and process.command_line contains '-m' and process.command_line contains 'http.server'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Python http.server Exfil",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "RDP Enabled via Registry Modification",
      "description": "Detects the enablement of RDP on a system via modification of the property values of the fDenyTSConnections and UserAuthentication keys.",
      "text": "registry.key_path contains 'CurrentControlSet\\\\Control\\\\Terminal Server\\\\WinStations\\\\Rdp-Tcp' OR registry.key_path contains 'CurrentControlSet\\\\Control\\\\Terminal Server\\\\fDenyTSConnections'",
      "labels": [
        "Beta",
        "Lateral Movement",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1076",
            "name": "Remote Desktop Protocol"
          },
          {
            "id": "T1021",
            "name": "Remote Services"
          }
        ]
      },
      "syntax_version": 1,
      "id": "RDP Enabled via Registry Modification",
      "modification-date": "2021-05-24T15:20:29.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1076",
              "name": "Remote Desktop Protocol"
            },
            {
              "id": "T1021",
              "name": "Remote Services"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1021.001",
              "name": "Remote Services: Remote Desktop Protocol"
            },
            {
              "id": "T1021",
              "name": "Remote Services"
            }
          ]
        }
      }
    },
    {
      "name": "RDP Tunneling",
      "description": "Detects potential configuration of RDP to listen on a system for connections. This technique can be used by attackers to bypasses network restrictions by tunneling malicious connections.",
      "text": "group(network.port is '3389' AND (network.address starts with '127.0.' OR network.address is '::1'))",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1021",
            "name": "Remote Services"
          },
          {
            "id": "T1076",
            "name": "Remote Desktop Protocol"
          }
        ]
      },
      "syntax_version": 3,
      "id": "RDP Tunneling",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1021",
              "name": "Remote Services"
            },
            {
              "id": "T1076",
              "name": "Remote Desktop Protocol"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1021",
              "name": "Remote Services"
            },
            {
              "id": "T1021.001",
              "name": "Remote Services: Remote Desktop Protocol"
            }
          ]
        }
      }
    },
    {
      "name": "RDP Tunneling with Chisel",
      "description": "Chisel is a network tunneling tool that can be used to create encrypted channels into internal network environments, such as to perform RDP tunnelling. Chisel can transmit TCP over HTTP and encrypt the communication via SSH in order to evade firewall rules and deep packet inspection.",
      "text": "process.command_line contains 'client' AND process.command_line contains 'R:' AND process.command_line contains ':3389'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1021",
            "name": "Remote Services"
          },
          {
            "id": "T1076",
            "name": "Remote Desktop Protocol"
          }
        ]
      },
      "syntax_version": 3,
      "id": "RDP Tunneling with Chisel",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1021",
              "name": "Remote Services"
            },
            {
              "id": "T1076",
              "name": "Remote Desktop Protocol"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1572",
              "name": "Protocol Tunneling"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1021",
              "name": "Remote Services"
            },
            {
              "id": "T1021.001",
              "name": "Remote Services: Remote Desktop Protocol"
            }
          ]
        }
      }
    },
    {
      "name": "RDP Tunneling with Fast Reverse Proxy",
      "description": "Fast Reverse Proxy (FRP) is a networking tool that can be used to expose firewalled or NATd network IPs to the Internet. It supports TCP and UDP, as well as HTTP and HTTPS protocols.",
      "text": "process.path ends with '\\\\frpc.exe' AND process.command_line contains '-c' AND process.command_line contains '.ini' AND network.port is '3389'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1021",
            "name": "Remote Services"
          },
          {
            "id": "T1076",
            "name": "Remote Desktop Protocol"
          }
        ]
      },
      "syntax_version": 3,
      "id": "RDP Tunneling with Fast Reverse Proxy",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1021",
              "name": "Remote Services"
            },
            {
              "id": "T1076",
              "name": "Remote Desktop Protocol"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1572",
              "name": "Protocol Tunneling"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1021",
              "name": "Remote Services"
            },
            {
              "id": "T1021.001",
              "name": "Remote Services: Remote Desktop Protocol"
            }
          ]
        }
      }
    },
    {
      "name": "RDP Tunneling with plink",
      "description": "A common utility used to tunnel RDP sessions is PuTTY Link, commonly known as Plink. Plink can be used to establish SSH network connections to other systems using arbitrary source and destination ports. Since many IT environments either do not perform protocol inspection or do not block SSH communications outbound from their network, attackers such as FIN8 have used Plink to create encrypted tunnels that allow RDP ports on infected systems to communicate back to the attacker command and control (C2) server.",
      "text": "process.path ends with '\\\\plink.exe' AND process.command_line contains '-P' AND process.command_line contains '-T' AND process.command_line contains '-N' AND process.command_line contains '-C' AND process.command_line contains '-R' AND process.command_line contains ':3389'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1079",
            "name": "Multilayer Encryption"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1021",
            "name": "Remote Services"
          },
          {
            "id": "T1076",
            "name": "Remote Desktop Protocol"
          }
        ]
      },
      "syntax_version": 3,
      "id": "RDP Tunneling with plink",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1079",
              "name": "Multilayer Encryption"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1021",
              "name": "Remote Services"
            },
            {
              "id": "T1076",
              "name": "Remote Desktop Protocol"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1572",
              "name": "Protocol Tunneling"
            },
            {
              "id": "T1573",
              "name": "Encrypted Channel"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1021",
              "name": "Remote Services"
            },
            {
              "id": "T1021.001",
              "name": "Remote Services: Remote Desktop Protocol"
            }
          ]
        }
      }
    },
    {
      "name": "REGSVR32 Script Component Runtime Misuse",
      "description": "Detects the use of regsvr32 to download content from a malicious URL and invoke the Microsoft Script Component Runtime (scrobj.dll) module to execute the code.",
      "text": "process.path ends with 'regsvr32.exe' AND (((process.command_line contains 'http:' OR process.command_line contains 'https:') AND process.command_line contains 'scrobj.dll') OR (process.command_line contains 'i:' AND process.command_line contains 'rs64'))",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1117",
            "name": "Regsvr32"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1105",
            "name": "Remote File Copy"
          }
        ]
      },
      "syntax_version": 1,
      "id": "REGSVR32 Script Component Runtime Misuse",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1117",
              "name": "Regsvr32"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1105",
              "name": "Remote File Copy"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.010",
              "name": "Signed Binary Proxy Execution: Regsvr32"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            }
          ]
        }
      }
    },
    {
      "name": "Rdrleakdiag Process Dump",
      "description": "Detects the execution of rdrleakdiag.exe when used to dump a processes memory. This can be used by attackers to dump lsass memory that contains credentials and other processes memory that contains valuable sensitive data.",
      "text": "process.path ends with '\\\\rdrleakdiag.exe' AND process.command_line contains 'p' AND process.command_line contains 'o' AND process.command_line contains 'fullmemdmp'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Rdrleakdiag Process Dump",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            },
            {
              "id": "T1003.001",
              "name": "OS Credential Dumping: LSASS Memory"
            }
          ]
        }
      }
    },
    {
      "name": "Reg SAM Access",
      "description": "Detects the use of reg.exe to access the SAM hive. Attackers might use this technique to attempt to access credentials on a system.",
      "text": "process.path ends with '\\\\reg.exe' AND process.command_line contains '\\\\sam' AND process.command_line contains 'HK' AND process.command_line contains 'L' AND process.command_line contains 'M'",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Reg SAM Access",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            },
            {
              "id": "T1003.002",
              "name": "OS Credential Dumping: Security Account Manager"
            }
          ]
        }
      }
    },
    {
      "name": "Reg Security Access",
      "description": "Detects the use of reg.exe to access the Security hive. Attackers might use this technique to attempt to access credentials on a system.",
      "text": "process.path ends with '\\\\reg.exe' AND process.command_line contains '\\\\security' AND process.command_line contains 'HK' AND process.command_line contains 'L' AND process.command_line contains 'M'",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Reg Security Access",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            },
            {
              "id": "T1003.002",
              "name": "OS Credential Dumping: Security Account Manager"
            }
          ]
        }
      }
    },
    {
      "name": "Regasm DLL Load",
      "description": "Regasm can be used by attackers to load a dll while bypassing security controls on systems. calling a dll with regasm will execute the RegisterClass function. If the dll is called with the /U flag it will call the UnRegisterClass function.",
      "text": "process.path ends with '\\\\regasm.exe' AND process.command_line contains '.dll'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Regasm DLL Load",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Registry Disable All .NET ETW Logging",
      "description": "Detects potential disabling of all .NET ETW logging with the modification of the ETWEnabled setting.",
      "text": "group(registry.key_path contains '.NETFramework' AND registry.value_name is 'ETWEnabled')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          },
          {
            "id": "T1054",
            "name": "Indicator Blocking"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Registry Disable All .NET ETW Logging",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            },
            {
              "id": "T1054",
              "name": "Indicator Blocking"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            },
            {
              "id": "T1562.006",
              "name": "Impair Defenses: Indicator Blocking"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Remote Scheduled Task Creation",
      "description": "Detects the use of AT.EXE or SCHTASKS.EXE to create a scheduled task on a remote computer. Attackers commonly use this technique to execute a command on a remote system during lateral movement.",
      "text": "(process.path ends with 'schtasks.exe' AND process.command_line contains '/create' AND process.command_line contains '/s ') OR (process.path ends with '\\\\at.exe' AND process.command_line contains '\\\\\\\\')",
      "labels": [
        "Beta",
        "Lateral Movement",
        "Persistence",
        "Privilege Escalation",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1168",
            "name": "Local Job Scheduling"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Remote Scheduled Task Creation",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1168",
              "name": "Local Job Scheduling"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1053",
              "name": "Scheduled Task/Job"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Remote Service Control Named Pipe Interaction",
      "description": "Detects processes that connect to RPC port 135 and write to the svcctl named pipe. This is used for the PsExec-like functionality provided by Invoke-PsExec in PowerShell Empire. This may produce false positives for legitimate applications that interact with the same named pipe.",
      "text": "group(file.path ends with '\\\\pipe\\\\svcctl' AND file.operation is 'write') AND network.port is '135' AND process.path ends with NOT '\\\\mmc.exe' AND process.path ends with NOT '\\\\smss.exe'  AND process.path ends with NOT '\\\\explorer.exe'",
      "labels": [
        "Beta",
        "Lateral Movement",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Remote Service Control Named Pipe Interaction",
      "modification-date": "2020-10-13T19:31:33.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            }
          ]
        }
      }
    },
    {
      "name": "Remote Service Creation",
      "description": "Detects the creation of a Windows service on a remote host using the SC.EXE command. May be used by attackers to establish persistence for a previously-transferred malicious file.",
      "text": "process.path ends with '\\\\sc.exe' AND process.command_line contains 'create' AND process.command_line contains '\\\\\\\\'",
      "labels": [
        "Beta",
        "Lateral Movement",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1021",
            "name": "Remote Services"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Remote Service Creation",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1021",
              "name": "Remote Services"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1021",
              "name": "Remote Services"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Removing Windows Defender Signatures",
      "description": "Detects use of command line utility mpcmdrun.exe to remove a Windows Defender signature.",
      "text": "process.path ends with '\\\\mpcmdrun.exe' AND process.command_line contains 'RemoveDefinitions'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1070",
            "name": "Indicator Removal on Host"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Removing Windows Defender Signatures",
      "modification-date": "2020-10-13T19:31:33.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1070",
              "name": "Indicator Removal on Host"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1070",
              "name": "Indicator Removal on Host"
            }
          ]
        }
      }
    },
    {
      "name": "Right-to-Left Override",
      "description": "Detects the use of Right-to-Left Override to reverse characters in a filename. This is commonly used to disguise files by hiding their true extension.",
      "text": "process.path contains '\\xe2\\x80\\xae' OR process.command_line contains '\\xe2\\x80\\xae' OR file.path contains '\\xe2\\x80\\xae'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Right-to-Left Override",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.002",
              "name": "Masquerading: Right-to-Left Override"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Rpcping Credential Capture Named Pipe",
      "description": "Detects the use of rpcping to capture credentials over a named pipe.",
      "text": "process.path ends with '\\\\rpcping.exe' AND process.command_line contains 'ncacn_np'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Rpcping Credential Capture Named Pipe",
      "modification-date": "2020-10-13T19:31:33.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            }
          ]
        }
      }
    },
    {
      "name": "Rpcping Credential Capture Port",
      "description": "Detects the use of rpcping to capture credentials over a port.",
      "text": "process.path ends with '\\\\rpcping.exe' AND process.command_line contains 'privacy' AND process.command_line contains 'NTLM'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Rpcping Credential Capture Port",
      "modification-date": "2020-10-13T19:31:33.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            }
          ]
        }
      }
    },
    {
      "name": "Ruby Capabilities Privilege Escalation",
      "description": "Detects Ruby commands to escalate privileges by making arbitrary manipulations of process UIDs.",
      "text": "process.command_line contains 'ruby' AND process.command_line contains '-e' AND process.command_line contains 'Process' AND process.command_line contains 'Sys.setuid' AND process.command_line contains 'exec' AND process.command_line contains 'sh'",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1166",
            "name": "Setuid and Setgid"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Ruby Capabilities Privilege Escalation",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1166",
              "name": "Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1548.001",
              "name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Ruby Commands Reverse Shell",
      "description": "Detects common commands used to create a reverse shell with ruby.",
      "text": "process.command_line contains 'ruby' AND process.command_line contains '-rsocket' AND process.command_line contains 'TCPSocket' AND process.command_line contains 'sh'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Ruby Commands Reverse Shell",
      "modification-date": "2021-01-25T15:10:46.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "RunDLL INF Script Execution",
      "description": "Detects the use of RunDLL to bypass AppLocker using an INF script.",
      "text": "process.path contains 'rundll32.exe' AND ((process.command_line contains 'advpack.dll' AND process.command_line contains 'LaunchINFSection' AND process.parent_command_line contains NOT '-UserConfig') OR (process.command_line contains 'setupapi.dll' AND process.command_line contains 'InstallHinfSection') OR (process.command_line contains 'ieadvpack.dll' AND process.command_line contains 'LaunchINFSection')) AND process.command_line contains '.inf'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1085",
            "name": "Rundll32"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "RunDLL INF Script Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1085",
              "name": "Rundll32"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.011",
              "name": "Signed Binary Proxy Execution: Rundll32"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "RunDll Creating MiniDump",
      "description": "Detects the execution of RunDll32 when used to create a process minidump. This can be used by attackers to image lsass memory that contains credentials as well as other processes memory that contains sensitive data of value.",
      "text": "process.path ends with '\\\\rundll32.exe' AND process.command_line contains 'comsvcs.dll' AND process.command_line contains 'MiniDump'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1085",
            "name": "Rundll32"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "RunDll Creating MiniDump",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1085",
              "name": "Rundll32"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            },
            {
              "id": "T1003.001",
              "name": "OS Credential Dumping: LSASS Memory"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.011",
              "name": "Signed Binary Proxy Execution: Rundll32"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "RunDll Creating MiniDump Function 24",
      "description": "Detects the execution of RunDll32 to create a process minidump by invoking comsvcs.dll function 24. This can be used by attackers to image lsass memory that contains credentials as well as other processes memory that contains sensitive data of value.",
      "text": "process.path ends with '\\\\rundll32.exe' AND process.command_line contains 'comsvcs.dll' AND process.command_line contains '24'",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1085",
            "name": "Rundll32"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "RunDll Creating MiniDump Function 24",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1085",
              "name": "Rundll32"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            },
            {
              "id": "T1003.001",
              "name": "OS Credential Dumping: LSASS Memory"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.011",
              "name": "Signed Binary Proxy Execution: Rundll32"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Runas User Restriction Bypass",
      "description": "Detects the use of vulnerability CVE-2019-14287 to bypass runas restrictions from a sufficiently privileged user.",
      "text": "process.command_line contains 'id' AND (process.command_line contains '-u#-1 ' OR process.command_line contains '-u#4294967295 ')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Runas User Restriction Bypass",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Runscripthelper Execution ps1",
      "description": "Detects the execution of runscripthelper.exe to execute powershell bypassing constrained language mode.",
      "text": "process.command_line contains 'runscripthelper.exe' AND process.command_line contains 'surfacecheck' AND process.command_line contains '.ps1'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Runscripthelper Execution ps1",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Runscripthelper Execution txt",
      "description": "Detects the execution of runscripthelper.exe to execute powershell bypassing constrained language mode. Attackers have been seen to label powershell files as .txt to avoid detection.",
      "text": "process.command_line contains 'runscripthelper.exe' AND process.command_line contains 'surfacecheck' AND process.command_line contains '.txt'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Runscripthelper Execution txt",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        }
      }
    },
    {
      "name": "SDB Install Using Sdb Explorer",
      "description": "Detects SDBs installed by accounts other than trusted installer which can be used for persistence.",
      "text": "process.user_name is NOT 'trustedinstaller' AND process.command_line contains '-R' AND process.command_line contains '.sdb'",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1138",
            "name": "Application Shimming"
          }
        ]
      },
      "syntax_version": 4,
      "id": "SDB Install Using Sdb Explorer",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1138",
              "name": "Application Shimming"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.011",
              "name": "Event Triggered Execution: Application Shimming"
            }
          ]
        }
      }
    },
    {
      "name": "SDB Install Using Sdbinst",
      "description": "Detects SDBs installed by accounts other than trusted installer which can be used for persistence.",
      "text": "process.user_name is NOT 'trustedinstaller' AND process.path ends with '\\\\sdbinst.exe'",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1138",
            "name": "Application Shimming"
          }
        ]
      },
      "syntax_version": 4,
      "id": "SDB Install Using Sdbinst",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1138",
              "name": "Application Shimming"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.011",
              "name": "Event Triggered Execution: Application Shimming"
            }
          ]
        }
      }
    },
    {
      "name": "SSH Commands Exfil Using Cat",
      "description": "Detects common commands used to exfiltrate data over an SSH tunnel.",
      "text": "process.path ends with 'ssh' AND process.command_line contains 'ssh' AND process.command_line contains 'cat' AND process.command_line contains '>' AND file.path ends with 'tty'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "SSH Commands Exfil Using Cat",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "SSH Commands Exfil Using Head",
      "description": "Detects common commands used to exfiltrate data over an SSH tunnel.",
      "text": "process.path ends with 'ssh' AND process.command_line contains 'ssh' AND process.command_line contains 'head' AND process.command_line contains '>' AND file.path ends with 'tty'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "SSH Commands Exfil Using Head",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "SSH Commands Exfil Using Less",
      "description": "Detects common commands used to exfiltrate data over an SSH tunnel.",
      "text": "process.path ends with 'ssh' AND process.command_line contains 'ssh' AND process.command_line contains 'less' AND process.command_line contains '>' AND file.path ends with 'tty'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "SSH Commands Exfil Using Less",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "SSH Commands Exfil Using More",
      "description": "Detects common commands used to exfiltrate data over an SSH tunnel.",
      "text": "process.path ends with 'ssh' AND process.command_line contains 'ssh' AND process.command_line contains 'more' AND process.command_line contains '>' AND file.path ends with 'tty'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "SSH Commands Exfil Using More",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "SSH Commands Exfil Using Tac",
      "description": "Detects common commands used to exfiltrate data over an SSH tunnel.",
      "text": "process.path ends with 'ssh' AND process.command_line contains 'ssh' AND process.command_line contains 'tac' AND process.command_line contains '>' AND file.path ends with 'tty'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "SSH Commands Exfil Using Tac",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "SSH Commands Exfil Using Tail",
      "description": "Detects common commands used to exfiltrate data over an SSH tunnel.",
      "text": "process.path ends with 'ssh' AND process.command_line contains 'ssh' AND process.command_line contains 'tail' AND process.command_line contains '>' AND file.path ends with 'tty'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "SSH Commands Exfil Using Tail",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "SSH Commands Exfil Using Tar",
      "description": "Detects common commands used to exfiltrate data over an SSH tunnel.",
      "text": "process.path ends with 'ssh' AND process.command_line contains 'ssh' AND process.command_line contains 'tar' AND process.command_line contains '>' AND file.path ends with 'tty'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "SSH Commands Exfil Using Tar",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "SSH Proxy using ProxyCommand",
      "description": "Detects common commands that are used to proxy a connection using the ssh proxycommand feature.",
      "text": "process.path ends with 'ssh' AND process.command_line contains 'ProxyCommand' AND process.command_line contains 'ssh' AND process.command_line contains '-W' AND process.command_line contains '%h' AND process.command_line contains '%p' AND file.path ends with 'tty'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "SSH Proxy using ProxyCommand",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "SUID or GUID Enumeration",
      "description": "Detects commands used to enumerate files with the SUID or GUID bits configured. Attackers may search for files with setsuid or setgid bits in order to execute programs in a different user context, which could provide privilege escalation or persistence.",
      "text": "process.command_line contains 'find' AND process.command_line contains '-perm' AND (process.command_line contains '4000' OR process.command_line contains '2000' OR process.command_line contains '6000' OR process.command_line contains 'u=s' OR process.command_line contains 'u+s' OR process.command_line contains 'g=s' OR process.command_line contains 'g+s' OR process.command_line contains 'a+s' OR process.command_line contains 'a=s')",
      "labels": [
        "Beta",
        "Discovery",
        "Persistence",
        "Privilege Escalation",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "mac",
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1083",
            "name": "File and Directory Discovery"
          },
          {
            "id": "T1166",
            "name": "Setuid and Setgid"
          }
        ]
      },
      "syntax_version": 3,
      "id": "SUID or GUID Enumeration",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1083",
              "name": "File and Directory Discovery"
            },
            {
              "id": "T1166",
              "name": "Setuid and Setgid"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1574",
              "name": "Hijack Execution Flow"
            },
            {
              "id": "T1574.005",
              "name": "Hijack Execution Flow: Executable Installer File Permissions Weakness"
            },
            {
              "id": "T1083",
              "name": "File and Directory Discovery"
            },
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1548.001",
              "name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
            }
          ]
        }
      }
    },
    {
      "name": "Script Based Scheduled Tasks",
      "description": "Detects the creation of scheduled tasks using common executables to launch scripts.",
      "text": "process.path ends with 'schtasks.exe' AND process.command_line contains '/create' AND (process.command_line contains 'wscript' OR process.command_line contains 'cscript' OR process.command_line contains 'powershell' OR process.command_line contains 'cmd')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Persistence",
        "Privilege Escalation",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1168",
            "name": "Local Job Scheduling"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Script Based Scheduled Tasks",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1168",
              "name": "Local Job Scheduling"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1053",
              "name": "Scheduled Task/Job"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Script Commands Terminal Bypass",
      "description": "Detects common commands that are used to bypass the terminal using script.",
      "text": "process.path ends with 'script' AND process.command_line contains 'script' AND process.command_line contains '-qc' AND process.command_line contains 'sh'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Script Commands Terminal Bypass",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Scripts Created by Office Applications",
      "description": "Detects the creation of script files that are often dropped by malicious Office macros and other document exploits.",
      "text": "(process.path ends with 'winword.exe' OR process.path ends with 'excel.exe' OR process.path ends with 'outlook.exe') AND group((file.operation is 'create' OR file.operation is 'rename') AND (file.path ends with '.ps1' OR file.path ends with '.vbs'))",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Scripts Created by Office Applications",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1059.005",
              "name": "Command and Scripting Interpreter: Visual Basic"
            }
          ]
        }
      }
    },
    {
      "name": "Security Trampoline Privilege Escalation",
      "description": "The MacOS AuthorizationExecuteWithPrivileges API is a method for applications to request root privileges. This API is deprecated by Apple and has a number of security vulnerabilities. The use of this API is suspicious, but not necessarily malicious.",
      "text": "process.path contains 'security_authtrampoline'",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Mac"
      ],
      "platforms": [
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1068",
            "name": "Exploitation for Privilege Escalation"
          },
          {
            "id": "T1166",
            "name": "Setuid and Setgid"
          },
          {
            "id": "T1514",
            "name": "Elevated Execution with Prompt"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Security Trampoline Privilege Escalation",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1068",
              "name": "Exploitation for Privilege Escalation"
            },
            {
              "id": "T1166",
              "name": "Setuid and Setgid"
            },
            {
              "id": "T1514",
              "name": "Elevated Execution with Prompt"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1068",
              "name": "Exploitation for Privilege Escalation"
            },
            {
              "id": "T1548",
              "name": "Abuse Elevation Control Mechanism"
            },
            {
              "id": "T1548.001",
              "name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
            },
            {
              "id": "T1548.004",
              "name": "Abuse Elevation Control Mechanism: Elevated Execution with Prompt"
            }
          ]
        }
      }
    },
    {
      "name": "Service Security Descriptor Discovery SCManager",
      "description": "Detects usage of the sc.exe utility to enumerate security descriptors of scmanager. Attackers can use this during post-compromise reconnaissance of DACL permissions to enumerate the scmanager binary.",
      "text": "process.path ends with '\\\\sc.exe' AND process.command_line contains 'sdshow' AND process.command_line contains 'scmanager'",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Service Security Descriptor Discovery SCManager",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Service Security Descriptor Persistence SCManager",
      "description": "Detects usage of the sc.exe utility to set the security descriptors of scmanager. Attackers can use this during post-compromise to set the DACL permissions for the scmanager binary which can be used for persistence.",
      "text": "process.path ends with '\\\\sc.exe' AND process.command_line contains 'sdset' AND process.command_line contains 'scmanager'",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1044",
            "name": "File System Permissions Weakness"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Service Security Descriptor Persistence SCManager",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1044",
              "name": "File System Permissions Weakness"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1574",
              "name": "Hijack Execution Flow"
            },
            {
              "id": "T1574.010",
              "name": "Hijack Execution Flow: Services File Permissions Weakness"
            }
          ]
        }
      }
    },
    {
      "name": "Services Running as not System",
      "description": "Detects when services.exe is running as something other than the system user, which could indicate attacker activity.",
      "text": "process.path ends with '\\\\services.exe' AND process.user_name is NOT 'SYSTEM'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Services Running as not System",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Set Password to Never Expire via chage",
      "description": "Detects the use of chage to set a password to never expire. Attackers can use this technique to insure accounts they create on compromised systems do not expire.",
      "text": "process.path ends with '/chage' and process.command_line contains '-M' and process.command_line contains '-1'",
      "labels": [
        "Beta",
        "Persistence",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1136",
            "name": "Create Account"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Set Password to Never Expire via chage",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1136",
              "name": "Create Account"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1136",
              "name": "Create Account"
            },
            {
              "id": "T1136.001",
              "name": "Create Account: Local Account"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Set Password to Never Expire via passwd",
      "description": "Detects the use of passwd to set a password to never expire. Attackers can use this technique to insure accounts they create on compromised systems do not expire.",
      "text": "process.path ends with '/passwd' and process.command_line contains '-x' and process.command_line contains '-1'",
      "labels": [
        "Beta",
        "Persistence",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1136",
            "name": "Create Account"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Set Password to Never Expire via passwd",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1136",
              "name": "Create Account"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1136",
              "name": "Create Account"
            },
            {
              "id": "T1136.001",
              "name": "Create Account: Local Account"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "SharpPack Image Load",
      "description": "Detects the loading of SharpPack.dll into a process. SharpPack.dll can be loaded into a legitimate processes runspace to execute various malicious actions and avoids AppLocker and other whitelisting tools.",
      "text": "image.path contains 'sharppack.dll'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1129",
            "name": "Execution through Module Load"
          }
        ]
      },
      "syntax_version": 3,
      "id": "SharpPack Image Load",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1129",
              "name": "Execution through Module Load"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1055.001",
              "name": "Process Injection: Dynamic-link Library Injection"
            },
            {
              "id": "T1129",
              "name": "Shared Modules"
            }
          ]
        }
      }
    },
    {
      "name": "Shim Database Persistence",
      "description": "Detects when a file is created to execute a suspicious shim binary.",
      "text": "group(file.operation is 'create' AND file.path contains '\\\\apppatch' AND file.path contains '.sdb' AND file.path contains NOT '\\\\Custom')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1138",
            "name": "Application Shimming"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Shim Database Persistence",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1138",
              "name": "Application Shimming"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.011",
              "name": "Event Triggered Execution: Application Shimming"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Shlayer Curl Activity Bash",
      "description": "This Signal detects the command line flag -f0L and writing files to tmp that are unique to the Shlayer malware.",
      "text": "process.path ends with 'curl' AND process.command_line contains '-f0L' AND file.path starts with '/tmp/' AND process.parent_path ends with '/bash'",
      "labels": [
        "Beta",
        "Command and Control",
        "Mac"
      ],
      "platforms": [
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Shlayer Curl Activity Bash",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Shlayer Curl Activity Python",
      "description": "This Signal detects the command line flag -f0L and writing files to tmp that are unique to the Shlayer malware.",
      "text": "process.path ends with 'curl' AND process.command_line contains '-f0L' AND file.path starts with '/tmp/' AND process.parent_path contains '/python'",
      "labels": [
        "Beta",
        "Command and Control",
        "Mac"
      ],
      "platforms": [
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Shlayer Curl Activity Python",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.006",
              "name": "Command and Scripting Interpreter: Python"
            }
          ]
        }
      }
    },
    {
      "name": "Shlayer Curl Activity Sh",
      "description": "This Signal detects the command line flag -f0L and writing files to tmp that are unique to the Shlayer malware.",
      "text": "process.path ends with 'curl' AND process.command_line contains '-f0L' AND file.path starts with '/tmp/' AND process.parent_path ends with '/sh'",
      "labels": [
        "Beta",
        "Command and Control",
        "Mac"
      ],
      "platforms": [
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Shlayer Curl Activity Sh",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Shlayer Curl Activity Zsh",
      "description": "This Signal detects the command line flag -f0L and writing files to tmp that are unique to the Shlayer malware.",
      "text": "process.path ends with 'curl' AND process.command_line contains '-f0L' AND file.path starts with '/tmp/' AND process.parent_path ends with '/zsh'",
      "labels": [
        "Beta",
        "Command and Control",
        "Mac"
      ],
      "platforms": [
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Shlayer Curl Activity Zsh",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Shlayer Openssl Suspicious Decoding",
      "description": "Detects suspicious command line arguments for the Openssl utility, commonly associated with Shlayer malware.",
      "text": "process.path ends with 'openssl' AND process.command_line contains 'enc' AND process.command_line contains '-base64' AND process.command_line contains 'pass' AND process.command_line contains 'salt' AND process.command_line contains '-aes-256-cbc' AND process.command_line contains '-d' AND process.parent_path contains 'sh'",
      "labels": [
        "Beta",
        "Command and Control",
        "Mac"
      ],
      "platforms": [
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1140",
            "name": "Deobfuscate/Decode Files or Information"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Shlayer Openssl Suspicious Decoding",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1140",
              "name": "Deobfuscate/Decode Files or Information"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1140",
              "name": "Deobfuscate/Decode Files or Information"
            }
          ]
        }
      }
    },
    {
      "name": "Signed Script Proxy Execution Cscript WinRM",
      "description": "Detects the execution of winrm.vbs using cscript which can be used to proxy execution with the signed script.",
      "text": "process.path ends with '\\\\cscript.exe' AND process.command_line contains 'nologo' AND process.command_line contains 'winrm.vbs' AND process.command_line contains 'wmicimv2'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Persistence",
        "Privilege Escalation",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1216",
            "name": "Signed Script Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Signed Script Proxy Execution Cscript WinRM",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1216",
              "name": "Signed Script Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1216",
              "name": "Signed Script Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1059.005",
              "name": "Command and Scripting Interpreter: Visual Basic"
            }
          ]
        }
      }
    },
    {
      "name": "Silent Audio Capture via SoundRecorder",
      "description": "Detects the use of the SoundRecorder application to capture audio on a Windows system.",
      "text": "process.path ends with '\\\\SoundRecorder.exe' AND process.command_line contains '/FILE'",
      "labels": [
        "Beta",
        "Collection",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1123",
            "name": "Audio Capture"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Silent Audio Capture via SoundRecorder",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1123",
              "name": "Audio Capture"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1123",
              "name": "Audio Capture"
            }
          ]
        }
      }
    },
    {
      "name": "Socat Commands Bind Shell",
      "description": "Detects common commands used to create a shell with socat.",
      "text": "process.command_line contains 'socat' AND process.command_line contains 'TCP-LISTEN' AND process.command_line contains 'reuseaddr' AND process.command_line contains 'fork' AND process.command_line contains 'exec' AND process.command_line contains 'sh' AND process.command_line contains 'pty' AND process.command_line contains 'setsid' AND process.command_line contains 'sane'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Socat Commands Bind Shell",
      "modification-date": "2021-01-25T15:10:46.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Socat Commands Download",
      "description": "Detects common commands that are used to download arbitrary files using socat.",
      "text": "process.command_line contains 'socat' AND process.command_line contains '-u' AND process.command_line contains 'tcp-connect:' AND process.command_line contains 'open:' AND process.command_line contains 'create'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1105",
            "name": "Remote File Copy"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Socat Commands Download",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1105",
              "name": "Remote File Copy"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            }
          ]
        }
      }
    },
    {
      "name": "Socat Commands Exfiltration",
      "description": "Detects common commands that are used to exfiltrate data using socat.",
      "text": "process.command_line contains 'socat' AND process.command_line contains '-u' AND process.command_line contains 'file:' AND process.command_line contains 'tcp-connect:'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Socat Commands Exfiltration",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            }
          ]
        }
      }
    },
    {
      "name": "Socat Commands Interactive SSH",
      "description": "Detects common commands that are used to create an interactive SSH session using socat.",
      "text": "process.command_line contains 'socat' AND process.command_line contains 'echo' AND (process.command_line contains 'raw' OR process.command_line contains 'icanon') AND process.command_line contains 'exec:' AND process.command_line contains 'ssh' AND process.command_line contains 'pty' AND process.command_line contains 'setsid' AND process.command_line contains 'ctty'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Socat Commands Interactive SSH",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Socat Commands Reverse Shell",
      "description": "Detects common commands used to create a shell with socat.",
      "text": "process.command_line contains 'socat' AND process.command_line contains 'tcp-connect' AND process.command_line contains 'exec' AND process.command_line contains 'sh' AND process.command_line contains 'pty' AND process.command_line contains 'setsid' AND process.command_line contains 'sane'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Socat Commands Reverse Shell",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Socat Encrypted Bind Shell",
      "description": "Detects common commands used to create an encrypted shell with Socat.",
      "text": "process.command_line contains 'socat' AND process.command_line contains 'OPENSSL-LISTEN' AND process.command_line contains 'cert' AND process.command_line contains 'verify' AND process.command_line contains 'fork' AND process.command_line contains 'sh'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Socat Encrypted Bind Shell",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Socat Encrypted Reverse Shell",
      "description": "Detects common commands used to create an encrypted shell with Socat.",
      "text": "process.command_line contains 'socat' AND process.command_line contains 'OPENSSL' AND process.command_line contains 'verify' AND process.command_line contains 'EXEC' AND process.command_line contains 'sh'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Socat Encrypted Reverse Shell",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Socat Login Shell",
      "description": "Detects common commands used to create a login shell with socat.",
      "text": "process.command_line contains 'socat' AND process.command_line contains 'tcp-l' AND process.command_line contains 'reuseaddr' AND process.command_line contains 'fork' AND process.command_line contains 'exec' AND process.command_line contains 'login' AND process.command_line contains 'pty' AND process.command_line contains 'setsid' AND process.command_line contains 'setpgid' AND process.command_line contains 'stderr' AND process.command_line contains 'ctty'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Socat Login Shell",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Socat Proxy",
      "description": "Detects common commands that are used to proxy using socat.",
      "text": "process.command_line contains 'socat' AND process.command_line contains 'UNIX-LISTEN' AND process.command_line contains 'reuseaddr' AND process.command_line contains 'fork' AND process.command_line contains 'PROXY'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Socat Proxy",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Socat SCTP Shell",
      "description": "Detects common commands that are used to create an SCTP shell with socat.",
      "text": "process.command_line contains 'socat' AND process.command_line contains 'SCTP-Listen' AND process.command_line contains 'fork' AND process.command_line contains 'EXEC' AND process.command_line contains 'sh'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Socat SCTP Shell",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Socat SSH SOCKS5 Proxy Tunnel",
      "description": "Detects common commands that are used to ssh through a socks5 proxy tunnel using socat.",
      "text": "process.path ends with 'ssh' AND process.command_line contains 'socat' AND process.command_line contains 'ProxyCommand' AND process.command_line contains 'socksport'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Socat SSH SOCKS5 Proxy Tunnel",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Socat TCP Shell",
      "description": "Detects common commands that are used to create an TCP shell with socat.",
      "text": "process.command_line contains 'socat' AND process.command_line contains 'TCP4-Listen' AND process.command_line contains 'fork' AND process.command_line contains 'EXEC' AND process.command_line contains 'sh'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Socat TCP Shell",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Socat UDP Shell",
      "description": "Detects common commands that are used to create a UDP shell with socat.",
      "text": "process.command_line contains 'socat' AND process.command_line contains 'UDP-Listen' AND process.command_line contains 'fork' AND process.command_line contains 'EXEC' AND process.command_line contains 'sh'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Socat UDP Shell",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Spooler Service Creating or Spawning Executables",
      "description": "Detects when the Windows Spooler Service process launches another process or creates an executable.",
      "text": "(process.path ends with '\\\\spoolsv.exe' AND group(file.operation is 'create' AND file.path ends with '.exe')) OR (process.parent_path ends with '\\\\spoolsv.exe' AND process.path ends with '.exe' AND process.path ends with NOT 'werfault.exe' AND (process.path ends with NOT '\\\\regsvr32.exe' OR process.command_line contains NOT 'spool\\\\drivers'))",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Spooler Service Creating or Spawning Executables",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            }
          ]
        }
      }
    },
    {
      "name": "Suspicious HTA Execution",
      "description": "Detects when rundll32 calls OpenURL as a trampoline for executing HTA files.",
      "text": "(process.path contains 'mshta.exe' AND process.command_line contains '-embedding') OR (process.parent_path ends with 'rundll32.exe' AND process.path ends with 'mshta.exe') OR ((process.path ends with '\\\\rundll32.exe' OR process.path ends with '\\\\mshta.exe') AND process.command_line contains '.hta')",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1170",
            "name": "Mshta"
          },
          {
            "id": "T1085",
            "name": "Rundll32"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Suspicious HTA Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1170",
              "name": "Mshta"
            },
            {
              "id": "T1085",
              "name": "Rundll32"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.005",
              "name": "Signed Binary Proxy Execution: Mshta"
            },
            {
              "id": "T1218.011",
              "name": "Signed Binary Proxy Execution: Rundll32"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Suspicious JavaScript Execution",
      "description": "Detects usage of the RUNDLL32.EXE or MSHTA.EXE utilities to execute JavaScript. Often used by \"fileless\" malware to dynamically pass and execute code at runtime.",
      "text": "(process.path ends with 'rundll32.exe' OR process.path contains 'mshta.exe') AND process.command_line contains 'javascript:'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1170",
            "name": "Mshta"
          },
          {
            "id": "T1085",
            "name": "Rundll32"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Suspicious JavaScript Execution",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1170",
              "name": "Mshta"
            },
            {
              "id": "T1085",
              "name": "Rundll32"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.005",
              "name": "Signed Binary Proxy Execution: Mshta"
            },
            {
              "id": "T1218.011",
              "name": "Signed Binary Proxy Execution: Rundll32"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1059.007",
              "name": "Command and Scripting Interpreter: JavaScript"
            }
          ]
        }
      }
    },
    {
      "name": "Suspicious NTDSUtil Execution",
      "description": "Detects the use of NTDSUtil to create a full backup of the ntds.dit file which along with the acquisition of the SYSTEM and SECURITY hives can be used to extract the password hashes offline.",
      "text": "process.path contains 'ntdsutil' AND ((process.command_line contains 'ntds' AND (process.command_line contains 'activate' OR process.command_line contains 'ac') AND (process.command_line contains 'instance' OR process.command_line contains 'in') AND (process.command_line contains 'create' OR process.command_line contains 'cr') AND (process.command_line contains 'full' OR process.command_line contains 'fu')) OR group(file.operation is 'create' AND file.path contains 'ntds.dit'))",
      "labels": [
        "Beta",
        "Credential Access",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1003",
            "name": "Credential Dumping"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Suspicious NTDSUtil Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1003",
              "name": "Credential Dumping"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1003",
              "name": "OS Credential Dumping"
            },
            {
              "id": "T1003.003",
              "name": "OS Credential Dumping: NTDS"
            }
          ]
        }
      }
    },
    {
      "name": "Suspicious Network Connections from Windows Processes",
      "description": "Detects uncommon network connections to ports 80 or 443 initiated by native Windows processes that typically do not connect to these ports.",
      "text": "(process.path ends with '\\\\mshta.exe' OR process.path ends with '\\\\regsvr32.exe' OR process.path ends with '\\\\certutil.exe') AND (network.port is '80' OR network.port is '443') AND process.parent_command_line contains NOT '\\\\amazonAssistantService.exe'",
      "labels": [
        "Beta",
        "Command and Control",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1170",
            "name": "Mshta"
          },
          {
            "id": "T1117",
            "name": "Regsvr32"
          },
          {
            "id": "T1085",
            "name": "Rundll32"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Suspicious Network Connections from Windows Processes",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1170",
              "name": "Mshta"
            },
            {
              "id": "T1117",
              "name": "Regsvr32"
            },
            {
              "id": "T1085",
              "name": "Rundll32"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.005",
              "name": "Signed Binary Proxy Execution: Mshta"
            },
            {
              "id": "T1218.010",
              "name": "Signed Binary Proxy Execution: Regsvr32"
            },
            {
              "id": "T1218.011",
              "name": "Signed Binary Proxy Execution: Rundll32"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Suspicious PowerShell Command Line",
      "description": "Detects execution of the PowerShell script interpreter with command line arguments that are often used to load and run malicious code.",
      "text": "((process.path ends with '\\\\powershell.exe' OR process.path ends with '\\\\pwsh.exe') AND (process.command_line contains 'wscript.shell' OR process.command_line contains 'FromBase64String' OR process.command_line contains 'WebRequest' OR process.command_line contains 'Sockets.TCPClient' OR (process.command_line contains 'Webclient' AND process.command_line contains 'http') OR (process.command_line contains 'IO' AND process.command_line contains 'Stream') OR (process.command_line contains 'encoding' AND process.command_line contains 'GetString') OR (process.command_line contains '-com' AND process.command_line contains 'transformNode') OR process.command_line contains 'Assembly.Load' OR process.command_line contains '^')) AND process.parent_path ends with NOT '\\\\Windows Defender Advanced Threat Protection\\\\SenseIR.exe' AND process.parent_path ends with NOT '\\\\QualysAgent.exe'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          },
          {
            "id": "T1140",
            "name": "Deobfuscate/Decode Files or Information"
          },
          {
            "id": "T1027",
            "name": "Obfuscated Files or Information"
          },
          {
            "id": "T1132",
            "name": "Data Encoding"
          },
          {
            "id": "T1001",
            "name": "Data Obfuscation"
          },
          {
            "id": "T1129",
            "name": "Execution through Module Load"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Suspicious PowerShell Command Line",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            },
            {
              "id": "T1140",
              "name": "Deobfuscate/Decode Files or Information"
            },
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            },
            {
              "id": "T1132",
              "name": "Data Encoding"
            },
            {
              "id": "T1001",
              "name": "Data Obfuscation"
            },
            {
              "id": "T1129",
              "name": "Execution through Module Load"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            },
            {
              "id": "T1140",
              "name": "Deobfuscate/Decode Files or Information"
            },
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            },
            {
              "id": "T1132",
              "name": "Data Encoding"
            },
            {
              "id": "T1001",
              "name": "Data Obfuscation"
            },
            {
              "id": "T1129",
              "name": "Shared Modules"
            }
          ]
        }
      }
    },
    {
      "name": "Suspicious PowerShell Command Line Encodeda",
      "description": "Detects execution of the PowerShell script interpreter with undocumented command line and the encodedarguments or encodeda arguments flag encodeda that can be used to obfuscate malicious code.",
      "text": "(process.path ends with '\\\\powershell.exe' OR process.path ends with '\\\\pwsh.exe') AND process.command_line contains 'encodeda'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          },
          {
            "id": "T1027",
            "name": "Obfuscated Files or Information"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Suspicious PowerShell Command Line Encodeda",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            },
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            },
            {
              "id": "T1027",
              "name": "Obfuscated Files or Information"
            }
          ]
        }
      }
    },
    {
      "name": "Suspicious PowerShell Launched by WMI",
      "description": "Detect anomalous execution of PowerShell by the WMI hosting process (WMIPRVSE.EXE). This technique is often utilized in Office macro payloads.",
      "text": "(process.path ends with '\\\\powershell.exe' OR process.path ends with '\\\\pwsh.exe') AND (network.port is '80' OR network.port is '443') AND process.parent_path ends with '\\\\wmiprvse.exe' AND process.parent_command_line contains NOT '\\\\CCM' AND process.command_line contains NOT '\\\\CCM'",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          },
          {
            "id": "T1047",
            "name": "Windows Management Instrumentation"
          },
          {
            "id": "T1105",
            "name": "Remote File Copy"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Suspicious PowerShell Launched by WMI",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            },
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            },
            {
              "id": "T1105",
              "name": "Remote File Copy"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            },
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            },
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            }
          ]
        }
      }
    },
    {
      "name": "Suspicious PowerShell Process Ancestry",
      "description": "Detects execution of the PowerShell script interpreter by atypical parent processes. Office macro malware attacks often employ this technique. The signal looks for PowerShell spawned by the CSCRIPT.EXE, WSCRIPT.EXE, or MSHTA.EXE interpreters, as well as by the Microsoft Word or Excel applications, to cover both direct and indirect execution.",
      "text": "(process.path ends with '\\\\powershell.exe' OR process.path ends with '\\\\pwsh.exe') AND (process.parent_path ends with '\\\\wscript.exe' OR process.parent_path ends with '\\\\cscript.exe' OR process.parent_path ends with '\\\\mshta.exe' OR process.parent_path ends with '\\\\winword.exe' OR process.parent_path ends with '\\\\excel.exe') AND process.parent_command_line contains NOT 'AnyConnect' AND process.command_line contains NOT '\\\\Tanium\\\\Tanium Client\\\\Downloads\\\\Action' AND process.parent_command_line contains NOT '\\\\Tanium\\\\Tanium Client\\\\Patch\\\\'",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1170",
            "name": "Mshta"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Suspicious PowerShell Process Ancestry",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1170",
              "name": "Mshta"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.005",
              "name": "Signed Binary Proxy Execution: Mshta"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Suspicious System Management Automation Image Load",
      "description": "Detects processes loading system.management.automation.dll (powershell) into unusual processes.",
      "text": "image.path contains 'system.management.automation' AND process.path ends with NOT '\\\\mscorsvw.exe' AND process.path ends with NOT '\\\\monitoringhost.exe' AND process.path ends with NOT '\\\\powershell.exe' AND process.path ends with NOT '\\\\powershell_ise.exe' AND process.path ends with NOT '\\\\pwsh.exe' AND process.path ends with NOT '\\\\sdiagnhost.exe' AND process.path ends with NOT '\\\\servermanager.exe' AND process.path ends with NOT '\\\\sqlps.exe' AND process.path ends with NOT '\\\\wsmprovhost.exe' AND process.path ends with NOT '\\\\miiserver.exe' AND process.path ends with NOT '\\\\taniumclient.exe' AND process.path ends with NOT '\\\\taniumcx.exe' AND process.path ends with NOT '\\\\msiexec.exe' AND process.path ends with NOT '\\\\Ssms.exe'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          },
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1129",
            "name": "Execution through Module Load"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Suspicious System Management Automation Image Load",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            },
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1129",
              "name": "Execution through Module Load"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            },
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1055.001",
              "name": "Process Injection: Dynamic-link Library Injection"
            },
            {
              "id": "T1129",
              "name": "Shared Modules"
            }
          ]
        }
      }
    },
    {
      "name": "Suspicious VBScript Execution",
      "description": "Detects usage of the RUNDLL32.EXE or MSHTA.EXE utilities to execute VBScript. Often used by fileless malware to dynamically pass and execute code at runtime.",
      "text": "(process.path ends with 'rundll32.exe' OR process.path ends with 'mshta.exe') AND process.command_line contains 'vbscript:'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1170",
            "name": "Mshta"
          },
          {
            "id": "T1085",
            "name": "Rundll32"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Suspicious VBScript Execution",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1170",
              "name": "Mshta"
            },
            {
              "id": "T1085",
              "name": "Rundll32"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.005",
              "name": "Signed Binary Proxy Execution: Mshta"
            },
            {
              "id": "T1218.011",
              "name": "Signed Binary Proxy Execution: Rundll32"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1059.005",
              "name": "Command and Scripting Interpreter: Visual Basic"
            }
          ]
        }
      }
    },
    {
      "name": "SyncAppVPublishingServer Binary Powershell Execution",
      "description": "Detects the potential misuse of SyncAppVPublishingServer.exe for executing powershell.",
      "text": "process.path ends with '\\\\Syncappvpublishingserver.exe' AND process.command_line contains '\"n;'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 1,
      "id": "SyncAppVPublishingServer Binary Powershell Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "SyncAppVPublishingServer VBS Powershell Execution",
      "description": "Detects the potential misuse of SyncAppVPublishingServer.vbs for executing powershell.",
      "text": "process.command_line contains 'SyncAppvPublishingServer.vbs' AND process.command_line contains '\"n;'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 1,
      "id": "SyncAppVPublishingServer VBS Powershell Execution",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1059.005",
              "name": "Command and Scripting Interpreter: Visual Basic"
            }
          ]
        }
      }
    },
    {
      "name": "SyncAppVPublishingServer VBS Process Execution",
      "description": "Detects the potential misuse of SyncAppVPublishingServer.vbs for executing a binary.",
      "text": "process.command_line contains 'SyncAppvPublishingServer.vbs' AND process.command_line contains 'Start-Process'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 1,
      "id": "SyncAppVPublishingServer VBS Process Execution",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1059.005",
              "name": "Command and Scripting Interpreter: Visual Basic"
            }
          ]
        }
      }
    },
    {
      "name": "TCPDump Commands Privilege Escalation",
      "description": "Detects common commands used with TCPDump to escalate privileges.",
      "text": "process.path ends with 'tcpdump' AND process.command_line contains '-ln' AND process.command_line contains '-i' AND process.command_line contains 'lo' AND process.command_line contains '-W' AND process.command_line contains '-G' AND process.command_line contains '-z'",
      "labels": [
        "Beta",
        "Privilege Escalation",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1068",
            "name": "Exploitation for Privilege Escalation"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "TCPDump Commands Privilege Escalation",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1068",
              "name": "Exploitation for Privilege Escalation"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1068",
              "name": "Exploitation for Privilege Escalation"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "TTY Terminal Spawned via Python",
      "description": "Detects a fully-interactive terminal TTY session that is spawned from Python.",
      "text": "process.command_line contains 'python' AND process.command_line contains 'import pty' AND process.command_line contains 'pty.spawn' AND process.command_line contains 'sh' AND (file.path ends with 'pts' OR file.path ends with 'ptmx')",
      "labels": [
        "Beta",
        "Execution",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "TTY Terminal spawned via Python",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.006",
              "name": "Command and Scripting Interpreter: Python"
            }
          ]
        }
      }
    },
    {
      "name": "Tracer Diagnostics Proxy Execution",
      "description": "Detects when a subprocess is launched from tracer diagnostics, which can be used as a proxy launcher.",
      "text": "process.ancestry_path contains 'tttracer.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Tracer Diagnostics Proxy Execution",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Trusted Developer Utilities Proxy Execution",
      "description": "There are several methods of compiling or executing code that are normally only executed by developers or build systems but also can be used by attackers to evade detection and gain execution.",
      "text": "(process.path ends with '\\\\MSBuild.exe' AND (process.command_line contains '.xml' OR process.command_line contains '.csproj')) OR (process.path ends with '\\\\tracker.exe' AND process.command_line contains '/d') OR ((process.path ends with '\\\\rcsi.exe' OR process.path ends with '\\\\csi.exe') AND process.command_line contains '.csx') OR (process.path ends with '\\\\cdb.exe' AND process.command_line contains '-o') OR process.path ends with '\\\\dnx.exe'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1127",
            "name": "Trusted Developer Utilities"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Trusted Developer Utilities",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1127",
              "name": "Trusted Developer Utilities Proxy Execution"
            },
            {
              "id": "T1127.001",
              "name": "Trusted Developer Utilities Proxy Execution: MSBuild"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Tscon RDP Session Hijack",
      "description": "Detects the execution of tscon.exe as system that can be used to hijack RDP sessions.",
      "text": "process.path ends with '\\\\tscon.exe' AND process.user_name contains 'SYSTEM'",
      "labels": [
        "Beta",
        "Lateral Movement",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Tscon RDP Session Hijack",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1563",
              "name": "Remote Service Session Hijacking"
            },
            {
              "id": "T1563.002",
              "name": "Remote Service Session Hijacking: RDP Hijacking"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "UMWorkerProcess Spawned Processes",
      "description": "This detects processes that are spawned by the UMWorkerProcess.  The UMWorkerProcess does not typically spawn child processes and may be a sign of process injection.",
      "text": "process.ancestry_path ends with '\\\\UMWorkerProcess.exe' AND process.path ends with NOT '\\\\werfault.exe' AND process.path ends with NOT '\\\\wermgr.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "UMWorkerProcess Spawned Processes",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Uncommon INF Script Execution",
      "description": "Detects the uncommon use of INF script execution, which can be used to bypass AppLocker.",
      "text": "(process.path contains 'cmstp.exe' OR process.path contains 'infdefaultinstall.exe') AND process.command_line contains '/s'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1191",
            "name": "CMSTP"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Uncommon INF Script Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1191",
              "name": "CMSTP"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.003",
              "name": "Signed Binary Proxy Execution: CMSTP"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Uncommon RegSvcs & RegAsm Script Execution",
      "description": "Detects the uncommon use of RegSvcs & RegAsm script execution, which can be used to bypass AppLocker.",
      "text": "process.path contains '\\\\Windows\\\\Microsoft.NET\\\\Framework' AND process.command_line contains '.dll' AND (process.path ends with '\\\\RegSvcs.exe' OR process.path ends with '\\\\RegAsm.exe')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          },
          {
            "id": "T1121",
            "name": "Regsvcs/Regasm"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Uncommon RegSvcs & RegAsm Script Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1121",
              "name": "Regsvcs/Regasm"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            },
            {
              "id": "T1218.009",
              "name": "Signed Binary Proxy Execution: Regsvcs/Regasm"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Uncommon SCT Script Execution",
      "description": "Detects the uncommon use of SCT script execution, which can be used to bypass AppLocker.",
      "text": "(process.path ends with '\\\\iexpress.exe' AND process.command_line contains '/n' AND process.command_line contains '.sed') OR ((process.path ends with '\\\\powershell.exe' OR process.path ends with '\\\\pwsh.exe' OR process.path ends with '\\\\mshta.exe' OR process.path ends with '\\\\regsvr32.exe') AND process.command_line contains '.sct') AND process.command_line contains NOT 'tanium.sed'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Uncommon SCT Script Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Uncommon XSL Script Execution",
      "description": "Detects the uncommon use of XSL script execution, which can be used to bypass AppLocker.",
      "text": "((process.path ends with '\\\\msxsl.exe' OR process.path ends with '\\\\powershell.exe' OR process.path ends with '\\\\pwsh.exe') AND process.command_line contains '.xsl' AND process.command_line contains '.xml' ) OR ( process.path ends with '\\\\wmic.exe' AND process.command_line contains 'format:' ) AND process.parent_path ends with NOT '\\\\amazon-ssm-agent.exe' AND process.parent_path ends with NOT '\\\\ssm-document-worker.exe'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1220",
            "name": "XSL Script Processing"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Uncommon XSL Script Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1220",
              "name": "XSL Script Processing"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1220",
              "name": "XSL Script Processing"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Unsigned Process Creating a Binary",
      "description": "Detects an unsigned process creating a binary on disk, which may be a sign of attack activity.",
      "text": "process.signature_status is 'no_signature' AND group(file.operation is 'create' AND file.path ends with '.exe')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Unsigned Process Creating a Binary",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.001",
              "name": "Masquerading: Invalid Code Signature"
            }
          ]
        }
      }
    },
    {
      "name": "Unsigned Process Creating a Driver",
      "description": "Detects an unsigned process creating a driver on disk, which may be a sign of attack activity.",
      "text": "process.signature_status is 'no_signature' AND group(file.operation is 'create' AND file.path ends with '.sys')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Unsigned Process Creating a Driver",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.001",
              "name": "Masquerading: Invalid Code Signature"
            }
          ]
        }
      }
    },
    {
      "name": "Unsigned Process Creating a Library",
      "description": "Detects an unsigned process creating a dynamic-link library on disk, which may be a sign of attack activity.",
      "text": "process.signature_status is 'no_signature' AND group(file.operation is 'create' AND file.path ends with '.dll')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Unsigned Process Creating a Library",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.001",
              "name": "Masquerading: Invalid Code Signature"
            }
          ]
        }
      }
    },
    {
      "name": "Unsigned Process Creating a PowerShell Script",
      "description": "Detects an unsigned process creating a PowerShell script file, which may be a sign of attack activity.",
      "text": "process.signature_status is 'no_signature' AND group(file.operation is 'create' AND file.path ends with '.ps1')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1086",
            "name": "PowerShell"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Unsigned Process Creating a PowerShell Script",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1086",
              "name": "PowerShell"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.001",
              "name": "Masquerading: Invalid Code Signature"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.001",
              "name": "Command and Scripting Interpreter: PowerShell"
            }
          ]
        }
      }
    },
    {
      "name": "Unsigned Process Modifying Files in Windows Directory",
      "description": "Detects an unsigned processes modifying files in the windows system directory, which may be a sign of attack activity.",
      "text": "process.signature_status is 'no_signature' AND file.path contains ':\\\\windows\\\\'",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Unsigned Process Modifying Files in Windows Directory",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.001",
              "name": "Masquerading: Invalid Code Signature"
            }
          ]
        }
      }
    },
    {
      "name": "User Added to Local Administrators",
      "description": "Detects usage of NET.EXE to add an account to the local Administrator users group.",
      "text": "(process.path ends with '\\\\net.exe' OR process.path ends with '\\\\net1.exe') AND process.command_line contains 'localgroup administrators' AND process.command_line contains '/add' AND process.parent_command_line contains NOT 'windows\\\\ccmcache' AND process.parent_path contains NOT 'windows\\\\ccmcache' AND process.parent_command_line contains NOT '\\\\SupportAssist' AND process.parent_path contains NOT 'SupportAssist'",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1136",
            "name": "Create Account"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "User Added to Local Administrators",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1136",
              "name": "Create Account"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1136",
              "name": "Create Account"
            },
            {
              "id": "T1136.001",
              "name": "Create Account: Local Account"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Vim Launching an Executable from the Command Line",
      "description": "Detects the potential use of vim to proxy another command. This can be used to breakout of restricted environments.",
      "text": "process.path ends with '/vim' and process.command_line contains '-c' and process.command_line contains ':!'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Vim Launching an Executable from the Command Line",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Vim Launching lua from the Command Line",
      "description": "Detects the potential use of vim to proxy another command. This can be used to breakout of restricted environments.",
      "text": "process.path ends with '/vim' and process.command_line contains '-c' and process.command_line contains ':lua'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Vim Launching lua from the Command Line",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Vim Launching python from the Command Line",
      "description": "Detects the potential use of vim to proxy another command. This can be used to breakout of restricted environments.",
      "text": "process.path ends with '/vim' and process.command_line contains '-c' and process.command_line contains ':py'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Vim Launching python from the Command Line",
      "modification-date": "2021-02-22T19:02:31.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Volume Shadow Copy Deletion",
      "description": "Detects usage of the VSSADMIN.EXE or WMIC.EXE utilities to delete Volume Shadow Copies. Often used by ransomware to eliminate backed-up data, as well as by targeted attackers seeking to destroy evidence of prior activity.",
      "text": "(process.path ends with 'wmic.exe' OR process.path ends with 'vssadmin.exe') AND process.command_line contains 'delete' AND process.command_line contains 'shadow'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1490",
            "name": "Inhibit System Recovery"
          },
          {
            "id": "T1047",
            "name": "Windows Management Instrumentation"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1485",
            "name": "Data Destruction"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Volume Shadow Copy Deletion",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1485",
              "name": "Data Destruction"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1485",
              "name": "Data Destruction"
            }
          ]
        }
      }
    },
    {
      "name": "Vssadmin Resize Volume Shadow Copy",
      "description": "Detects usage of the VSssadmin.exe to resize the Volume Shadow Copies. This technique has been seen in ransomware to force deletion of shadow copies to eliminate backed-up data, as well as by attackers seeking to destroy evidence of prior activity.",
      "text": "process.path ends with 'vssadmin.exe' AND process.command_line contains 'resize' AND process.command_line contains 'shadowstorage'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1490",
            "name": "Inhibit System Recovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1485",
            "name": "Data Destruction"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Vssadmin Resize Volume Shadow Copy",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1485",
              "name": "Data Destruction"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1485",
              "name": "Data Destruction"
            }
          ]
        }
      }
    },
    {
      "name": "WMI Managed Object Format Execution",
      "description": "Windows managed object format can be used to create common information model classes which are compiled with mofcomp.exe. Attackers can use MOF files to configure backdoor persistence on systems.",
      "text": "process.path ends with '\\\\mofcomp.exe' AND process.command_line contains '.mof' AND process.parent_path ends with NOT 'MsMpEng.exe' AND process.command_line contains NOT '\\\\Windows Defender\\\\'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1047",
            "name": "Windows Management Instrumentation"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "WMI Managed Object Format Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "WMIC Antivirus Discovery",
      "description": "Detects the use of WMI to find antivirus providers on the host.",
      "text": "process.path ends with '\\\\wmic.exe' AND process.command_line contains 'AntivirusProduct'",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1518",
            "name": "Software Discovery"
          },
          {
            "id": "T1063",
            "name": "Security Software Discovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1047",
            "name": "Windows Management Instrumentation"
          }
        ]
      },
      "syntax_version": 1,
      "id": "WMIC Antivirus Discovery",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1518",
              "name": "Software Discovery"
            },
            {
              "id": "T1063",
              "name": "Security Software Discovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1518",
              "name": "Software Discovery"
            },
            {
              "id": "T1518.001",
              "name": "Software Discovery: Security Software Discovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            }
          ]
        }
      }
    },
    {
      "name": "WMIC Process Creation",
      "description": "Detects usage of the WMIC.EXE command line utility to create a process. Often used for remote process execution or to disguise a locally-executed process' ancestry.",
      "text": "process.path ends with 'wmic.exe' AND process.command_line contains 'process' AND process.command_line contains 'call' AND process.command_line contains 'create' AND process.parent_path contains NOT 'TaniumClientDeploy'",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1047",
            "name": "Windows Management Instrumentation"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "WMIC Process Creation",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "WSL OpenSSL Commands Download",
      "description": "Detects the use of openssl to download potentially suspect content by leveraging the bash.exe binary.",
      "text": "process.path ends with '\\\\bash.exe' AND process.command_line contains 'openssl' AND process.command_line contains 's_client' AND process.command_line contains 'quiet' AND process.command_line contains 'connect'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1105",
            "name": "Remote File Copy"
          }
        ]
      },
      "syntax_version": 1,
      "id": "WSL OpenSSL Commands Download",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1105",
              "name": "Remote File Copy"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            }
          ]
        }
      }
    },
    {
      "name": "WSL Socat Commands Reverse Shell",
      "description": "Detects common commands used to create a shell with Socat using wsl.exe on Windows.",
      "text": "process.path ends with '\\\\wsl.exe' AND process.command_line contains 'socat' AND process.command_line contains 'tcp-connect' AND process.command_line contains 'exec' AND process.command_line contains 'sh' AND process.command_line contains 'pty' AND process.command_line contains 'setsid' AND process.command_line contains 'sane'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 1,
      "id": "WSL Socat Commands Reverse Shell",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    },
    {
      "name": "Wbadmin Catalog Deletion",
      "description": "Detects usage of wbadmin.exe to delete the system state backup. Often used by ransomware to eliminate backed-up data, and by targeted attackers seeking to destroy evidence of prior activity.",
      "text": "process.path ends with '\\\\wbadmin.exe' AND process.command_line contains 'systemstatebackup' AND process.command_line contains 'delete'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1490",
            "name": "Inhibit System Recovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1485",
            "name": "Data Destruction"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Wbadmin Catalog Deletion",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1485",
              "name": "Data Destruction"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1485",
              "name": "Data Destruction"
            }
          ]
        }
      }
    },
    {
      "name": "Wbadmin System State Backup Deletion",
      "description": "Detects usage of wbadmin.exe to delete the system state backup. Often used by ransomware to eliminate backed-up data, and by targeted attackers seeking to destroy evidence of prior activity.",
      "text": "process.path ends with '\\\\wbadmin.exe' AND process.command_line contains 'systemstatebackup' AND process.command_line contains 'delete'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1490",
            "name": "Inhibit System Recovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1485",
            "name": "Data Destruction"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Wbadmin System State Backup Deletion",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1485",
              "name": "Data Destruction"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1490",
              "name": "Inhibit System Recovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1485",
              "name": "Data Destruction"
            }
          ]
        }
      }
    },
    {
      "name": "Werfault with Suspicious Command Invocation",
      "description": "Detects the execution of werfault.exe with suspicious command arguments such as no pid that called it. This can be indicative of a malicious execution of the process.",
      "text": "process.path ends with '\\\\werfault.exe' AND process.command_line contains NOT '-u -p' AND process.command_line contains NOT '-k -lcq' AND process.command_line contains NOT 'shared Global' AND process.command_line contains NOT '-pss' AND process.command_line contains NOT '.dmp'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1055",
            "name": "Process Injection"
          },
          {
            "id": "T1093",
            "name": "Process Hollowing"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Werfault with Suspicious Command Invocation",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1093",
              "name": "Process Hollowing"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1055",
              "name": "Process Injection"
            },
            {
              "id": "T1055.012",
              "name": "Process Injection: Process Hollowing"
            }
          ]
        }
      }
    },
    {
      "name": "Whois Commands Exfiltration",
      "description": "Detects common commands that are used to exfiltrate data using whois.",
      "text": "process.path ends with 'whois.md' AND process.command_line contains '-h' AND process.command_line contains '-p'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux"
      ],
      "platforms": [
        "linux"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1041",
            "name": "Exfiltration Over Command and Control Channel"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Whois Commands Exfiltration",
      "modification-date": "2020-12-07T16:58:55.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over Command and Control Channel"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1041",
              "name": "Exfiltration Over C2 Channel"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Accessibility Binary Replacement AtBroker",
      "description": "Detects the replacement of AtBroker to bypass logon accessibility features and maintain persistence.",
      "text": "group(file.operation is 'create' AND file.path contains '\\\\system32\\\\atbroker.exe')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Windows Accessibility Binary Replacement AtBroker",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Accessibility Binary Replacement DisplaySwitch",
      "description": "Detects the replacement of DisplaySwitch to bypass logon accessibility features and maintain persistence.",
      "text": "group(file.operation is 'create' AND file.path contains '\\\\system32\\\\displayswitch.exe')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Windows Accessibility Binary Replacement DisplaySwitch",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Accessibility Binary Replacement Magnify",
      "description": "Detects the replacement of Magnify to bypass logon accessibility features and maintain persistence.",
      "text": "group(file.operation is 'create' AND file.path contains '\\\\system32\\\\magnify.exe')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Windows Accessibility Binary Replacement Magnify",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Accessibility Binary Replacement Narrator",
      "description": "Detects the replacement of Narrator to bypass logon accessibility features and maintain persistence.",
      "text": "group(file.operation is 'create' AND file.path contains '\\\\system32\\\\narrator.exe')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Windows Accessibility Binary Replacement Narrator",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Accessibility Binary Replacement Osk",
      "description": "Detects the replacement of Osk to bypass logon accessibility features and maintain persistence.",
      "text": "group(file.operation is 'create' AND file.path contains '\\\\system32\\\\osk.exe')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Windows Accessibility Binary Replacement Osk",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Accessibility Binary Replacement Sethc",
      "description": "Detects the replacement of Sethc to bypass logon accessibility features and maintain persistence.",
      "text": "group(file.operation is 'create' AND file.path contains '\\\\system32\\\\sethc.exe')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Windows Accessibility Binary Replacement Sethc",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Accessibility Binary Replacement Utilman",
      "description": "Detects the replacement of Utilman to bypass logon accessibility features and maintain persistence.",
      "text": "group(file.operation is 'create' AND file.path contains '\\\\system32\\\\utilman.exe')",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          },
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Windows Accessibility Binary Replacement Utilman",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            },
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Accessibility Logon Bypasses",
      "description": "Detects the use of logon accessibility features to bypass logon and maintain persistence.",
      "text": "group( registry.key_path contains 'Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Accessibility\\\\ATs' AND registry.value_name is 'StartExe' )",
      "labels": [
        "Beta",
        "Persistence",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1015",
            "name": "Accessibility Features"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Windows Accessibility Logon Bypasses",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1015",
              "name": "Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1546",
              "name": "Event Triggered Execution"
            },
            {
              "id": "T1546.008",
              "name": "Event Triggered Execution: Accessibility Features"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Address Book Search Order Hijack",
      "description": "Detects the loading of the wab32.dll library from an uncommon path.",
      "text": "group(image.path ends with '\\\\wab32.dll' AND image.path contains NOT '\\\\Program Files\\\\Common Files\\\\System\\\\' AND image.path contains NOT '\\\\Program Files (x86)\\\\Common Files\\\\System\\\\' AND image.path contains NOT '\\\\Windows\\\\WinSxS\\\\')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1038",
            "name": "DLL Search Order Hijacking"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Windows Address Book Search Order Hijack",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1038",
              "name": "DLL Search Order Hijacking"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1574",
              "name": "Hijack Execution Flow"
            },
            {
              "id": "T1574.001",
              "name": "Hijack Execution Flow: DLL Search Order Hijacking"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Certificate Utility Misuse",
      "description": "Detects use of the Windows native utility CERTUTIL.EXE to download a file via HTTP, or to decode an encoded file into a binary.",
      "text": "process.path ends with 'certutil.exe' AND (process.command_line contains 'decode' OR process.command_line contains 'encode' OR process.command_line contains 'urlcache' OR process.command_line contains 'split')",
      "labels": [
        "Beta",
        "Command and Control",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1140",
            "name": "Deobfuscate/Decode Files or Information"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Windows Certificate Utility Misuse",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1140",
              "name": "Deobfuscate/Decode Files or Information"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1140",
              "name": "Deobfuscate/Decode Files or Information"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Defender Exclude EXE",
      "description": "Detects the modification of the Windows Defender exclusions to include all executables ending in exe.",
      "text": "group(registry.key_path contains '\\\\Windows Defender\\\\Exclusions\\\\Extensions' AND registry.value_name contains 'exe')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1089",
            "name": "Disabling Security Tools"
          },
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Windows Defender Exclude EXE",
      "modification-date": "2021-04-26T17:13:36.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1089",
              "name": "Disabling Security Tools"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.001",
              "name": "Impair Defenses: Disable or Modify Tools"
            },
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Defender File Download",
      "description": "Detects use of the Windows Defender to download a file.",
      "text": "process.path ends with '\\\\MpCmdRun.exe' AND process.command_line contains 'url' AND process.command_line contains 'path' AND process.command_line contains ':\\\\'",
      "labels": [
        "Beta",
        "Command and Control",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Windows Defender File Download",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Event Logs Cleared",
      "description": "Detects use of command line utilities to clear the Windows event logs.",
      "text": "(process.path ends with '\\\\wevtutil.exe' AND process.command_line contains ' cl ') OR (process.path ends with '\\\\wmic.exe' AND process.command_line contains 'cleareventlog') OR ((process.path ends with '\\\\powershell.exe' OR process.path ends with '\\\\pwsh.exe') AND (process.command_line contains 'Clear-EventLog' OR process.command_line contains 'Remove-EventLog'))",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1070",
            "name": "Indicator Removal on Host"
          },
          {
            "id": "T1047",
            "name": "Windows Management Instrumentation"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Windows Event Logs Cleared",
      "modification-date": "2020-10-13T19:31:33.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1070",
              "name": "Indicator Removal on Host"
            },
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1070",
              "name": "Indicator Removal on Host"
            },
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Firewall Disabled",
      "description": "Detects use of the Windows utility NETSH.EXE to disable the Windows firewall.",
      "text": "(process.path ends with 'netsh.exe' AND process.command_line contains 'advfirewall' AND process.command_line contains 'off') OR (process.path ends with 'netsh.exe' AND process.command_line contains 'firewall' AND process.command_line contains 'disable')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1047",
            "name": "Windows Management Instrumentation"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Windows Firewall Disabled",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1562",
              "name": "Impair Defenses"
            },
            {
              "id": "T1562.004",
              "name": "Impair Defenses: Disable or Modify System Firewall"
            },
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Remote Shell Command Execution",
      "description": "Detects the use of Windows Remote Shell on a host.",
      "text": "process.parent_path ends with '\\\\winrshost.exe' AND process.path ends with '\\\\cmd.exe'",
      "labels": [
        "Beta",
        "Execution",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1047",
            "name": "Windows Management Instrumentation"
          }
        ]
      },
      "syntax_version": 1,
      "id": "Windows Remote Shell Command Execution",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1047",
              "name": "Windows Management Instrumentation"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Session Enumeration pipelsarpc",
      "description": "Detects artifacts related to windows session enumeration used by tools such as Bloodhound to collect information on user sessions.",
      "text": "network.port is '445' AND group( file.operation is 'write' AND file.path ends with '\\\\pipe\\\\lsarpc' )",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1033",
            "name": "System Owner/User Discovery"
          },
          {
            "id": "T1087",
            "name": "Account Discovery"
          },
          {
            "id": "T1069",
            "name": "Permission Groups Discovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Windows Session Enumeration pipelsarpc",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1033",
              "name": "System Owner/User Discovery"
            },
            {
              "id": "T1087",
              "name": "Account Discovery"
            },
            {
              "id": "T1069",
              "name": "Permission Groups Discovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1033",
              "name": "System Owner/User Discovery"
            },
            {
              "id": "T1087",
              "name": "Account Discovery"
            },
            {
              "id": "T1087.001",
              "name": "Account Discovery: Local Account"
            },
            {
              "id": "T1087.002",
              "name": "Account Discovery: Domain Account"
            },
            {
              "id": "T1087.003",
              "name": "Account Discovery: Email Account"
            },
            {
              "id": "T1069.001",
              "name": "Permission Groups Discovery: Local Groups"
            },
            {
              "id": "T1069.002",
              "name": "Permission Groups Discovery: Domain Groups"
            },
            {
              "id": "T1069",
              "name": "Permission Groups Discovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Session Enumeration pipesamr",
      "description": "Detects artifacts related to windows session enumeration used by tools such as Bloodhound to collect information on user sessions.",
      "text": "network.port is '445' AND group( file.operation is 'write' AND file.path ends with '\\\\pipe\\\\samr' )",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1033",
            "name": "System Owner/User Discovery"
          },
          {
            "id": "T1087",
            "name": "Account Discovery"
          },
          {
            "id": "T1069",
            "name": "Permission Groups Discovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Windows Session Enumeration pipesamr",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1033",
              "name": "System Owner/User Discovery"
            },
            {
              "id": "T1087",
              "name": "Account Discovery"
            },
            {
              "id": "T1069",
              "name": "Permission Groups Discovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1033",
              "name": "System Owner/User Discovery"
            },
            {
              "id": "T1087",
              "name": "Account Discovery"
            },
            {
              "id": "T1087.001",
              "name": "Account Discovery: Local Account"
            },
            {
              "id": "T1087.002",
              "name": "Account Discovery: Domain Account"
            },
            {
              "id": "T1087.003",
              "name": "Account Discovery: Email Account"
            },
            {
              "id": "T1069.001",
              "name": "Permission Groups Discovery: Local Groups"
            },
            {
              "id": "T1069.002",
              "name": "Permission Groups Discovery: Domain Groups"
            },
            {
              "id": "T1069",
              "name": "Permission Groups Discovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Session Enumeration pipesvcctl",
      "description": "Detects artifacts related to windows session enumeration used by tools such as Bloodhound to collect information on user sessions.",
      "text": "network.port is '445' AND group( file.operation is 'write' AND file.path ends with '\\\\pipe\\\\svcctl' )",
      "labels": [
        "Beta",
        "Discovery",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1033",
            "name": "System Owner/User Discovery"
          },
          {
            "id": "T1087",
            "name": "Account Discovery"
          },
          {
            "id": "T1069",
            "name": "Permission Groups Discovery"
          },
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Windows Session Enumeration pipesvcctl",
      "modification-date": "2021-03-29T19:18:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1033",
              "name": "System Owner/User Discovery"
            },
            {
              "id": "T1087",
              "name": "Account Discovery"
            },
            {
              "id": "T1069",
              "name": "Permission Groups Discovery"
            },
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1033",
              "name": "System Owner/User Discovery"
            },
            {
              "id": "T1087",
              "name": "Account Discovery"
            },
            {
              "id": "T1087.001",
              "name": "Account Discovery: Local Account"
            },
            {
              "id": "T1087.002",
              "name": "Account Discovery: Domain Account"
            },
            {
              "id": "T1087.003",
              "name": "Account Discovery: Email Account"
            },
            {
              "id": "T1069.001",
              "name": "Permission Groups Discovery: Local Groups"
            },
            {
              "id": "T1069.002",
              "name": "Permission Groups Discovery: Domain Groups"
            },
            {
              "id": "T1069",
              "name": "Permission Groups Discovery"
            },
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            }
          ]
        }
      }
    },
    {
      "name": "Windows Telemetry Control Monitoring",
      "description": "The Telemetry Control monitoring subsystem in Windows is designed to be extensible via the registry.  By registering a new subkey of HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\AppCompatFlags\\TelemetryController it executes any command line put in the command value.",
      "text": "group(registry.key_path contains '\\\\SOFTWARE\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\AppCompatFlags\\\\TelemetryController' AND registry.value_name is 'Command')",
      "labels": [
        "Beta",
        "Persistence",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1112",
            "name": "Modify Registry"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Windows Telemetry Control Monitoring",
      "modification-date": "2021-05-24T15:20:29.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1112",
              "name": "Modify Registry"
            }
          ]
        }
      }
    },
    {
      "name": "Wininit Running as not System",
      "description": "Detects when wininit.exe is running as something other than the system user, which could indicate attacker activity.",
      "text": "process.path ends with '\\\\wininit.exe' AND process.user_name is NOT 'SYSTEM'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1036",
            "name": "Masquerading"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Wininit Running as not System",
      "modification-date": "2020-11-23T19:56:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1036",
              "name": "Masquerading"
            },
            {
              "id": "T1036.005",
              "name": "Masquerading: Match Legitimate Name or Location"
            }
          ]
        }
      }
    },
    {
      "name": "Word Spawned Connection to Port 443",
      "description": "Detects the connection to port 443 by a descendent process of Word which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\winword.exe' AND process.path ends with NOT '\\\\winword.exe' AND network.port is '443'",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Word Spawned Connection to Port 443",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Word Spawned Connection to Port 80",
      "description": "Detects the connection to port 80 by a descendent process of Word which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\winword.exe' AND process.path ends with NOT '\\\\winword.exe' AND network.port is '80'",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1008",
            "name": "Fallback Channels"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Word Spawned Connection to Port 80",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1008",
              "name": "Fallback Channels"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Word Spawned Process Creating BAT Files",
      "description": "Detects the creation of BAT files by Word or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\winword.exe' AND group(file.operation is 'create' AND file.path ends with '.bat')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Word Spawned Process Creating BAT Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Word Spawned Process Creating CMD Files",
      "description": "Detects the creation of CMD files by Word or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\winword.exe' AND group(file.operation is 'create' AND file.path ends with '.cmd')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Word Spawned Process Creating CMD Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Word Spawned Process Creating DLL Files",
      "description": "Detects the creation of DLL files by Word or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\winword.exe' AND group(file.operation is 'create' AND file.path ends with '.dll')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Word Spawned Process Creating DLL Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Word Spawned Process Creating EXE Files",
      "description": "Detects the creation of EXE files by Word or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\winword.exe' AND group(file.operation is 'create' AND file.path ends with '.exe')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Word Spawned Process Creating EXE Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Word Spawned Process Creating PS1 Files",
      "description": "Detects the creation of PS1 files by Word or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\winword.exe' AND group(file.operation is 'create' AND file.path ends with '.ps1')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Word Spawned Process Creating PS1 Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Word Spawned Process Creating SYS Files",
      "description": "Detects the creation of SYS files by Word or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\winword.exe' AND group(file.operation is 'create' AND file.path ends with '.sys')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Word Spawned Process Creating SYS Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "Word Spawned Process Creating VBS Files",
      "description": "Detects the creation of VBS files by Word or a descendent process which may be a sign of attack activity.",
      "text": "process.ancestry_path ends with '\\\\winword.exe' AND group(file.operation is 'create' AND file.path ends with '.vbs')",
      "labels": [
        "Beta",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1204",
            "name": "User Execution"
          }
        ]
      },
      "syntax_version": 4,
      "id": "Word Spawned Process Creating VBS Files",
      "modification-date": "2020-10-19T22:00:24.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.005",
              "name": "Command and Scripting Interpreter: Visual Basic"
            },
            {
              "id": "T1204",
              "name": "User Execution"
            },
            {
              "id": "T1204.002",
              "name": "User Execution: Malicious File"
            }
          ]
        }
      }
    },
    {
      "name": "XWizard Proxy Download",
      "description": "Detects the use of XWizard.exe to proxy a download. This can be used as an AppLocker bypass to download attacker binaries.",
      "text": "process.path ends with '\\\\xwizard.exe' AND process.command_line contains 'Runwizard' AND process.command_line contains '/z' AND process.command_line contains 'http'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1105",
            "name": "Remote File Copy"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "XWizard Proxy Download",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1105",
              "name": "Remote File Copy"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1105",
              "name": "Ingress Tool Transfer"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        }
      }
    },
    {
      "name": "XWizard Proxy Execution",
      "description": "Detects the use of XWizard.exe for a potential proxy execution. This can be used as an AppLocker bypass or to execute arbitrary binaries.",
      "text": "process.path ends with '\\\\xwizard.exe' AND process.command_line contains 'Runwizard' AND process.command_line contains '/taero' AND process.command_line contains '/u'",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Execution",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1218",
            "name": "Signed Binary Proxy Execution"
          }
        ]
      },
      "syntax_version": 1,
      "id": "XWizard Proxy Execution",
      "modification-date": "2021-01-21T15:28:25.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.003",
              "name": "Command and Scripting Interpreter: Windows Command Shell"
            },
            {
              "id": "T1218",
              "name": "Signed Binary Proxy Execution"
            }
          ]
        }
      }
    },
    {
      "name": "Zone Identifier ADS Deletion",
      "description": "Detects deletion of Zone Identifier ADS files that may be related to attacker actvity to cover their tracks.",
      "text": "group(file.path ends with ':Zone.Identifier' AND file.operation is 'delete')",
      "labels": [
        "Beta",
        "Defense Evasion",
        "Windows"
      ],
      "platforms": [
        "windows"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1070",
            "name": "Indicator Removal on Host"
          },
          {
            "id": "T1107",
            "name": "File Deletion"
          }
        ]
      },
      "syntax_version": 2,
      "id": "Zone Identifier ADS Deletion",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1070",
              "name": "Indicator Removal on Host"
            },
            {
              "id": "T1107",
              "name": "File Deletion"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1070",
              "name": "Indicator Removal on Host"
            },
            {
              "id": "T1070.004",
              "name": "Indicator Removal on Host: File Deletion"
            }
          ]
        }
      }
    },
    {
      "name": "Zsh Commands Reverse Shell",
      "description": "Detects common commands used to create a reverse shell with zsh.",
      "text": "process.path ends with 'zsh' AND process.command_line contains 'zmodload' AND process.command_line contains 'net' AND process.command_line contains 'tcp' AND process.command_line contains 'REPLY'",
      "labels": [
        "Beta",
        "Command and Control",
        "Exfiltration",
        "Defense Evasion",
        "Linux",
        "Mac"
      ],
      "platforms": [
        "linux",
        "mac"
      ],
      "mitreAttack": {
        "techniques": [
          {
            "id": "T1059",
            "name": "Command-Line Interface"
          },
          {
            "id": "T1064",
            "name": "Scripting"
          },
          {
            "id": "T1008",
            "name": "Fallback Channels"
          }
        ]
      },
      "syntax_version": 3,
      "id": "Zsh Commands Reverse Shell",
      "modification-date": "2020-10-16T21:16:45.000Z",
      "mitreAttacks": {
        "v6": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command-Line Interface"
            },
            {
              "id": "T1064",
              "name": "Scripting"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        },
        "v7": {
          "techniques": [
            {
              "id": "T1059",
              "name": "Command and Scripting Interpreter"
            },
            {
              "id": "T1059.004",
              "name": "Command and Scripting Interpreter: Unix Shell"
            },
            {
              "id": "T1008",
              "name": "Fallback Channels"
            }
          ]
        }
      }
    }
  ],
  "mitreTechniques": {
    "v6": [
      {
        "id": "T1156",
        "name": ".bash_profile and .bashrc"
      },
      {
        "id": "T1134",
        "name": "Access Token Manipulation"
      },
      {
        "id": "T1015",
        "name": "Accessibility Features"
      },
      {
        "id": "T1531",
        "name": "Account Access Removal"
      },
      {
        "id": "T1087",
        "name": "Account Discovery"
      },
      {
        "id": "T1098",
        "name": "Account Manipulation"
      },
      {
        "id": "T1182",
        "name": "AppCert DLLs"
      },
      {
        "id": "T1103",
        "name": "AppInit DLLs"
      },
      {
        "id": "T1155",
        "name": "AppleScript"
      },
      {
        "id": "T1527",
        "name": "Application Access Token"
      },
      {
        "id": "T1017",
        "name": "Application Deployment Software"
      },
      {
        "id": "T1138",
        "name": "Application Shimming"
      },
      {
        "id": "T1010",
        "name": "Application Window Discovery"
      },
      {
        "id": "T1123",
        "name": "Audio Capture"
      },
      {
        "id": "T1131",
        "name": "Authentication Package"
      },
      {
        "id": "T1119",
        "name": "Automated Collection"
      },
      {
        "id": "T1020",
        "name": "Automated Exfiltration"
      },
      {
        "id": "T1197",
        "name": "BITS Jobs"
      },
      {
        "id": "T1139",
        "name": "Bash History"
      },
      {
        "id": "T1009",
        "name": "Binary Padding"
      },
      {
        "id": "T1067",
        "name": "Bootkit"
      },
      {
        "id": "T1217",
        "name": "Browser Bookmark Discovery"
      },
      {
        "id": "T1176",
        "name": "Browser Extensions"
      },
      {
        "id": "T1110",
        "name": "Brute Force"
      },
      {
        "id": "T1088",
        "name": "Bypass User Account Control"
      },
      {
        "id": "T1191",
        "name": "CMSTP"
      },
      {
        "id": "T1042",
        "name": "Change Default File Association"
      },
      {
        "id": "T1146",
        "name": "Clear Command History"
      },
      {
        "id": "T1115",
        "name": "Clipboard Data"
      },
      {
        "id": "T1522",
        "name": "Cloud Instance Metadata API"
      },
      {
        "id": "T1538",
        "name": "Cloud Service Dashboard"
      },
      {
        "id": "T1526",
        "name": "Cloud Service Discovery"
      },
      {
        "id": "T1116",
        "name": "Code Signing"
      },
      {
        "id": "T1059",
        "name": "Command-Line Interface"
      },
      {
        "id": "T1043",
        "name": "Commonly Used Port"
      },
      {
        "id": "T1092",
        "name": "Communication Through Removable Media"
      },
      {
        "id": "T1500",
        "name": "Compile After Delivery"
      },
      {
        "id": "T1223",
        "name": "Compiled HTML File"
      },
      {
        "id": "T1109",
        "name": "Component Firmware"
      },
      {
        "id": "T1122",
        "name": "Component Object Model Hijacking"
      },
      {
        "id": "T1175",
        "name": "Component Object Model and Distributed COM"
      },
      {
        "id": "T1090",
        "name": "Connection Proxy"
      },
      {
        "id": "T1196",
        "name": "Control Panel Items"
      },
      {
        "id": "T1136",
        "name": "Create Account"
      },
      {
        "id": "T1003",
        "name": "Credential Dumping"
      },
      {
        "id": "T1503",
        "name": "Credentials from Web Browsers"
      },
      {
        "id": "T1081",
        "name": "Credentials in Files"
      },
      {
        "id": "T1214",
        "name": "Credentials in Registry"
      },
      {
        "id": "T1094",
        "name": "Custom Command and Control Protocol"
      },
      {
        "id": "T1024",
        "name": "Custom Cryptographic Protocol"
      },
      {
        "id": "T1207",
        "name": "DCShadow"
      },
      {
        "id": "T1038",
        "name": "DLL Search Order Hijacking"
      },
      {
        "id": "T1073",
        "name": "DLL Side-Loading"
      },
      {
        "id": "T1002",
        "name": "Data Compressed"
      },
      {
        "id": "T1485",
        "name": "Data Destruction"
      },
      {
        "id": "T1132",
        "name": "Data Encoding"
      },
      {
        "id": "T1022",
        "name": "Data Encrypted"
      },
      {
        "id": "T1486",
        "name": "Data Encrypted for Impact"
      },
      {
        "id": "T1001",
        "name": "Data Obfuscation"
      },
      {
        "id": "T1074",
        "name": "Data Staged"
      },
      {
        "id": "T1030",
        "name": "Data Transfer Size Limits"
      },
      {
        "id": "T1530",
        "name": "Data from Cloud Storage Object"
      },
      {
        "id": "T1213",
        "name": "Data from Information Repositories"
      },
      {
        "id": "T1005",
        "name": "Data from Local System"
      },
      {
        "id": "T1039",
        "name": "Data from Network Shared Drive"
      },
      {
        "id": "T1025",
        "name": "Data from Removable Media"
      },
      {
        "id": "T1491",
        "name": "Defacement"
      },
      {
        "id": "T1140",
        "name": "Deobfuscate/Decode Files or Information"
      },
      {
        "id": "T1089",
        "name": "Disabling Security Tools"
      },
      {
        "id": "T1488",
        "name": "Disk Content Wipe"
      },
      {
        "id": "T1487",
        "name": "Disk Structure Wipe"
      },
      {
        "id": "T1172",
        "name": "Domain Fronting"
      },
      {
        "id": "T1483",
        "name": "Domain Generation Algorithms"
      },
      {
        "id": "T1482",
        "name": "Domain Trust Discovery"
      },
      {
        "id": "T1189",
        "name": "Drive-by Compromise"
      },
      {
        "id": "T1157",
        "name": "Dylib Hijacking"
      },
      {
        "id": "T1173",
        "name": "Dynamic Data Exchange"
      },
      {
        "id": "T1514",
        "name": "Elevated Execution with Prompt"
      },
      {
        "id": "T1114",
        "name": "Email Collection"
      },
      {
        "id": "T1519",
        "name": "Emond"
      },
      {
        "id": "T1499",
        "name": "Endpoint Denial of Service"
      },
      {
        "id": "T1480",
        "name": "Execution Guardrails"
      },
      {
        "id": "T1106",
        "name": "Execution through API"
      },
      {
        "id": "T1129",
        "name": "Execution through Module Load"
      },
      {
        "id": "T1048",
        "name": "Exfiltration Over Alternative Protocol"
      },
      {
        "id": "T1041",
        "name": "Exfiltration Over Command and Control Channel"
      },
      {
        "id": "T1011",
        "name": "Exfiltration Over Other Network Medium"
      },
      {
        "id": "T1052",
        "name": "Exfiltration Over Physical Medium"
      },
      {
        "id": "T1190",
        "name": "Exploit Public-Facing Application"
      },
      {
        "id": "T1203",
        "name": "Exploitation for Client Execution"
      },
      {
        "id": "T1212",
        "name": "Exploitation for Credential Access"
      },
      {
        "id": "T1211",
        "name": "Exploitation for Defense Evasion"
      },
      {
        "id": "T1068",
        "name": "Exploitation for Privilege Escalation"
      },
      {
        "id": "T1210",
        "name": "Exploitation of Remote Services"
      },
      {
        "id": "T1133",
        "name": "External Remote Services"
      },
      {
        "id": "T1181",
        "name": "Extra Window Memory Injection"
      },
      {
        "id": "T1008",
        "name": "Fallback Channels"
      },
      {
        "id": "T1107",
        "name": "File Deletion"
      },
      {
        "id": "T1006",
        "name": "File System Logical Offsets"
      },
      {
        "id": "T1044",
        "name": "File System Permissions Weakness"
      },
      {
        "id": "T1083",
        "name": "File and Directory Discovery"
      },
      {
        "id": "T1222",
        "name": "File and Directory Permissions Modification"
      },
      {
        "id": "T1495",
        "name": "Firmware Corruption"
      },
      {
        "id": "T1187",
        "name": "Forced Authentication"
      },
      {
        "id": "T1144",
        "name": "Gatekeeper Bypass"
      },
      {
        "id": "T1061",
        "name": "Graphical User Interface"
      },
      {
        "id": "T1484",
        "name": "Group Policy Modification"
      },
      {
        "id": "T1148",
        "name": "HISTCONTROL"
      },
      {
        "id": "T1200",
        "name": "Hardware Additions"
      },
      {
        "id": "T1158",
        "name": "Hidden Files and Directories"
      },
      {
        "id": "T1147",
        "name": "Hidden Users"
      },
      {
        "id": "T1143",
        "name": "Hidden Window"
      },
      {
        "id": "T1179",
        "name": "Hooking"
      },
      {
        "id": "T1062",
        "name": "Hypervisor"
      },
      {
        "id": "T1183",
        "name": "Image File Execution Options Injection"
      },
      {
        "id": "T1525",
        "name": "Implant Container Image"
      },
      {
        "id": "T1054",
        "name": "Indicator Blocking"
      },
      {
        "id": "T1066",
        "name": "Indicator Removal from Tools"
      },
      {
        "id": "T1070",
        "name": "Indicator Removal on Host"
      },
      {
        "id": "T1202",
        "name": "Indirect Command Execution"
      },
      {
        "id": "T1490",
        "name": "Inhibit System Recovery"
      },
      {
        "id": "T1056",
        "name": "Input Capture"
      },
      {
        "id": "T1141",
        "name": "Input Prompt"
      },
      {
        "id": "T1130",
        "name": "Install Root Certificate"
      },
      {
        "id": "T1118",
        "name": "InstallUtil"
      },
      {
        "id": "T1534",
        "name": "Internal Spearphishing"
      },
      {
        "id": "T1208",
        "name": "Kerberoasting"
      },
      {
        "id": "T1215",
        "name": "Kernel Modules and Extensions"
      },
      {
        "id": "T1142",
        "name": "Keychain"
      },
      {
        "id": "T1161",
        "name": "LC_LOAD_DYLIB Addition"
      },
      {
        "id": "T1149",
        "name": "LC_MAIN Hijacking"
      },
      {
        "id": "T1171",
        "name": "LLMNR/NBT-NS Poisoning and Relay"
      },
      {
        "id": "T1177",
        "name": "LSASS Driver"
      },
      {
        "id": "T1159",
        "name": "Launch Agent"
      },
      {
        "id": "T1160",
        "name": "Launch Daemon"
      },
      {
        "id": "T1152",
        "name": "Launchctl"
      },
      {
        "id": "T1168",
        "name": "Local Job Scheduling"
      },
      {
        "id": "T1162",
        "name": "Login Item"
      },
      {
        "id": "T1037",
        "name": "Logon Scripts"
      },
      {
        "id": "T1185",
        "name": "Man in the Browser"
      },
      {
        "id": "T1036",
        "name": "Masquerading"
      },
      {
        "id": "T1031",
        "name": "Modify Existing Service"
      },
      {
        "id": "T1112",
        "name": "Modify Registry"
      },
      {
        "id": "T1170",
        "name": "Mshta"
      },
      {
        "id": "T1104",
        "name": "Multi-Stage Channels"
      },
      {
        "id": "T1188",
        "name": "Multi-hop Proxy"
      },
      {
        "id": "T1026",
        "name": "Multiband Communication"
      },
      {
        "id": "T1079",
        "name": "Multilayer Encryption"
      },
      {
        "id": "T1096",
        "name": "NTFS File Attributes"
      },
      {
        "id": "T1128",
        "name": "Netsh Helper DLL"
      },
      {
        "id": "T1498",
        "name": "Network Denial of Service"
      },
      {
        "id": "T1046",
        "name": "Network Service Scanning"
      },
      {
        "id": "T1126",
        "name": "Network Share Connection Removal"
      },
      {
        "id": "T1135",
        "name": "Network Share Discovery"
      },
      {
        "id": "T1040",
        "name": "Network Sniffing"
      },
      {
        "id": "T1050",
        "name": "New Service"
      },
      {
        "id": "T1027",
        "name": "Obfuscated Files or Information"
      },
      {
        "id": "T1137",
        "name": "Office Application Startup"
      },
      {
        "id": "T1502",
        "name": "Parent PID Spoofing"
      },
      {
        "id": "T1075",
        "name": "Pass the Hash"
      },
      {
        "id": "T1097",
        "name": "Pass the Ticket"
      },
      {
        "id": "T1174",
        "name": "Password Filter DLL"
      },
      {
        "id": "T1201",
        "name": "Password Policy Discovery"
      },
      {
        "id": "T1034",
        "name": "Path Interception"
      },
      {
        "id": "T1120",
        "name": "Peripheral Device Discovery"
      },
      {
        "id": "T1069",
        "name": "Permission Groups Discovery"
      },
      {
        "id": "T1150",
        "name": "Plist Modification"
      },
      {
        "id": "T1205",
        "name": "Port Knocking"
      },
      {
        "id": "T1013",
        "name": "Port Monitors"
      },
      {
        "id": "T1086",
        "name": "PowerShell"
      },
      {
        "id": "T1504",
        "name": "PowerShell Profile"
      },
      {
        "id": "T1145",
        "name": "Private Keys"
      },
      {
        "id": "T1057",
        "name": "Process Discovery"
      },
      {
        "id": "T1186",
        "name": "Process Doppelgnging"
      },
      {
        "id": "T1093",
        "name": "Process Hollowing"
      },
      {
        "id": "T1055",
        "name": "Process Injection"
      },
      {
        "id": "T1012",
        "name": "Query Registry"
      },
      {
        "id": "T1163",
        "name": "Rc.common"
      },
      {
        "id": "T1164",
        "name": "Re-opened Applications"
      },
      {
        "id": "T1108",
        "name": "Redundant Access"
      },
      {
        "id": "T1060",
        "name": "Registry Run Keys / Startup Folder"
      },
      {
        "id": "T1121",
        "name": "Regsvcs/Regasm"
      },
      {
        "id": "T1117",
        "name": "Regsvr32"
      },
      {
        "id": "T1219",
        "name": "Remote Access Tools"
      },
      {
        "id": "T1076",
        "name": "Remote Desktop Protocol"
      },
      {
        "id": "T1105",
        "name": "Remote File Copy"
      },
      {
        "id": "T1021",
        "name": "Remote Services"
      },
      {
        "id": "T1018",
        "name": "Remote System Discovery"
      },
      {
        "id": "T1091",
        "name": "Replication Through Removable Media"
      },
      {
        "id": "T1496",
        "name": "Resource Hijacking"
      },
      {
        "id": "T1536",
        "name": "Revert Cloud Instance"
      },
      {
        "id": "T1014",
        "name": "Rootkit"
      },
      {
        "id": "T1085",
        "name": "Rundll32"
      },
      {
        "id": "T1494",
        "name": "Runtime Data Manipulation"
      },
      {
        "id": "T1178",
        "name": "SID-History Injection"
      },
      {
        "id": "T1198",
        "name": "SIP and Trust Provider Hijacking"
      },
      {
        "id": "T1184",
        "name": "SSH Hijacking"
      },
      {
        "id": "T1053",
        "name": "Scheduled Task"
      },
      {
        "id": "T1029",
        "name": "Scheduled Transfer"
      },
      {
        "id": "T1113",
        "name": "Screen Capture"
      },
      {
        "id": "T1180",
        "name": "Screensaver"
      },
      {
        "id": "T1064",
        "name": "Scripting"
      },
      {
        "id": "T1063",
        "name": "Security Software Discovery"
      },
      {
        "id": "T1101",
        "name": "Security Support Provider"
      },
      {
        "id": "T1167",
        "name": "Securityd Memory"
      },
      {
        "id": "T1505",
        "name": "Server Software Component"
      },
      {
        "id": "T1035",
        "name": "Service Execution"
      },
      {
        "id": "T1058",
        "name": "Service Registry Permissions Weakness"
      },
      {
        "id": "T1489",
        "name": "Service Stop"
      },
      {
        "id": "T1166",
        "name": "Setuid and Setgid"
      },
      {
        "id": "T1051",
        "name": "Shared Webroot"
      },
      {
        "id": "T1023",
        "name": "Shortcut Modification"
      },
      {
        "id": "T1218",
        "name": "Signed Binary Proxy Execution"
      },
      {
        "id": "T1216",
        "name": "Signed Script Proxy Execution"
      },
      {
        "id": "T1518",
        "name": "Software Discovery"
      },
      {
        "id": "T1045",
        "name": "Software Packing"
      },
      {
        "id": "T1153",
        "name": "Source"
      },
      {
        "id": "T1151",
        "name": "Space after Filename"
      },
      {
        "id": "T1193",
        "name": "Spearphishing Attachment"
      },
      {
        "id": "T1192",
        "name": "Spearphishing Link"
      },
      {
        "id": "T1194",
        "name": "Spearphishing via Service"
      },
      {
        "id": "T1071",
        "name": "Standard Application Layer Protocol"
      },
      {
        "id": "T1032",
        "name": "Standard Cryptographic Protocol"
      },
      {
        "id": "T1095",
        "name": "Standard Non-Application Layer Protocol"
      },
      {
        "id": "T1165",
        "name": "Startup Items"
      },
      {
        "id": "T1528",
        "name": "Steal Application Access Token"
      },
      {
        "id": "T1539",
        "name": "Steal Web Session Cookie"
      },
      {
        "id": "T1492",
        "name": "Stored Data Manipulation"
      },
      {
        "id": "T1169",
        "name": "Sudo"
      },
      {
        "id": "T1206",
        "name": "Sudo Caching"
      },
      {
        "id": "T1195",
        "name": "Supply Chain Compromise"
      },
      {
        "id": "T1019",
        "name": "System Firmware"
      },
      {
        "id": "T1082",
        "name": "System Information Discovery"
      },
      {
        "id": "T1016",
        "name": "System Network Configuration Discovery"
      },
      {
        "id": "T1049",
        "name": "System Network Connections Discovery"
      },
      {
        "id": "T1033",
        "name": "System Owner/User Discovery"
      },
      {
        "id": "T1007",
        "name": "System Service Discovery"
      },
      {
        "id": "T1529",
        "name": "System Shutdown/Reboot"
      },
      {
        "id": "T1124",
        "name": "System Time Discovery"
      },
      {
        "id": "T1501",
        "name": "Systemd Service"
      },
      {
        "id": "T1080",
        "name": "Taint Shared Content"
      },
      {
        "id": "T1221",
        "name": "Template Injection"
      },
      {
        "id": "T1072",
        "name": "Third-party Software"
      },
      {
        "id": "T1209",
        "name": "Time Providers"
      },
      {
        "id": "T1099",
        "name": "Timestomp"
      },
      {
        "id": "T1537",
        "name": "Transfer Data to Cloud Account"
      },
      {
        "id": "T1493",
        "name": "Transmitted Data Manipulation"
      },
      {
        "id": "T1154",
        "name": "Trap"
      },
      {
        "id": "T1127",
        "name": "Trusted Developer Utilities"
      },
      {
        "id": "T1199",
        "name": "Trusted Relationship"
      },
      {
        "id": "T1111",
        "name": "Two-Factor Authentication Interception"
      },
      {
        "id": "T1065",
        "name": "Uncommonly Used Port"
      },
      {
        "id": "T1535",
        "name": "Unused/Unsupported Cloud Regions"
      },
      {
        "id": "T1204",
        "name": "User Execution"
      },
      {
        "id": "T1078",
        "name": "Valid Accounts"
      },
      {
        "id": "T1125",
        "name": "Video Capture"
      },
      {
        "id": "T1497",
        "name": "Virtualization/Sandbox Evasion"
      },
      {
        "id": "T1102",
        "name": "Web Service"
      },
      {
        "id": "T1506",
        "name": "Web Session Cookie"
      },
      {
        "id": "T1100",
        "name": "Web Shell"
      },
      {
        "id": "T1077",
        "name": "Windows Admin Shares"
      },
      {
        "id": "T1047",
        "name": "Windows Management Instrumentation"
      },
      {
        "id": "T1084",
        "name": "Windows Management Instrumentation Event Subscription"
      },
      {
        "id": "T1028",
        "name": "Windows Remote Management"
      },
      {
        "id": "T1004",
        "name": "Winlogon Helper DLL"
      },
      {
        "id": "T1220",
        "name": "XSL Script Processing"
      }
    ],
    "v7": [
      {
        "id": "T1003.008",
        "name": "OS Credential Dumping: /etc/passwd and /etc/shadow"
      },
      {
        "id": "T1557.002",
        "name": "Man-in-the-Middle: ARP Cache Poisoning"
      },
      {
        "id": "T1558.004",
        "name": "Steal or Forge Kerberos Tickets: AS-REP Roasting"
      },
      {
        "id": "T1548",
        "name": "Abuse Elevation Control Mechanism"
      },
      {
        "id": "T1134",
        "name": "Access Token Manipulation"
      },
      {
        "id": "T1546.008",
        "name": "Event Triggered Execution: Accessibility Features"
      },
      {
        "id": "T1531",
        "name": "Account Access Removal"
      },
      {
        "id": "T1087",
        "name": "Account Discovery"
      },
      {
        "id": "T1098",
        "name": "Account Manipulation"
      },
      {
        "id": "T1583",
        "name": "Acquire Infrastructure"
      },
      {
        "id": "T1595",
        "name": "Active Scanning"
      },
      {
        "id": "T1547.014",
        "name": "Boot or Logon Autostart Execution: Active Setup"
      },
      {
        "id": "T1098.003",
        "name": "Account Manipulation: Add Office 365 Global Administrator Role"
      },
      {
        "id": "T1137.006",
        "name": "Office Application Startup: Add-ins"
      },
      {
        "id": "T1098.001",
        "name": "Account Manipulation: Additional Cloud Credentials"
      },
      {
        "id": "T1546.009",
        "name": "Event Triggered Execution: AppCert DLLs"
      },
      {
        "id": "T1546.010",
        "name": "Event Triggered Execution: AppInit DLLs"
      },
      {
        "id": "T1059.002",
        "name": "Command and Scripting Interpreter: AppleScript"
      },
      {
        "id": "T1550.001",
        "name": "Use Alternate Authentication Material: Application Access Token"
      },
      {
        "id": "T1499.003",
        "name": "Endpoint Denial of Service: Application Exhaustion Flood"
      },
      {
        "id": "T1071",
        "name": "Application Layer Protocol"
      },
      {
        "id": "T1546.011",
        "name": "Event Triggered Execution: Application Shimming"
      },
      {
        "id": "T1010",
        "name": "Application Window Discovery"
      },
      {
        "id": "T1499.004",
        "name": "Endpoint Denial of Service: Application or System Exploitation"
      },
      {
        "id": "T1560",
        "name": "Archive Collected Data"
      },
      {
        "id": "T1560.003",
        "name": "Archive Collected Data: Archive via Custom Method"
      },
      {
        "id": "T1560.002",
        "name": "Archive Collected Data: Archive via Library"
      },
      {
        "id": "T1560.001",
        "name": "Archive Collected Data: Archive via Utility"
      },
      {
        "id": "T1573.002",
        "name": "Encrypted Channel: Asymmetric Cryptography"
      },
      {
        "id": "T1055.004",
        "name": "Process Injection: Asynchronous Procedure Call"
      },
      {
        "id": "T1053.001",
        "name": "Scheduled Task/Job: At (Linux)"
      },
      {
        "id": "T1053.002",
        "name": "Scheduled Task/Job: At (Windows)"
      },
      {
        "id": "T1123",
        "name": "Audio Capture"
      },
      {
        "id": "T1547.002",
        "name": "Boot or Logon Autostart Execution: Authentication Package"
      },
      {
        "id": "T1119",
        "name": "Automated Collection"
      },
      {
        "id": "T1020",
        "name": "Automated Exfiltration"
      },
      {
        "id": "T1197",
        "name": "BITS Jobs"
      },
      {
        "id": "T1552.003",
        "name": "Unsecured Credentials: Bash History"
      },
      {
        "id": "T1102.002",
        "name": "Web Service: Bidirectional Communication"
      },
      {
        "id": "T1027.001",
        "name": "Obfuscated Files or Information: Binary Padding"
      },
      {
        "id": "T1547",
        "name": "Boot or Logon Autostart Execution"
      },
      {
        "id": "T1037",
        "name": "Boot or Logon Initialization Scripts"
      },
      {
        "id": "T1542.003",
        "name": "Pre-OS Boot: Bootkit"
      },
      {
        "id": "T1583.005",
        "name": "Acquire Infrastructure: Botnet"
      },
      {
        "id": "T1584.005",
        "name": "Compromise Infrastructure: Botnet"
      },
      {
        "id": "T1217",
        "name": "Browser Bookmark Discovery"
      },
      {
        "id": "T1176",
        "name": "Browser Extensions"
      },
      {
        "id": "T1110",
        "name": "Brute Force"
      },
      {
        "id": "T1612",
        "name": "Build Image on Host"
      },
      {
        "id": "T1591.002",
        "name": "Gather Victim Org Information: Business Relationships"
      },
      {
        "id": "T1548.002",
        "name": "Abuse Elevation Control Mechanism: Bypass User Account Control"
      },
      {
        "id": "T1596.004",
        "name": "Search Open Technical Databases: CDNs"
      },
      {
        "id": "T1218.003",
        "name": "Signed Binary Proxy Execution: CMSTP"
      },
      {
        "id": "T1574.012",
        "name": "Hijack Execution Flow: COR_PROFILER"
      },
      {
        "id": "T1003.005",
        "name": "OS Credential Dumping: Cached Domain Credentials"
      },
      {
        "id": "T1546.001",
        "name": "Event Triggered Execution: Change Default File Association"
      },
      {
        "id": "T1070.003",
        "name": "Indicator Removal on Host: Clear Command History"
      },
      {
        "id": "T1070.002",
        "name": "Indicator Removal on Host: Clear Linux or Mac System Logs"
      },
      {
        "id": "T1070.001",
        "name": "Indicator Removal on Host: Clear Windows Event Logs"
      },
      {
        "id": "T1592.004",
        "name": "Gather Victim Host Information: Client Configurations"
      },
      {
        "id": "T1115",
        "name": "Clipboard Data"
      },
      {
        "id": "T1136.003",
        "name": "Create Account: Cloud Account"
      },
      {
        "id": "T1087.004",
        "name": "Account Discovery: Cloud Account"
      },
      {
        "id": "T1078.004",
        "name": "Valid Accounts: Cloud Accounts"
      },
      {
        "id": "T1069.003",
        "name": "Permission Groups Discovery: Cloud Groups"
      },
      {
        "id": "T1580",
        "name": "Cloud Infrastructure Discovery"
      },
      {
        "id": "T1552.005",
        "name": "Unsecured Credentials: Cloud Instance Metadata API"
      },
      {
        "id": "T1538",
        "name": "Cloud Service Dashboard"
      },
      {
        "id": "T1526",
        "name": "Cloud Service Discovery"
      },
      {
        "id": "T1553.002",
        "name": "Subvert Trust Controls: Code Signing"
      },
      {
        "id": "T1587.002",
        "name": "Develop Capabilities: Code Signing Certificates"
      },
      {
        "id": "T1588.003",
        "name": "Obtain Capabilities: Code Signing Certificates"
      },
      {
        "id": "T1553.006",
        "name": "Subvert Trust Controls: Code Signing Policy Modification"
      },
      {
        "id": "T1059",
        "name": "Command and Scripting Interpreter"
      },
      {
        "id": "T1043",
        "name": "Commonly Used Port"
      },
      {
        "id": "T1092",
        "name": "Communication Through Removable Media"
      },
      {
        "id": "T1027.004",
        "name": "Obfuscated Files or Information: Compile After Delivery"
      },
      {
        "id": "T1218.001",
        "name": "Signed Binary Proxy Execution: Compiled HTML File"
      },
      {
        "id": "T1542.002",
        "name": "Pre-OS Boot: Component Firmware"
      },
      {
        "id": "T1559.001",
        "name": "Inter-Process Communication: Component Object Model"
      },
      {
        "id": "T1546.015",
        "name": "Event Triggered Execution: Component Object Model Hijacking"
      },
      {
        "id": "T1175",
        "name": "Component Object Model and Distributed COM"
      },
      {
        "id": "T1586",
        "name": "Compromise Accounts"
      },
      {
        "id": "T1554",
        "name": "Compromise Client Software Binary"
      },
      {
        "id": "T1195.003",
        "name": "Supply Chain Compromise: Compromise Hardware Supply Chain"
      },
      {
        "id": "T1584",
        "name": "Compromise Infrastructure"
      },
      {
        "id": "T1195.001",
        "name": "Supply Chain Compromise: Compromise Software Dependencies and Development Tools"
      },
      {
        "id": "T1195.002",
        "name": "Supply Chain Compromise: Compromise Software Supply Chain"
      },
      {
        "id": "T1213.001",
        "name": "Data from Information Repositories: Confluence"
      },
      {
        "id": "T1552.007",
        "name": "Unsecured Credentials: Container API"
      },
      {
        "id": "T1609",
        "name": "Container Administration Command"
      },
      {
        "id": "T1053.007",
        "name": "Scheduled Task/Job: Container Orchestration Job"
      },
      {
        "id": "T1613",
        "name": "Container and Resource Discovery"
      },
      {
        "id": "T1218.002",
        "name": "Signed Binary Proxy Execution: Control Panel"
      },
      {
        "id": "T1136",
        "name": "Create Account"
      },
      {
        "id": "T1578.002",
        "name": "Modify Cloud Compute Infrastructure: Create Cloud Instance"
      },
      {
        "id": "T1134.002",
        "name": "Access Token Manipulation: Create Process with Token"
      },
      {
        "id": "T1578.001",
        "name": "Modify Cloud Compute Infrastructure: Create Snapshot"
      },
      {
        "id": "T1543",
        "name": "Create or Modify System Process"
      },
      {
        "id": "T1056.004",
        "name": "Input Capture: Credential API Hooking"
      },
      {
        "id": "T1110.004",
        "name": "Brute Force: Credential Stuffing"
      },
      {
        "id": "T1589.001",
        "name": "Gather Victim Identity Information: Credentials"
      },
      {
        "id": "T1552.001",
        "name": "Unsecured Credentials: Credentials In Files"
      },
      {
        "id": "T1555",
        "name": "Credentials from Password Stores"
      },
      {
        "id": "T1555.003",
        "name": "Credentials from Password Stores: Credentials from Web Browsers"
      },
      {
        "id": "T1552.002",
        "name": "Unsecured Credentials: Credentials in Registry"
      },
      {
        "id": "T1053.003",
        "name": "Scheduled Task/Job: Cron"
      },
      {
        "id": "T1003.006",
        "name": "OS Credential Dumping: DCSync"
      },
      {
        "id": "T1574.001",
        "name": "Hijack Execution Flow: DLL Search Order Hijacking"
      },
      {
        "id": "T1574.002",
        "name": "Hijack Execution Flow: DLL Side-Loading"
      },
      {
        "id": "T1071.004",
        "name": "Application Layer Protocol: DNS"
      },
      {
        "id": "T1590.002",
        "name": "Gather Victim Network Information: DNS"
      },
      {
        "id": "T1568.003",
        "name": "Dynamic Resolution: DNS Calculation"
      },
      {
        "id": "T1583.002",
        "name": "Acquire Infrastructure: DNS Server"
      },
      {
        "id": "T1584.002",
        "name": "Compromise Infrastructure: DNS Server"
      },
      {
        "id": "T1596.001",
        "name": "Search Open Technical Databases: DNS/Passive DNS"
      },
      {
        "id": "T1485",
        "name": "Data Destruction"
      },
      {
        "id": "T1132",
        "name": "Data Encoding"
      },
      {
        "id": "T1486",
        "name": "Data Encrypted for Impact"
      },
      {
        "id": "T1565",
        "name": "Data Manipulation"
      },
      {
        "id": "T1001",
        "name": "Data Obfuscation"
      },
      {
        "id": "T1074",
        "name": "Data Staged"
      },
      {
        "id": "T1030",
        "name": "Data Transfer Size Limits"
      },
      {
        "id": "T1530",
        "name": "Data from Cloud Storage Object"
      },
      {
        "id": "T1602",
        "name": "Data from Configuration Repository"
      },
      {
        "id": "T1213",
        "name": "Data from Information Repositories"
      },
      {
        "id": "T1005",
        "name": "Data from Local System"
      },
      {
        "id": "T1039",
        "name": "Data from Network Shared Drive"
      },
      {
        "id": "T1025",
        "name": "Data from Removable Media"
      },
      {
        "id": "T1102.001",
        "name": "Web Service: Dead Drop Resolver"
      },
      {
        "id": "T1491",
        "name": "Defacement"
      },
      {
        "id": "T1078.001",
        "name": "Valid Accounts: Default Accounts"
      },
      {
        "id": "T1578.003",
        "name": "Modify Cloud Compute Infrastructure: Delete Cloud Instance"
      },
      {
        "id": "T1140",
        "name": "Deobfuscate/Decode Files or Information"
      },
      {
        "id": "T1610",
        "name": "Deploy Container"
      },
      {
        "id": "T1591.001",
        "name": "Gather Victim Org Information: Determine Physical Locations"
      },
      {
        "id": "T1587",
        "name": "Develop Capabilities"
      },
      {
        "id": "T1587.003",
        "name": "Develop Capabilities: Digital Certificates"
      },
      {
        "id": "T1588.004",
        "name": "Obtain Capabilities: Digital Certificates"
      },
      {
        "id": "T1596.003",
        "name": "Search Open Technical Databases: Digital Certificates"
      },
      {
        "id": "T1498.001",
        "name": "Network Denial of Service: Direct Network Flood"
      },
      {
        "id": "T1006",
        "name": "Direct Volume Access"
      },
      {
        "id": "T1562.008",
        "name": "Impair Defenses: Disable Cloud Logs"
      },
      {
        "id": "T1600.002",
        "name": "Weaken Encryption: Disable Crypto Hardware"
      },
      {
        "id": "T1562.002",
        "name": "Impair Defenses: Disable Windows Event Logging"
      },
      {
        "id": "T1562.007",
        "name": "Impair Defenses: Disable or Modify Cloud Firewall"
      },
      {
        "id": "T1562.004",
        "name": "Impair Defenses: Disable or Modify System Firewall"
      },
      {
        "id": "T1562.001",
        "name": "Impair Defenses: Disable or Modify Tools"
      },
      {
        "id": "T1561.001",
        "name": "Disk Wipe: Disk Content Wipe"
      },
      {
        "id": "T1561.002",
        "name": "Disk Wipe: Disk Structure Wipe"
      },
      {
        "id": "T1561",
        "name": "Disk Wipe"
      },
      {
        "id": "T1021.003",
        "name": "Remote Services: Distributed Component Object Model"
      },
      {
        "id": "T1136.002",
        "name": "Create Account: Domain Account"
      },
      {
        "id": "T1087.002",
        "name": "Account Discovery: Domain Account"
      },
      {
        "id": "T1078.002",
        "name": "Valid Accounts: Domain Accounts"
      },
      {
        "id": "T1556.001",
        "name": "Modify Authentication Process: Domain Controller Authentication"
      },
      {
        "id": "T1090.004",
        "name": "Proxy: Domain Fronting"
      },
      {
        "id": "T1568.002",
        "name": "Dynamic Resolution: Domain Generation Algorithms"
      },
      {
        "id": "T1069.002",
        "name": "Permission Groups Discovery: Domain Groups"
      },
      {
        "id": "T1484",
        "name": "Domain Policy Modification"
      },
      {
        "id": "T1590.001",
        "name": "Gather Victim Network Information: Domain Properties"
      },
      {
        "id": "T1482",
        "name": "Domain Trust Discovery"
      },
      {
        "id": "T1484.002",
        "name": "Domain Policy Modification: Domain Trust Modification"
      },
      {
        "id": "T1583.001",
        "name": "Acquire Infrastructure: Domains"
      },
      {
        "id": "T1584.001",
        "name": "Compromise Infrastructure: Domains"
      },
      {
        "id": "T1601.002",
        "name": "Modify System Image: Downgrade System Image"
      },
      {
        "id": "T1189",
        "name": "Drive-by Compromise"
      },
      {
        "id": "T1608.004",
        "name": "Stage Capabilities: Drive-by Target"
      },
      {
        "id": "T1574.004",
        "name": "Hijack Execution Flow: Dylib Hijacking"
      },
      {
        "id": "T1559.002",
        "name": "Inter-Process Communication: Dynamic Data Exchange"
      },
      {
        "id": "T1574.006",
        "name": "Hijack Execution Flow: Dynamic Linker Hijacking"
      },
      {
        "id": "T1568",
        "name": "Dynamic Resolution"
      },
      {
        "id": "T1055.001",
        "name": "Process Injection: Dynamic-link Library Injection"
      },
      {
        "id": "T1548.004",
        "name": "Abuse Elevation Control Mechanism: Elevated Execution with Prompt"
      },
      {
        "id": "T1087.003",
        "name": "Account Discovery: Email Account"
      },
      {
        "id": "T1585.002",
        "name": "Establish Accounts: Email Accounts"
      },
      {
        "id": "T1586.002",
        "name": "Compromise Accounts: Email Accounts"
      },
      {
        "id": "T1589.002",
        "name": "Gather Victim Identity Information: Email Addresses"
      },
      {
        "id": "T1114",
        "name": "Email Collection"
      },
      {
        "id": "T1114.003",
        "name": "Email Collection: Email Forwarding Rule"
      },
      {
        "id": "T1546.014",
        "name": "Event Triggered Execution: Emond"
      },
      {
        "id": "T1589.003",
        "name": "Gather Victim Identity Information: Employee Names"
      },
      {
        "id": "T1573",
        "name": "Encrypted Channel"
      },
      {
        "id": "T1499",
        "name": "Endpoint Denial of Service"
      },
      {
        "id": "T1480.001",
        "name": "Execution Guardrails: Environmental Keying"
      },
      {
        "id": "T1611",
        "name": "Escape to Host"
      },
      {
        "id": "T1585",
        "name": "Establish Accounts"
      },
      {
        "id": "T1546",
        "name": "Event Triggered Execution"
      },
      {
        "id": "T1098.002",
        "name": "Account Manipulation: Exchange Email Delegate Permissions"
      },
      {
        "id": "T1574.005",
        "name": "Hijack Execution Flow: Executable Installer File Permissions Weakness"
      },
      {
        "id": "T1480",
        "name": "Execution Guardrails"
      },
      {
        "id": "T1048",
        "name": "Exfiltration Over Alternative Protocol"
      },
      {
        "id": "T1048.002",
        "name": "Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol"
      },
      {
        "id": "T1011.001",
        "name": "Exfiltration Over Other Network Medium: Exfiltration Over Bluetooth"
      },
      {
        "id": "T1041",
        "name": "Exfiltration Over C2 Channel"
      },
      {
        "id": "T1011",
        "name": "Exfiltration Over Other Network Medium"
      },
      {
        "id": "T1052",
        "name": "Exfiltration Over Physical Medium"
      },
      {
        "id": "T1048.001",
        "name": "Exfiltration Over Alternative Protocol: Exfiltration Over Symmetric Encrypted Non-C2 Protocol"
      },
      {
        "id": "T1048.003",
        "name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted/Obfuscated Non-C2 Protocol"
      },
      {
        "id": "T1567",
        "name": "Exfiltration Over Web Service"
      },
      {
        "id": "T1052.001",
        "name": "Exfiltration Over Physical Medium: Exfiltration over USB"
      },
      {
        "id": "T1567.002",
        "name": "Exfiltration Over Web Service: Exfiltration to Cloud Storage"
      },
      {
        "id": "T1567.001",
        "name": "Exfiltration Over Web Service: Exfiltration to Code Repository"
      },
      {
        "id": "T1190",
        "name": "Exploit Public-Facing Application"
      },
      {
        "id": "T1203",
        "name": "Exploitation for Client Execution"
      },
      {
        "id": "T1212",
        "name": "Exploitation for Credential Access"
      },
      {
        "id": "T1211",
        "name": "Exploitation for Defense Evasion"
      },
      {
        "id": "T1068",
        "name": "Exploitation for Privilege Escalation"
      },
      {
        "id": "T1210",
        "name": "Exploitation of Remote Services"
      },
      {
        "id": "T1587.004",
        "name": "Develop Capabilities: Exploits"
      },
      {
        "id": "T1588.005",
        "name": "Obtain Capabilities: Exploits"
      },
      {
        "id": "T1491.002",
        "name": "Defacement: External Defacement"
      },
      {
        "id": "T1090.002",
        "name": "Proxy: External Proxy"
      },
      {
        "id": "T1133",
        "name": "External Remote Services"
      },
      {
        "id": "T1055.011",
        "name": "Process Injection: Extra Window Memory Injection"
      },
      {
        "id": "T1008",
        "name": "Fallback Channels"
      },
      {
        "id": "T1568.001",
        "name": "Dynamic Resolution: Fast Flux DNS"
      },
      {
        "id": "T1070.004",
        "name": "Indicator Removal on Host: File Deletion"
      },
      {
        "id": "T1071.002",
        "name": "Application Layer Protocol: File Transfer Protocols"
      },
      {
        "id": "T1083",
        "name": "File and Directory Discovery"
      },
      {
        "id": "T1222",
        "name": "File and Directory Permissions Modification"
      },
      {
        "id": "T1592.003",
        "name": "Gather Victim Host Information: Firmware"
      },
      {
        "id": "T1495",
        "name": "Firmware Corruption"
      },
      {
        "id": "T1187",
        "name": "Forced Authentication"
      },
      {
        "id": "T1606",
        "name": "Forge Web Credentials"
      },
      {
        "id": "T1056.002",
        "name": "Input Capture: GUI Input Capture"
      },
      {
        "id": "T1553.001",
        "name": "Subvert Trust Controls: Gatekeeper Bypass"
      },
      {
        "id": "T1592",
        "name": "Gather Victim Host Information"
      },
      {
        "id": "T1589",
        "name": "Gather Victim Identity Information"
      },
      {
        "id": "T1590",
        "name": "Gather Victim Network Information"
      },
      {
        "id": "T1591",
        "name": "Gather Victim Org Information"
      },
      {
        "id": "T1558.001",
        "name": "Steal or Forge Kerberos Tickets: Golden Ticket"
      },
      {
        "id": "T1061",
        "name": "Graphical User Interface"
      },
      {
        "id": "T1484.001",
        "name": "Domain Policy Modification: Group Policy Modification"
      },
      {
        "id": "T1552.006",
        "name": "Unsecured Credentials: Group Policy Preferences"
      },
      {
        "id": "T1592.001",
        "name": "Gather Victim Host Information: Hardware"
      },
      {
        "id": "T1200",
        "name": "Hardware Additions"
      },
      {
        "id": "T1564.005",
        "name": "Hide Artifacts: Hidden File System"
      },
      {
        "id": "T1564.001",
        "name": "Hide Artifacts: Hidden Files and Directories"
      },
      {
        "id": "T1564.002",
        "name": "Hide Artifacts: Hidden Users"
      },
      {
        "id": "T1564.003",
        "name": "Hide Artifacts: Hidden Window"
      },
      {
        "id": "T1564",
        "name": "Hide Artifacts"
      },
      {
        "id": "T1574",
        "name": "Hijack Execution Flow"
      },
      {
        "id": "T1062",
        "name": "Hypervisor"
      },
      {
        "id": "T1590.005",
        "name": "Gather Victim Network Information: IP Addresses"
      },
      {
        "id": "T1591.003",
        "name": "Gather Victim Org Information: Identify Business Tempo"
      },
      {
        "id": "T1591.004",
        "name": "Gather Victim Org Information: Identify Roles"
      },
      {
        "id": "T1546.012",
        "name": "Event Triggered Execution: Image File Execution Options Injection"
      },
      {
        "id": "T1562.003",
        "name": "Impair Defenses: Impair Command History Logging"
      },
      {
        "id": "T1562",
        "name": "Impair Defenses"
      },
      {
        "id": "T1525",
        "name": "Implant Internal Image"
      },
      {
        "id": "T1562.006",
        "name": "Impair Defenses: Indicator Blocking"
      },
      {
        "id": "T1027.005",
        "name": "Obfuscated Files or Information: Indicator Removal from Tools"
      },
      {
        "id": "T1070",
        "name": "Indicator Removal on Host"
      },
      {
        "id": "T1202",
        "name": "Indirect Command Execution"
      },
      {
        "id": "T1105",
        "name": "Ingress Tool Transfer"
      },
      {
        "id": "T1490",
        "name": "Inhibit System Recovery"
      },
      {
        "id": "T1056",
        "name": "Input Capture"
      },
      {
        "id": "T1608.003",
        "name": "Stage Capabilities: Install Digital Certificate"
      },
      {
        "id": "T1553.004",
        "name": "Subvert Trust Controls: Install Root Certificate"
      },
      {
        "id": "T1218.004",
        "name": "Signed Binary Proxy Execution: InstallUtil"
      },
      {
        "id": "T1559",
        "name": "Inter-Process Communication"
      },
      {
        "id": "T1491.001",
        "name": "Defacement: Internal Defacement"
      },
      {
        "id": "T1090.001",
        "name": "Proxy: Internal Proxy"
      },
      {
        "id": "T1534",
        "name": "Internal Spearphishing"
      },
      {
        "id": "T1016.001",
        "name": "System Network Configuration Discovery: Internet Connection Discovery"
      },
      {
        "id": "T1036.001",
        "name": "Masquerading: Invalid Code Signature"
      },
      {
        "id": "T1059.007",
        "name": "Command and Scripting Interpreter: JavaScript"
      },
      {
        "id": "T1001.001",
        "name": "Data Obfuscation: Junk Data"
      },
      {
        "id": "T1558.003",
        "name": "Steal or Forge Kerberos Tickets: Kerberoasting"
      },
      {
        "id": "T1547.006",
        "name": "Boot or Logon Autostart Execution: Kernel Modules and Extensions"
      },
      {
        "id": "T1555.001",
        "name": "Credentials from Password Stores: Keychain"
      },
      {
        "id": "T1056.001",
        "name": "Input Capture: Keylogging"
      },
      {
        "id": "T1546.006",
        "name": "Event Triggered Execution: LC_LOAD_DYLIB Addition"
      },
      {
        "id": "T1149",
        "name": "LC_MAIN Hijacking"
      },
      {
        "id": "T1557.001",
        "name": "Man-in-the-Middle: LLMNR/NBT-NS Poisoning and SMB Relay"
      },
      {
        "id": "T1003.004",
        "name": "OS Credential Dumping: LSA Secrets"
      },
      {
        "id": "T1547.008",
        "name": "Boot or Logon Autostart Execution: LSASS Driver"
      },
      {
        "id": "T1003.001",
        "name": "OS Credential Dumping: LSASS Memory"
      },
      {
        "id": "T1570",
        "name": "Lateral Tool Transfer"
      },
      {
        "id": "T1543.001",
        "name": "Create or Modify System Process: Launch Agent"
      },
      {
        "id": "T1543.004",
        "name": "Create or Modify System Process: Launch Daemon"
      },
      {
        "id": "T1569.001",
        "name": "System Services: Launchctl"
      },
      {
        "id": "T1053.004",
        "name": "Scheduled Task/Job: Launchd"
      },
      {
        "id": "T1608.005",
        "name": "Stage Capabilities: Link Target"
      },
      {
        "id": "T1222.002",
        "name": "File and Directory Permissions Modification: Linux and Mac File and Directory Permissions Modification"
      },
      {
        "id": "T1136.001",
        "name": "Create Account: Local Account"
      },
      {
        "id": "T1087.001",
        "name": "Account Discovery: Local Account"
      },
      {
        "id": "T1078.003",
        "name": "Valid Accounts: Local Accounts"
      },
      {
        "id": "T1074.001",
        "name": "Data Staged: Local Data Staging"
      },
      {
        "id": "T1114.001",
        "name": "Email Collection: Local Email Collection"
      },
      {
        "id": "T1069.001",
        "name": "Permission Groups Discovery: Local Groups"
      },
      {
        "id": "T1037.002",
        "name": "Boot or Logon Initialization Scripts: Logon Script (Mac)"
      },
      {
        "id": "T1037.001",
        "name": "Boot or Logon Initialization Scripts: Logon Script (Windows)"
      },
      {
        "id": "T1127.001",
        "name": "Trusted Developer Utilities Proxy Execution: MSBuild"
      },
      {
        "id": "T1071.003",
        "name": "Application Layer Protocol: Mail Protocols"
      },
      {
        "id": "T1134.003",
        "name": "Access Token Manipulation: Make and Impersonate Token"
      },
      {
        "id": "T1204.002",
        "name": "User Execution: Malicious File"
      },
      {
        "id": "T1204.003",
        "name": "User Execution: Malicious Image"
      },
      {
        "id": "T1204.001",
        "name": "User Execution: Malicious Link"
      },
      {
        "id": "T1587.001",
        "name": "Develop Capabilities: Malware"
      },
      {
        "id": "T1588.001",
        "name": "Obtain Capabilities: Malware"
      },
      {
        "id": "T1185",
        "name": "Man in the Browser"
      },
      {
        "id": "T1557",
        "name": "Man-in-the-Middle"
      },
      {
        "id": "T1553.005",
        "name": "Subvert Trust Controls: Mark-of-the-Web Bypass"
      },
      {
        "id": "T1036.004",
        "name": "Masquerading: Masquerade Task or Service"
      },
      {
        "id": "T1036",
        "name": "Masquerading"
      },
      {
        "id": "T1036.005",
        "name": "Masquerading: Match Legitimate Name or Location"
      },
      {
        "id": "T1556",
        "name": "Modify Authentication Process"
      },
      {
        "id": "T1578",
        "name": "Modify Cloud Compute Infrastructure"
      },
      {
        "id": "T1112",
        "name": "Modify Registry"
      },
      {
        "id": "T1601",
        "name": "Modify System Image"
      },
      {
        "id": "T1218.005",
        "name": "Signed Binary Proxy Execution: Mshta"
      },
      {
        "id": "T1218.007",
        "name": "Signed Binary Proxy Execution: Msiexec"
      },
      {
        "id": "T1104",
        "name": "Multi-Stage Channels"
      },
      {
        "id": "T1090.003",
        "name": "Proxy: Multi-hop Proxy"
      },
      {
        "id": "T1026",
        "name": "Multiband Communication"
      },
      {
        "id": "T1003.003",
        "name": "OS Credential Dumping: NTDS"
      },
      {
        "id": "T1564.004",
        "name": "Hide Artifacts: NTFS File Attributes"
      },
      {
        "id": "T1106",
        "name": "Native API"
      },
      {
        "id": "T1546.007",
        "name": "Event Triggered Execution: Netsh Helper DLL"
      },
      {
        "id": "T1599.001",
        "name": "Network Boundary Bridging: Network Address Translation Traversal"
      },
      {
        "id": "T1599",
        "name": "Network Boundary Bridging"
      },
      {
        "id": "T1498",
        "name": "Network Denial of Service"
      },
      {
        "id": "T1556.004",
        "name": "Modify Authentication Process: Network Device Authentication"
      },
      {
        "id": "T1059.008",
        "name": "Command and Scripting Interpreter: Network Device CLI"
      },
      {
        "id": "T1602.002",
        "name": "Data from Configuration Repository: Network Device Configuration Dump"
      },
      {
        "id": "T1037.003",
        "name": "Boot or Logon Initialization Scripts: Network Logon Script"
      },
      {
        "id": "T1590.006",
        "name": "Gather Victim Network Information: Network Security Appliances"
      },
      {
        "id": "T1046",
        "name": "Network Service Scanning"
      },
      {
        "id": "T1070.005",
        "name": "Indicator Removal on Host: Network Share Connection Removal"
      },
      {
        "id": "T1135",
        "name": "Network Share Discovery"
      },
      {
        "id": "T1040",
        "name": "Network Sniffing"
      },
      {
        "id": "T1590.004",
        "name": "Gather Victim Network Information: Network Topology"
      },
      {
        "id": "T1590.003",
        "name": "Gather Victim Network Information: Network Trust Dependencies"
      },
      {
        "id": "T1095",
        "name": "Non-Application Layer Protocol"
      },
      {
        "id": "T1132.002",
        "name": "Data Encoding: Non-Standard Encoding"
      },
      {
        "id": "T1571",
        "name": "Non-Standard Port"
      },
      {
        "id": "T1003",
        "name": "OS Credential Dumping"
      },
      {
        "id": "T1499.001",
        "name": "Endpoint Denial of Service: OS Exhaustion Flood"
      },
      {
        "id": "T1027",
        "name": "Obfuscated Files or Information"
      },
      {
        "id": "T1588",
        "name": "Obtain Capabilities"
      },
      {
        "id": "T1218.008",
        "name": "Signed Binary Proxy Execution: Odbcconf"
      },
      {
        "id": "T1137",
        "name": "Office Application Startup"
      },
      {
        "id": "T1137.001",
        "name": "Office Application Startup: Office Template Macros"
      },
      {
        "id": "T1137.002",
        "name": "Office Application Startup: Office Test"
      },
      {
        "id": "T1102.003",
        "name": "Web Service: One-Way Communication"
      },
      {
        "id": "T1137.003",
        "name": "Office Application Startup: Outlook Forms"
      },
      {
        "id": "T1137.004",
        "name": "Office Application Startup: Outlook Home Page"
      },
      {
        "id": "T1137.005",
        "name": "Office Application Startup: Outlook Rules"
      },
      {
        "id": "T1134.004",
        "name": "Access Token Manipulation: Parent PID Spoofing"
      },
      {
        "id": "T1550.002",
        "name": "Use Alternate Authentication Material: Pass the Hash"
      },
      {
        "id": "T1550.003",
        "name": "Use Alternate Authentication Material: Pass the Ticket"
      },
      {
        "id": "T1110.002",
        "name": "Brute Force: Password Cracking"
      },
      {
        "id": "T1556.002",
        "name": "Modify Authentication Process: Password Filter DLL"
      },
      {
        "id": "T1110.001",
        "name": "Brute Force: Password Guessing"
      },
      {
        "id": "T1555.005",
        "name": "Credentials from Password Stores: Password Managers"
      },
      {
        "id": "T1201",
        "name": "Password Policy Discovery"
      },
      {
        "id": "T1110.003",
        "name": "Brute Force: Password Spraying"
      },
      {
        "id": "T1601.001",
        "name": "Modify System Image: Patch System Image"
      },
      {
        "id": "T1034",
        "name": "Path Interception"
      },
      {
        "id": "T1574.007",
        "name": "Hijack Execution Flow: Path Interception by PATH Environment Variable"
      },
      {
        "id": "T1574.008",
        "name": "Hijack Execution Flow: Path Interception by Search Order Hijacking"
      },
      {
        "id": "T1574.009",
        "name": "Hijack Execution Flow: Path Interception by Unquoted Path"
      },
      {
        "id": "T1120",
        "name": "Peripheral Device Discovery"
      },
      {
        "id": "T1069",
        "name": "Permission Groups Discovery"
      },
      {
        "id": "T1566",
        "name": "Phishing"
      },
      {
        "id": "T1598",
        "name": "Phishing for Information"
      },
      {
        "id": "T1547.011",
        "name": "Boot or Logon Autostart Execution: Plist Modification"
      },
      {
        "id": "T1556.003",
        "name": "Modify Authentication Process: Pluggable Authentication Modules"
      },
      {
        "id": "T1205.001",
        "name": "Traffic Signaling: Port Knocking"
      },
      {
        "id": "T1547.010",
        "name": "Boot or Logon Autostart Execution: Port Monitors"
      },
      {
        "id": "T1055.002",
        "name": "Process Injection: Portable Executable Injection"
      },
      {
        "id": "T1059.001",
        "name": "Command and Scripting Interpreter: PowerShell"
      },
      {
        "id": "T1546.013",
        "name": "Event Triggered Execution: PowerShell Profile"
      },
      {
        "id": "T1542",
        "name": "Pre-OS Boot"
      },
      {
        "id": "T1547.012",
        "name": "Boot or Logon Autostart Execution: Print Processors"
      },
      {
        "id": "T1552.004",
        "name": "Unsecured Credentials: Private Keys"
      },
      {
        "id": "T1003.007",
        "name": "OS Credential Dumping: Proc Filesystem"
      },
      {
        "id": "T1055.009",
        "name": "Process Injection: Proc Memory"
      },
      {
        "id": "T1057",
        "name": "Process Discovery"
      },
      {
        "id": "T1055.013",
        "name": "Process Injection: Process Doppelgnging"
      },
      {
        "id": "T1055.012",
        "name": "Process Injection: Process Hollowing"
      },
      {
        "id": "T1055",
        "name": "Process Injection"
      },
      {
        "id": "T1001.003",
        "name": "Data Obfuscation: Protocol Impersonation"
      },
      {
        "id": "T1572",
        "name": "Protocol Tunneling"
      },
      {
        "id": "T1090",
        "name": "Proxy"
      },
      {
        "id": "T1055.008",
        "name": "Process Injection: Ptrace System Calls"
      },
      {
        "id": "T1216.001",
        "name": "Signed Script Proxy Execution: PubPrn"
      },
      {
        "id": "T1597.002",
        "name": "Search Closed Sources: Purchase Technical Data"
      },
      {
        "id": "T1059.006",
        "name": "Command and Scripting Interpreter: Python"
      },
      {
        "id": "T1012",
        "name": "Query Registry"
      },
      {
        "id": "T1037.004",
        "name": "Boot or Logon Initialization Scripts: RC Scripts"
      },
      {
        "id": "T1563.002",
        "name": "Remote Service Session Hijacking: RDP Hijacking"
      },
      {
        "id": "T1542.004",
        "name": "Pre-OS Boot: ROMMONkit"
      },
      {
        "id": "T1547.007",
        "name": "Boot or Logon Autostart Execution: Re-opened Applications"
      },
      {
        "id": "T1600.001",
        "name": "Weaken Encryption: Reduce Key Space"
      },
      {
        "id": "T1108",
        "name": "Redundant Access"
      },
      {
        "id": "T1498.002",
        "name": "Network Denial of Service: Reflection Amplification"
      },
      {
        "id": "T1547.001",
        "name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder"
      },
      {
        "id": "T1218.009",
        "name": "Signed Binary Proxy Execution: Regsvcs/Regasm"
      },
      {
        "id": "T1218.010",
        "name": "Signed Binary Proxy Execution: Regsvr32"
      },
      {
        "id": "T1219",
        "name": "Remote Access Software"
      },
      {
        "id": "T1074.002",
        "name": "Data Staged: Remote Data Staging"
      },
      {
        "id": "T1021.001",
        "name": "Remote Services: Remote Desktop Protocol"
      },
      {
        "id": "T1114.002",
        "name": "Email Collection: Remote Email Collection"
      },
      {
        "id": "T1563",
        "name": "Remote Service Session Hijacking"
      },
      {
        "id": "T1021",
        "name": "Remote Services"
      },
      {
        "id": "T1018",
        "name": "Remote System Discovery"
      },
      {
        "id": "T1036.003",
        "name": "Masquerading: Rename System Utilities"
      },
      {
        "id": "T1091",
        "name": "Replication Through Removable Media"
      },
      {
        "id": "T1496",
        "name": "Resource Hijacking"
      },
      {
        "id": "T1578.004",
        "name": "Modify Cloud Compute Infrastructure: Revert Cloud Instance"
      },
      {
        "id": "T1036.002",
        "name": "Masquerading: Right-to-Left Override"
      },
      {
        "id": "T1207",
        "name": "Rogue Domain Controller"
      },
      {
        "id": "T1014",
        "name": "Rootkit"
      },
      {
        "id": "T1564.006",
        "name": "Hide Artifacts: Run Virtual Instance"
      },
      {
        "id": "T1218.011",
        "name": "Signed Binary Proxy Execution: Rundll32"
      },
      {
        "id": "T1565.003",
        "name": "Data Manipulation: Runtime Data Manipulation"
      },
      {
        "id": "T1606.002",
        "name": "Forge Web Credentials: SAML Tokens"
      },
      {
        "id": "T1134.005",
        "name": "Access Token Manipulation: SID-History Injection"
      },
      {
        "id": "T1553.003",
        "name": "Subvert Trust Controls: SIP and Trust Provider Hijacking"
      },
      {
        "id": "T1021.002",
        "name": "Remote Services: SMB/Windows Admin Shares"
      },
      {
        "id": "T1602.001",
        "name": "Data from Configuration Repository: SNMP (MIB Dump)"
      },
      {
        "id": "T1505.001",
        "name": "Server Software Component: SQL Stored Procedures"
      },
      {
        "id": "T1021.004",
        "name": "Remote Services: SSH"
      },
      {
        "id": "T1098.004",
        "name": "Account Manipulation: SSH Authorized Keys"
      },
      {
        "id": "T1563.001",
        "name": "Remote Service Session Hijacking: SSH Hijacking"
      },
      {
        "id": "T1596.005",
        "name": "Search Open Technical Databases: Scan Databases"
      },
      {
        "id": "T1595.001",
        "name": "Active Scanning: Scanning IP Blocks"
      },
      {
        "id": "T1053.005",
        "name": "Scheduled Task/Job: Scheduled Task"
      },
      {
        "id": "T1053",
        "name": "Scheduled Task/Job"
      },
      {
        "id": "T1029",
        "name": "Scheduled Transfer"
      },
      {
        "id": "T1113",
        "name": "Screen Capture"
      },
      {
        "id": "T1546.002",
        "name": "Event Triggered Execution: Screensaver"
      },
      {
        "id": "T1064",
        "name": "Scripting"
      },
      {
        "id": "T1597",
        "name": "Search Closed Sources"
      },
      {
        "id": "T1593.002",
        "name": "Search Open Websites/Domains: Search Engines"
      },
      {
        "id": "T1596",
        "name": "Search Open Technical Databases"
      },
      {
        "id": "T1593",
        "name": "Search Open Websites/Domains"
      },
      {
        "id": "T1594",
        "name": "Search Victim-Owned Websites"
      },
      {
        "id": "T1003.002",
        "name": "OS Credential Dumping: Security Account Manager"
      },
      {
        "id": "T1518.001",
        "name": "Software Discovery: Security Software Discovery"
      },
      {
        "id": "T1547.005",
        "name": "Boot or Logon Autostart Execution: Security Support Provider"
      },
      {
        "id": "T1555.002",
        "name": "Credentials from Password Stores: Securityd Memory"
      },
      {
        "id": "T1583.004",
        "name": "Acquire Infrastructure: Server"
      },
      {
        "id": "T1584.004",
        "name": "Compromise Infrastructure: Server"
      },
      {
        "id": "T1505",
        "name": "Server Software Component"
      },
      {
        "id": "T1569.002",
        "name": "System Services: Service Execution"
      },
      {
        "id": "T1499.002",
        "name": "Endpoint Denial of Service: Service Exhaustion Flood"
      },
      {
        "id": "T1489",
        "name": "Service Stop"
      },
      {
        "id": "T1574.010",
        "name": "Hijack Execution Flow: Services File Permissions Weakness"
      },
      {
        "id": "T1574.011",
        "name": "Hijack Execution Flow: Services Registry Permissions Weakness"
      },
      {
        "id": "T1548.001",
        "name": "Abuse Elevation Control Mechanism: Setuid and Setgid"
      },
      {
        "id": "T1129",
        "name": "Shared Modules"
      },
      {
        "id": "T1051",
        "name": "Shared Webroot"
      },
      {
        "id": "T1213.002",
        "name": "Data from Information Repositories: Sharepoint"
      },
      {
        "id": "T1547.009",
        "name": "Boot or Logon Autostart Execution: Shortcut Modification"
      },
      {
        "id": "T1218",
        "name": "Signed Binary Proxy Execution"
      },
      {
        "id": "T1216",
        "name": "Signed Script Proxy Execution"
      },
      {
        "id": "T1558.002",
        "name": "Steal or Forge Kerberos Tickets: Silver Ticket"
      },
      {
        "id": "T1593.001",
        "name": "Search Open Websites/Domains: Social Media"
      },
      {
        "id": "T1585.001",
        "name": "Establish Accounts: Social Media Accounts"
      },
      {
        "id": "T1586.001",
        "name": "Compromise Accounts: Social Media Accounts"
      },
      {
        "id": "T1592.002",
        "name": "Gather Victim Host Information: Software"
      },
      {
        "id": "T1072",
        "name": "Software Deployment Tools"
      },
      {
        "id": "T1518",
        "name": "Software Discovery"
      },
      {
        "id": "T1027.002",
        "name": "Obfuscated Files or Information: Software Packing"
      },
      {
        "id": "T1153",
        "name": "Source"
      },
      {
        "id": "T1036.006",
        "name": "Masquerading: Space after Filename"
      },
      {
        "id": "T1566.001",
        "name": "Phishing: Spearphishing Attachment"
      },
      {
        "id": "T1598.002",
        "name": "Phishing for Information: Spearphishing Attachment"
      },
      {
        "id": "T1566.002",
        "name": "Phishing: Spearphishing Link"
      },
      {
        "id": "T1598.003",
        "name": "Phishing for Information: Spearphishing Link"
      },
      {
        "id": "T1598.001",
        "name": "Phishing for Information: Spearphishing Service"
      },
      {
        "id": "T1566.003",
        "name": "Phishing: Spearphishing via Service"
      },
      {
        "id": "T1608",
        "name": "Stage Capabilities"
      },
      {
        "id": "T1132.001",
        "name": "Data Encoding: Standard Encoding"
      },
      {
        "id": "T1037.005",
        "name": "Boot or Logon Initialization Scripts: Startup Items"
      },
      {
        "id": "T1528",
        "name": "Steal Application Access Token"
      },
      {
        "id": "T1539",
        "name": "Steal Web Session Cookie"
      },
      {
        "id": "T1558",
        "name": "Steal or Forge Kerberos Tickets"
      },
      {
        "id": "T1027.003",
        "name": "Obfuscated Files or Information: Steganography"
      },
      {
        "id": "T1001.002",
        "name": "Data Obfuscation: Steganography"
      },
      {
        "id": "T1565.001",
        "name": "Data Manipulation: Stored Data Manipulation"
      },
      {
        "id": "T1553",
        "name": "Subvert Trust Controls"
      },
      {
        "id": "T1548.003",
        "name": "Abuse Elevation Control Mechanism: Sudo and Sudo Caching"
      },
      {
        "id": "T1195",
        "name": "Supply Chain Compromise"
      },
      {
        "id": "T1573.001",
        "name": "Encrypted Channel: Symmetric Cryptography"
      },
      {
        "id": "T1497.001",
        "name": "Virtualization/Sandbox Evasion: System Checks"
      },
      {
        "id": "T1542.001",
        "name": "Pre-OS Boot: System Firmware"
      },
      {
        "id": "T1082",
        "name": "System Information Discovery"
      },
      {
        "id": "T1614",
        "name": "System Location Discovery"
      },
      {
        "id": "T1016",
        "name": "System Network Configuration Discovery"
      },
      {
        "id": "T1049",
        "name": "System Network Connections Discovery"
      },
      {
        "id": "T1033",
        "name": "System Owner/User Discovery"
      },
      {
        "id": "T1007",
        "name": "System Service Discovery"
      },
      {
        "id": "T1569",
        "name": "System Services"
      },
      {
        "id": "T1529",
        "name": "System Shutdown/Reboot"
      },
      {
        "id": "T1124",
        "name": "System Time Discovery"
      },
      {
        "id": "T1543.002",
        "name": "Create or Modify System Process: Systemd Service"
      },
      {
        "id": "T1053.006",
        "name": "Scheduled Task/Job: Systemd Timers"
      },
      {
        "id": "T1542.005",
        "name": "Pre-OS Boot: TFTP Boot"
      },
      {
        "id": "T1080",
        "name": "Taint Shared Content"
      },
      {
        "id": "T1221",
        "name": "Template Injection"
      },
      {
        "id": "T1055.003",
        "name": "Process Injection: Thread Execution Hijacking"
      },
      {
        "id": "T1055.005",
        "name": "Process Injection: Thread Local Storage"
      },
      {
        "id": "T1597.001",
        "name": "Search Closed Sources: Threat Intel Vendors"
      },
      {
        "id": "T1497.003",
        "name": "Virtualization/Sandbox Evasion: Time Based Evasion"
      },
      {
        "id": "T1547.003",
        "name": "Boot or Logon Autostart Execution: Time Providers"
      },
      {
        "id": "T1070.006",
        "name": "Indicator Removal on Host: Timestomp"
      },
      {
        "id": "T1134.001",
        "name": "Access Token Manipulation: Token Impersonation/Theft"
      },
      {
        "id": "T1588.002",
        "name": "Obtain Capabilities: Tool"
      },
      {
        "id": "T1020.001",
        "name": "Automated Exfiltration: Traffic Duplication"
      },
      {
        "id": "T1205",
        "name": "Traffic Signaling"
      },
      {
        "id": "T1537",
        "name": "Transfer Data to Cloud Account"
      },
      {
        "id": "T1565.002",
        "name": "Data Manipulation: Transmitted Data Manipulation"
      },
      {
        "id": "T1505.002",
        "name": "Server Software Component: Transport Agent"
      },
      {
        "id": "T1546.005",
        "name": "Event Triggered Execution: Trap"
      },
      {
        "id": "T1127",
        "name": "Trusted Developer Utilities Proxy Execution"
      },
      {
        "id": "T1199",
        "name": "Trusted Relationship"
      },
      {
        "id": "T1111",
        "name": "Two-Factor Authentication Interception"
      },
      {
        "id": "T1059.004",
        "name": "Command and Scripting Interpreter: Unix Shell"
      },
      {
        "id": "T1546.004",
        "name": "Event Triggered Execution: Unix Shell Configuration Modification"
      },
      {
        "id": "T1552",
        "name": "Unsecured Credentials"
      },
      {
        "id": "T1535",
        "name": "Unused/Unsupported Cloud Regions"
      },
      {
        "id": "T1608.001",
        "name": "Stage Capabilities: Upload Malware"
      },
      {
        "id": "T1608.002",
        "name": "Stage Capabilities: Upload Tool"
      },
      {
        "id": "T1550",
        "name": "Use Alternate Authentication Material"
      },
      {
        "id": "T1497.002",
        "name": "Virtualization/Sandbox Evasion: User Activity Based Checks"
      },
      {
        "id": "T1204",
        "name": "User Execution"
      },
      {
        "id": "T1564.007",
        "name": "Hide Artifacts: VBA Stomping"
      },
      {
        "id": "T1055.014",
        "name": "Process Injection: VDSO Hijacking"
      },
      {
        "id": "T1021.005",
        "name": "Remote Services: VNC"
      },
      {
        "id": "T1078",
        "name": "Valid Accounts"
      },
      {
        "id": "T1218.012",
        "name": "Signed Binary Proxy Execution: Verclsid"
      },
      {
        "id": "T1125",
        "name": "Video Capture"
      },
      {
        "id": "T1583.003",
        "name": "Acquire Infrastructure: Virtual Private Server"
      },
      {
        "id": "T1584.003",
        "name": "Compromise Infrastructure: Virtual Private Server"
      },
      {
        "id": "T1497",
        "name": "Virtualization/Sandbox Evasion"
      },
      {
        "id": "T1059.005",
        "name": "Command and Scripting Interpreter: Visual Basic"
      },
      {
        "id": "T1588.006",
        "name": "Obtain Capabilities: Vulnerabilities"
      },
      {
        "id": "T1595.002",
        "name": "Active Scanning: Vulnerability Scanning"
      },
      {
        "id": "T1596.002",
        "name": "Search Open Technical Databases: WHOIS"
      },
      {
        "id": "T1600",
        "name": "Weaken Encryption"
      },
      {
        "id": "T1606.001",
        "name": "Forge Web Credentials: Web Cookies"
      },
      {
        "id": "T1056.003",
        "name": "Input Capture: Web Portal Capture"
      },
      {
        "id": "T1071.001",
        "name": "Application Layer Protocol: Web Protocols"
      },
      {
        "id": "T1102",
        "name": "Web Service"
      },
      {
        "id": "T1583.006",
        "name": "Acquire Infrastructure: Web Services"
      },
      {
        "id": "T1584.006",
        "name": "Compromise Infrastructure: Web Services"
      },
      {
        "id": "T1550.004",
        "name": "Use Alternate Authentication Material: Web Session Cookie"
      },
      {
        "id": "T1505.003",
        "name": "Server Software Component: Web Shell"
      },
      {
        "id": "T1059.003",
        "name": "Command and Scripting Interpreter: Windows Command Shell"
      },
      {
        "id": "T1555.004",
        "name": "Credentials from Password Stores: Windows Credential Manager"
      },
      {
        "id": "T1222.001",
        "name": "File and Directory Permissions Modification: Windows File and Directory Permissions Modification"
      },
      {
        "id": "T1047",
        "name": "Windows Management Instrumentation"
      },
      {
        "id": "T1546.003",
        "name": "Event Triggered Execution: Windows Management Instrumentation Event Subscription"
      },
      {
        "id": "T1021.006",
        "name": "Remote Services: Windows Remote Management"
      },
      {
        "id": "T1543.003",
        "name": "Create or Modify System Process: Windows Service"
      },
      {
        "id": "T1547.004",
        "name": "Boot or Logon Autostart Execution: Winlogon Helper DLL"
      },
      {
        "id": "T1547.013",
        "name": "Boot or Logon Autostart Execution: XDG Autostart Entries"
      },
      {
        "id": "T1220",
        "name": "XSL Script Processing"
      }
    ]
  }
}
